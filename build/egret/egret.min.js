<<<<<<< Updated upstream
var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r};if("undefined"==typeof global)var global=window;if("undefined"==typeof __global)var __global=global;var __define=this&&this.__define||function(t,e,r,i){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:r,set:i})},egret;!function(t){t.$hashCount=1;var e=function(){function e(){this.$hashCode=t.$hashCount++}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),e}();t.HashObject=e,__reflect(e.prototype,"egret.HashObject",["egret.IHashObject"])}(egret||(egret={}));var egret;!function(t){var e=[],r=function(r){function i(t){void 0===t&&(t=null);var e=r.call(this)||this;return e.$EventDispatcher={0:t?t:e,1:{},2:{},3:0},e}return __extends(i,r),i.prototype.$getEventMap=function(t){var e=this.$EventDispatcher,r=t?e[2]:e[1];return r},i.prototype.addEventListener=function(t,e,r,i,n){this.$addListener(t,e,r,i,n)},i.prototype.once=function(t,e,r,i,n){this.$addListener(t,e,r,i,n,!0)},i.prototype.$addListener=function(t,e,r,i,n,a){var o=this.$EventDispatcher,s=i?o[2]:o[1],h=s[t];h?0!==o[3]&&(s[t]=h=h.concat()):h=s[t]=[],this.$insertEventBin(h,t,e,r,i,n,a)},i.prototype.$insertEventBin=function(t,e,r,i,n,a,o){a=0|+a;for(var s=-1,h=t.length,l=0;h>l;l++){var c=t[l];if(c.listener==r&&c.thisObject==i&&c.target==this)return!1;-1==s&&c.priority<a&&(s=l)}var u={type:e,listener:r,thisObject:i,priority:a,target:this,useCapture:n,dispatchOnce:!!o};return-1!==s?t.splice(s,0,u):t.push(u),!0},i.prototype.removeEventListener=function(t,e,r,i){var n=this.$EventDispatcher,a=i?n[2]:n[1],o=a[t];o&&(0!==n[3]&&(a[t]=o=o.concat()),this.$removeEventBin(o,e,r),0==o.length&&(a[t]=null))},i.prototype.$removeEventBin=function(t,e,r){for(var i=t.length,n=0;i>n;n++){var a=t[n];if(a.listener==e&&a.thisObject==r&&a.target==this)return t.splice(n,1),!0}return!1},i.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},i.prototype.willTrigger=function(t){return this.hasEventListener(t)},i.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},i.prototype.$notifyListener=function(t,r){var i=this.$EventDispatcher,n=r?i[2]:i[1],a=n[t.$type];if(!a)return!0;var o=a.length;if(0==o)return!0;var s=e;i[3]++;for(var h=0;o>h;h++){var l=a[h];if(l.listener.call(l.thisObject,t),l.dispatchOnce&&s.push(l),t.$isPropagationImmediateStopped)break}for(i[3]--;s.length;){var l=s.pop();l.target.removeEventListener(l.type,l.listener,l.thisObject,l.useCapture)}return!t.$isDefaultPrevented},i.prototype.dispatchEventWith=function(e,r,i,n){if(r||this.hasEventListener(e)){var a=t.Event.create(t.Event,e,r,n);a.data=i;var o=this.dispatchEvent(a);return t.Event.release(a),o}return!0},i}(t.HashObject);t.EventDispatcher=r,__reflect(r.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(egret||(egret={}));var egret;!function(t){function e(t){return t%=360,t>180?t-=360:-180>t&&(t+=360),t}var r=function(r){function i(){var e=r.call(this)||this;return e.$children=null,e.$name="",e.$parent=null,e.$stage=null,e.$nestLevel=0,e.$useTranslate=!1,e.$matrix=new t.Matrix,e.$matrixDirty=!1,e.$x=0,e.$y=0,e.$scaleX=1,e.$scaleY=1,e.$rotation=0,e.$skewX=0,e.$skewXdeg=0,e.$skewY=0,e.$skewYdeg=0,e.$explicitWidth=0/0,e.$explicitHeight=0/0,e.$anchorOffsetX=0,e.$anchorOffsetY=0,e.$visible=!0,e.$displayList=null,e.$cacheAsBitmap=!1,e.$cacheDirty=!1,e.$alpha=1,e.$touchEnabled=i.defaultTouchEnabled,e.$scrollRect=null,e.$blendMode=0,e.$maskedObject=null,e.$mask=null,e.$maskRect=null,e.$parentDisplayList=null,e.$renderNode=null,e.$renderDirty=!1,e.$renderMode=null,__global.nativeRender&&e.createNativeNode(),e}return __extends(i,r),i.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(0)},Object.defineProperty(i.prototype,"name",{get:function(){return this.$name},set:function(t){this.$name=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),i.prototype.$setParent=function(t){this.$parent=t},i.prototype.$onAddToStage=function(e,r){var i=this;i.$stage=e,i.$nestLevel=r,i.$hasAddToStage=!0,t.Sprite.$EVENT_ADD_TO_STAGE_LIST.push(i)},i.prototype.$onRemoveFromStage=function(){var e=this;e.$nestLevel=0,t.Sprite.$EVENT_REMOVE_FROM_STAGE_LIST.push(e)},i.prototype.$updateUseTransform=function(){var t=this;1==t.$scaleX&&1==t.scaleY&&0==t.$skewX&&0==t.$skewY?t.$useTranslate=!1:t.$useTranslate=!0},Object.defineProperty(i.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),i.prototype.$getMatrix=function(){var t=this;return t.$matrixDirty&&(t.$matrixDirty=!1,t.$matrix.$updateScaleAndRotation(t.$scaleX,t.$scaleY,t.$skewX,t.$skewY)),t.$matrix.tx=t.$x,t.$matrix.ty=t.$y,t.$matrix},i.prototype.$setMatrix=function(t,r){void 0===r&&(r=!0);var i=this,n=i.$matrix;n.a=t.a,n.b=t.b,n.c=t.c,n.d=t.d,i.$x=t.tx,i.$y=t.ty,i.$matrixDirty=!1,1==n.a&&0==n.b&&0==n.c&&1==n.d?i.$useTranslate=!1:i.$useTranslate=!0,r&&(i.$scaleX=n.$getScaleX(),i.$scaleY=n.$getScaleY(),i.$skewX=t.$getSkewX(),i.$skewY=t.$getSkewY(),i.$skewXdeg=e(180*i.$skewX/Math.PI),i.$skewYdeg=e(180*i.$skewY/Math.PI),i.$rotation=e(180*i.$skewY/Math.PI)),__global.nativeRender&&i.$nativeNode.setMatrix(t.a,t.b,t.c,t.d,t.tx,t.ty)},i.prototype.$getConcatenatedMatrix=function(){var e=this,r=e.$concatenatedMatrix;r||(r=e.$concatenatedMatrix=new t.Matrix),e.$parent?e.$parent.$getConcatenatedMatrix().$preMultiplyInto(e.$getMatrix(),r):r.copyFrom(e.$getMatrix());var i=e.$anchorOffsetX,n=e.$anchorOffsetY,a=e.$scrollRect;return a?r.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-a.x-i,-a.y-n),r):(0!=i||0!=n)&&r.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-i,-n),r),e.$concatenatedMatrix},i.prototype.$getInvertedConcatenatedMatrix=function(){var e=this;return e.$invertedConcatenatedMatrix||(e.$invertedConcatenatedMatrix=new t.Matrix),e.$getConcatenatedMatrix().$invertInto(e.$invertedConcatenatedMatrix),e.$invertedConcatenatedMatrix},Object.defineProperty(i.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),i.prototype.$getX=function(){return this.$x},i.prototype.$setX=function(t){var e=this;if(e.$x==t)return!1;if(e.$x=t,__global.nativeRender)e.$nativeNode.setX(t);else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),i.prototype.$getY=function(){return this.$y},i.prototype.$setY=function(t){var e=this;if(e.$y==t)return!1;if(e.$y=t,__global.nativeRender)e.$nativeNode.setY(t);else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),i.prototype.$getScaleX=function(){return this.$scaleX},i.prototype.$setScaleX=function(t){var e=this;if(e.$scaleX=t,e.$matrixDirty=!0,__global.nativeRender)e.$nativeNode.setScaleX(t);else{e.$updateUseTransform();var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),i.prototype.$getScaleY=function(){return this.$scaleY},i.prototype.$setScaleY=function(t){var e=this;if(e.$scaleY=t,e.$matrixDirty=!0,__global.nativeRender)e.$nativeNode.setScaleY(t);else{e.$updateUseTransform();var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),i.prototype.$getRotation=function(){return this.$rotation},i.prototype.$setRotation=function(t){t=e(t);var r=this;if(t!=r.$rotation){var i=t-r.$rotation,n=i/180*Math.PI;if(r.$skewX+=n,r.$skewY+=n,r.$rotation=t,r.$matrixDirty=!0,__global.nativeRender)r.$nativeNode.setRotation(t);else{r.$updateUseTransform();var a=r.$parent;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp());var o=r.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}}},Object.defineProperty(i.prototype,"skewX",{get:function(){return this.$skewXdeg},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),i.prototype.$setSkewX=function(t){var r=this;if(t!=r.$skewXdeg)if(r.$skewXdeg=t,t=e(t),t=t/180*Math.PI,r.$skewX=t,r.$matrixDirty=!0,__global.nativeRender)r.$nativeNode.setSkewX(r.$skewXdeg);else{r.$updateUseTransform();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"skewY",{get:function(){return this.$skewYdeg},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),i.prototype.$setSkewY=function(t){var r=this;if(t!=r.$skewYdeg)if(r.$skewYdeg=t,t=e(t),t=t/180*Math.PI,r.$skewY=t,r.$matrixDirty=!0,__global.nativeRender)r.$nativeNode.setSkewY(r.$skewYdeg);else{r.$updateUseTransform();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),i.prototype.$getWidth=function(){var t=this;return isNaN(t.$explicitWidth)?t.$getOriginalBounds().width:t.$explicitWidth},i.prototype.$setWidth=function(t){this.$explicitWidth=isNaN(t)?0/0:t},Object.defineProperty(i.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),i.prototype.$getHeight=function(){var t=this;return isNaN(t.$explicitHeight)?t.$getOriginalBounds().height:t.$explicitHeight},i.prototype.$setHeight=function(t){this.$explicitHeight=isNaN(t)?0/0:t},Object.defineProperty(i.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"anchorOffsetX",{get:function(){return this.$anchorOffsetX},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),i.prototype.$setAnchorOffsetX=function(t){var e=this;e.$anchorOffsetX=t,__global.nativeRender&&e.$nativeNode.setAnchorOffsetX(t)},Object.defineProperty(i.prototype,"anchorOffsetY",{get:function(){return this.$anchorOffsetY},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),i.prototype.$setAnchorOffsetY=function(t){var e=this;e.$anchorOffsetY=t,__global.nativeRender&&e.$nativeNode.setAnchorOffsetY(t)},Object.defineProperty(i.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),i.prototype.$setVisible=function(t){var e=this;if(e.$visible=t,__global.nativeRender)e.$nativeNode.setVisible(t);else{e.updateRenderMode();var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"cacheAsBitmap",{get:function(){return this.$cacheAsBitmap},set:function(t){var e=this;e.$cacheAsBitmap=t,__global.nativeRender?e.$nativeNode.setCacheAsBitmap(t):e.$setHasDisplayList(t)},enumerable:!0,configurable:!0}),i.prototype.$setHasDisplayList=function(e){var r=this,i=!!r.$displayList;if(i!=e)if(e){var n=t.sys.DisplayList.create(r);n&&(r.$displayList=n,r.$cacheDirty=!0)}else r.$displayList=null},i.prototype.$cacheDirtyUp=function(){var t=this.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())},Object.defineProperty(i.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),i.prototype.$setAlpha=function(t){var e=this;if(e.$alpha=t,__global.nativeRender)e.$nativeNode.setAlpha(t);else{e.updateRenderMode();var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchEnabled=function(){return this.$touchEnabled},i.prototype.$setTouchEnabled=function(t){this.$touchEnabled=t},Object.defineProperty(i.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),i.prototype.$setScrollRect=function(e){var r=this;return e||r.$scrollRect?(e?(r.$scrollRect||(r.$scrollRect=new t.Rectangle),r.$scrollRect.copyFrom(e),__global.nativeRender&&r.$nativeNode.setScrollRect(e.x,e.y,e.width,e.height)):(r.$scrollRect=null,__global.nativeRender&&r.$nativeNode.setScrollRect(0,0,0,0)),void(__global.nativeRender||r.updateRenderMode())):void r.updateRenderMode()},Object.defineProperty(i.prototype,"blendMode",{get:function(){return t.sys.numberToBlendMode(this.$blendMode)},set:function(e){var r=this,i=t.sys.blendModeToNumber(e);if(r.$blendMode=i,__global.nativeRender)r.$nativeNode.setBlendMode(i);else{r.updateRenderMode();var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mask",{get:function(){var t=this;return t.$mask?t.$mask:t.$maskRect},set:function(e){var r=this;if(e!==r){if(e)if(e instanceof i){if(e==r.$mask)return;e.$maskedObject&&(e.$maskedObject.mask=null),e.$maskedObject=r,r.$mask=e,__global.nativeRender||e.updateRenderMode(),r.$maskRect&&(__global.nativeRender&&r.$nativeNode.setMaskRect(0,0,0,0),r.$maskRect=null),__global.nativeRender&&r.$nativeNode.setMask(e.$nativeNode.id)}else r.$maskRect||(r.$maskRect=new t.Rectangle),r.$maskRect.copyFrom(e),__global.nativeRender&&r.$nativeNode.setMaskRect(e.x,e.y,e.width,e.height),r.$mask&&(r.$mask.$maskedObject=null,__global.nativeRender||r.$mask.updateRenderMode()),r.mask&&(__global.nativeRender&&r.$nativeNode.setMask(-1),r.$mask=null);else r.$mask&&(r.$mask.$maskedObject=null,__global.nativeRender||r.$mask.updateRenderMode()),r.mask&&(__global.nativeRender&&r.$nativeNode.setMask(-1),r.$mask=null),r.$maskRect&&(__global.nativeRender&&r.$nativeNode.setMaskRect(0,0,0,0),r.$maskRect=null);__global.nativeRender||r.updateRenderMode()}},enumerable:!0,configurable:!0}),i.prototype.$setMaskRect=function(e){var r=this;(e||r.$maskRect)&&(e?(r.$maskRect||(r.$maskRect=new t.Rectangle),r.$maskRect.copyFrom(e)):r.$maskRect=null)},Object.defineProperty(i.prototype,"filters",{get:function(){return this.$filters},set:function(t){var e=this,r=e.$filters;return r||t?(t&&t.length?(t=t.concat(),e.$filters=t,__global.nativeRender&&e.$nativeNode.setFilters(t)):(e.$filters=null,__global.nativeRender&&e.$nativeNode.setFilters(null)),void(__global.nativeRender||e.updateRenderMode())):(e.$filters=null,void(__global.nativeRender?e.$nativeNode.setFilters(null):e.updateRenderMode()))},enumerable:!0,configurable:!0}),i.prototype.getTransformedBounds=function(t,e){return t=t||this,this.$getTransformedBounds(t,e)},i.prototype.getBounds=function(t,e){void 0===e&&(e=!0);var r=this;return t=r.$getTransformedBounds(r,t),e&&(0!=r.$anchorOffsetX&&(t.x-=r.$anchorOffsetX),0!=r.$anchorOffsetY&&(t.y-=r.$anchorOffsetY)),t},i.prototype.$getTransformedBounds=function(e,r){var i=this,n=i.$getOriginalBounds();if(r||(r=new t.Rectangle),r.copyFrom(n),e==i)return r;var a;if(e){a=t.$TempMatrix;var o=e.$getInvertedConcatenatedMatrix();o.$preMultiplyInto(i.$getConcatenatedMatrix(),a)}else a=i.$getConcatenatedMatrix();return a.$transformBounds(r),r},i.prototype.globalToLocal=function(e,r,i){if(void 0===e&&(e=0),void 0===r&&(r=0),__global.nativeRender){t.NativeDelegate.update();var n=t.NativeDelegate.globalToLocal(this.$nativeNode.id,e,r),a=n.split(","),o=parseFloat(a[0]),s=parseFloat(a[1]);return i?i.setTo(o,s):i=new t.Point(o,s),i}var h=this.$getInvertedConcatenatedMatrix();return h.transformPoint(e,r,i)},i.prototype.localToGlobal=function(e,r,i){if(void 0===e&&(e=0),void 0===r&&(r=0),__global.nativeRender){t.NativeDelegate.update();var n=t.NativeDelegate.localToGlobal(this.$nativeNode.id,e,r),a=n.split(","),o=parseFloat(a[0]),s=parseFloat(a[1]);return i?i.setTo(o,s):i=new t.Point(o,s),i}var h=this.$getConcatenatedMatrix();return h.transformPoint(e,r,i)},i.prototype.$getOriginalBounds=function(){var t=this,e=t.$getContentBounds();t.$measureChildBounds(e);var r=t.$measureFiltersOffset(!1);return r&&(e.x+=r.minX,e.y+=r.minY,e.width+=-r.minX+r.maxX,e.height+=-r.minY+r.maxY),e},i.prototype.$measureChildBounds=function(t){},i.prototype.$getContentBounds=function(){var e=t.$TempRectangle;return e.setEmpty(),this.$measureContentBounds(e),e},i.prototype.$measureContentBounds=function(t){},i.prototype.$getRenderNode=function(){var t=this,e=t.$renderNode;return e?(t.$renderDirty&&(e.cleanBeforeRender(),t.$updateRenderNode(),t.$renderDirty=!1,e=t.$renderNode),e):null},i.prototype.updateRenderMode=function(){var t=this;!t.$visible||t.$alpha<=0||t.$maskedObject?t.$renderMode=1:t.filters&&t.filters.length>0?t.$renderMode=2:0!==t.$blendMode||t.$mask?t.$renderMode=3:t.$scrollRect||t.$maskRect?t.$renderMode=4:t.$renderMode=null},i.prototype.$measureFiltersOffset=function(e){for(var r=this,i=0,n=0,a=0,o=0;r;){var s=r.$filters;if(s&&s.length)for(var h=s.length,l=0;h>l;l++){var c=s[l];if("blur"==c.type){var u=c.blurX,d=c.blurY;i-=u,n-=d,a+=u,o+=d}else if("glow"==c.type){var u=c.blurX,d=c.blurY;i-=u,n-=d,a+=u,o+=d;var p=c.distance||0,f=c.angle||0,g=0,v=0;0!=p&&(g=p*t.NumberUtils.cos(f),g=g>0?Math.ceil(g):Math.floor(g),v=p*t.NumberUtils.sin(f),v=v>0?Math.ceil(v):Math.floor(v),i+=g,a+=g,n+=v,o+=v)}else if("custom"==c.type){var y=c.padding;i-=y,n-=y,a+=y,o+=y}}r=e?r.$parent:null}return i=Math.min(i,0),n=Math.min(n,0),a=Math.max(a,0),o=Math.max(o,0),{minX:i,minY:n,maxX:a,maxY:o}},i.prototype.$getConcatenatedMatrixAt=function(e,r){var i=e.$getInvertedConcatenatedMatrix();if(0===i.a||0===i.d){var n=this,a=e.$nestLevel;for(r.identity();n.$nestLevel>a;){var o=n.$scrollRect;o&&r.concat(t.$TempMatrix.setTo(1,0,0,1,-o.x,-o.y)),r.concat(n.$getMatrix()),n=n.$parent}}else i.$preMultiplyInto(r,r)},i.prototype.$updateRenderNode=function(){},i.prototype.$hitTest=function(t,e){var r=this;if(!r.$renderNode||!r.$visible||0==r.$scaleX||0==r.$scaleY)return null;var i=r.$getInvertedConcatenatedMatrix();if(0==i.a&&0==i.b&&0==i.c&&0==i.d)return null;var n=r.$getContentBounds(),a=i.a*t+i.c*e+i.tx,o=i.b*t+i.d*e+i.ty;if(n.contains(a,o)){if(!r.$children){var s=r.$scrollRect?r.$scrollRect:r.$maskRect;if(s&&!s.contains(a,o))return null;if(r.$mask&&!r.$mask.$hitTest(t,e))return null}return r}return null},i.prototype.hitTestPoint=function(e,r,i){var n=this;if(i){var a=n.$getInvertedConcatenatedMatrix(),o=a.a*e+a.c*r+a.tx,s=a.b*e+a.d*r+a.ty,h=void 0;if(__global.nativeRender){var l=t.sys.customHitTestBuffer;l.resize(3,3),t.NativeDelegate.forHitTest=!0;var c=t.NativeDelegate.getCurrentBuffer();t.NativeDelegate.activateBuffer(l),t.NativeDelegate.update(),t.NativeDelegate.renderDisplayObjectWithOffset(n.$nativeNode.id,1-o,1-s);try{h=t.NativeDelegate.getPixels(1,1)}catch(u){throw new Error(t.sys.tr(1039))}return t.NativeDelegate.activateBuffer(c),t.NativeDelegate.forHitTest=!1,0===h[3]?!1:!0}var d=n.$displayList;if(d){var l=d.renderBuffer;try{h=l.getPixels(o-d.offsetX,s-d.offsetY)}catch(u){throw new Error(t.sys.tr(1039))}}else{var l=t.sys.customHitTestBuffer;l.resize(3,3);var p=t.Matrix.create();p.identity(),p.translate(1-o,1-s),t.sys.systemRenderer.render(this,l,p,!0),t.Matrix.release(p);try{h=l.getPixels(1,1)}catch(u){throw new Error(t.sys.tr(1039))}}return 0===h[3]?!1:!0}if(0==n.$scaleX||0==n.$scaleY)return!1;var a=n.$getInvertedConcatenatedMatrix(),f=n.getBounds(null,!1),o=a.a*e+a.c*r+a.tx,s=a.b*e+a.d*r+a.ty;if(f.contains(o,s)){var g=n.$scrollRect?n.$scrollRect:n.$maskRect;return g&&!g.contains(o,s)?!1:!0}return!1},i.prototype.$addListener=function(e,n,a,o,s,h){r.prototype.$addListener.call(this,e,n,a,o,s,h);var l=e==t.Event.ENTER_FRAME;if(l||e==t.Event.RENDER){var c=l?i.$enterFrameCallBackList:i.$renderCallBackList;-1==c.indexOf(this)&&c.push(this)}},i.prototype.removeEventListener=function(e,n,a,o){r.prototype.removeEventListener.call(this,e,n,a,o);var s=e==t.Event.ENTER_FRAME;if((s||e==t.Event.RENDER)&&!this.hasEventListener(e)){var h=s?i.$enterFrameCallBackList:i.$renderCallBackList,l=h.indexOf(this);-1!==l&&h.splice(l,1)}},i.prototype.dispatchEvent=function(t){if(!t.$bubbles)return r.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),i=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,i),!t.$isDefaultPrevented},i.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var r=e.concat();return r.reverse(),e=r.concat(e)},i.prototype.$dispatchPropagationEvent=function(t,e,r){for(var i=e.length,n=r-1,a=0;i>a;a++){var o=e[a];if(t.$currentTarget=o,n>a?t.$eventPhase=1:a==r||a==n?t.$eventPhase=2:t.$eventPhase=3,o.$notifyListener(t,r>a),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},i.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},i.defaultTouchEnabled=!1,i.$enterFrameCallBackList=[],i.$renderCallBackList=[],i}(t.EventDispatcher);t.DisplayObject=r,__reflect(r.prototype,"egret.DisplayObject")}(egret||(egret={}));var egret;!function(t){function e(){return""}function r(t){throw new Error("#"+t)}function i(){}function n(){}t.getString=e,t.$error=r,t.$warn=i,t.$markCannotUse=n}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.$touchChildren=!0,t.$children=[],t}return __extends(r,e),Object.defineProperty(r.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),r.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},r.prototype.addChildAt=function(t,e){return e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},r.prototype.$doAddChild=function(e,i,n){void 0===n&&(n=!0);var a=this,o=e.$parent;if(o==a)return a.doSetChildIndex(e,i),e;o&&o.removeChild(e),a.$children.splice(i,0,e),e.$setParent(a);var s=a.$stage;if(s&&e.$onAddToStage(s,a.$nestLevel+1),n&&e.dispatchEventWith(t.Event.ADDED,!0),s)for(var h=r.$EVENT_ADD_TO_STAGE_LIST;h.length;){var l=h.shift();l.$stage&&n&&l.dispatchEventWith(t.Event.ADDED_TO_STAGE)}if(__global.nativeRender)a.$nativeNode.addChildAt(e.$nativeNode.id,i);else if(!a.$cacheDirty){a.$cacheDirty=!0;var c=a.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var u=a.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return this.$childAdded(e,i),e},r.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},r.prototype.getChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$children[t]:null},r.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},r.prototype.getChildByName=function(t){for(var e,r=this.$children,i=r.length,n=0;i>n;n++)if(e=r[n],e.name==t)return e;return null},r.prototype.removeChild=function(t){var e=this.$children.indexOf(t);return e>=0?this.$doRemoveChild(e):null},r.prototype.removeChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$doRemoveChild(t):null},r.prototype.$doRemoveChild=function(e,i){void 0===i&&(i=!0),e=0|+e;var n=this,a=this.$children,o=a[e];if(this.$childRemoved(o,e),i&&o.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){o.$onRemoveFromStage();for(var s=r.$EVENT_REMOVE_FROM_STAGE_LIST;s.length>0;){var h=s.shift();i&&h.$hasAddToStage&&(h.$hasAddToStage=!1,h.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),h.$hasAddToStage=!1,h.$stage=null}}this.$displayList||this.$parentDisplayList;o.$setParent(null);var l=a.indexOf(o);if(-1!=l&&a.splice(l,1),__global.nativeRender)n.$nativeNode.removeChild(o.$nativeNode.id);else if(!n.$cacheDirty){n.$cacheDirty=!0;var c=n.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var u=n.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return o},r.prototype.setChildIndex=function(t,e){e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},r.prototype.doSetChildIndex=function(t,e){var r=this,i=this.$children.indexOf(t);if(i!=e)if(this.$childRemoved(t,i),this.$children.splice(i,1),this.$children.splice(e,0,t),this.$childAdded(t,e),__global.nativeRender)this.$nativeNode.removeChild(t.$nativeNode.id),this.$nativeNode.addChildAt(t.$nativeNode.id,e);else if(!r.$cacheDirty){r.$cacheDirty=!0;var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},r.prototype.swapChildrenAt=function(t,e){t=0|+t,e=0|+e,t>=0&&t<this.$children.length&&e>=0&&e<this.$children.length&&this.doSwapChildrenAt(t,e)},r.prototype.swapChildren=function(t,e){var r=this.$children.indexOf(t),i=this.$children.indexOf(e);-1==r||-1==i||this.doSwapChildrenAt(r,i)},r.prototype.doSwapChildrenAt=function(t,e){var r=this;if(t>e){var i=e;e=t,t=i}else if(t==e)return;var n=this.$children,a=n[t],o=n[e];if(this.$childRemoved(a,t),this.$childRemoved(o,e),n[t]=o,n[e]=a,this.$childAdded(o,t),this.$childAdded(a,e),__global.nativeRender)this.$nativeNode.swapChild(t,e);else if(!r.$cacheDirty){r.$cacheDirty=!0;var s=r.$parent;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp());var h=r.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}},r.prototype.removeChildren=function(){for(var t=this.$children,e=t.length-1;e>=0;e--)this.$doRemoveChild(e)},r.prototype.$childAdded=function(t,e){},r.prototype.$childRemoved=function(t,e){},r.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r);var i=this.$children,n=i.length;r++;for(var a=0;n>a;a++){var o=this.$children[a];o.$onAddToStage(t,r)}},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,r=t.length,i=0;r>i;i++){var n=t[i];n.$onRemoveFromStage()}},r.prototype.$measureChildBounds=function(e){var r=this.$children,i=r.length;if(0!=i){for(var n=0,a=0,o=0,s=0,h=!1,l=-1;i>l;l++){var c=-1==l?e:r[l].$getTransformedBounds(this,t.$TempRectangle);c.isEmpty()||(h?(n=Math.min(n,c.x),a=Math.max(a,c.x+c.width),o=Math.min(o,c.y),s=Math.max(s,c.y+c.height)):(h=!0,n=c.x,a=n+c.width,o=c.y,s=o+c.height))}e.setTo(n,o,a-n,s-o)}},Object.defineProperty(r.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),r.prototype.$getTouchChildren=function(){return this.$touchChildren},r.prototype.$setTouchChildren=function(t){return this.$touchChildren==t?!1:(this.$touchChildren=t,!0)},r.prototype.$hitTest=function(t,r){if(!this.$visible)return null;var i=this.$getInvertedConcatenatedMatrix(),n=i.a*t+i.c*r+i.tx,a=i.b*t+i.d*r+i.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(t,r))return null;for(var s=this.$children,h=!1,l=null,c=s.length-1;c>=0;c--){var u=s[c];if(!u.$maskedObject&&(l=u.$hitTest(t,r))){if(h=!0,l.$touchEnabled)break;l=null}}return l?this.$touchChildren?l:this:h?this:e.prototype.$hitTest.call(this,t,r)},r.$EVENT_ADD_TO_STAGE_LIST=[],r.$EVENT_REMOVE_FROM_STAGE_LIST=[],r}(t.DisplayObject);t.DisplayObjectContainer=e,__reflect(e.prototype,"egret.DisplayObjectContainer")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i,n){var a=t.call(this)||this;return a.$eventPhase=2,a.$currentTarget=null,a.$target=null,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$type=e,a.$bubbles=!!r,a.$cancelable=!!i,a.data=n,a}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),e.prototype.$setTarget=function(t){return this.$target=t,!0},e.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},e.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},e.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},e.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},e.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},e.dispatchEvent=function(t,r,i,n){void 0===i&&(i=!1);var a=e.create(e,r,i),o=e._getPropertyData(e);void 0!=n&&(o.data=n);var s=t.dispatchEvent(a);return e.release(a),s},e._getPropertyData=function(t){var e=t._props;return e||(e=t._props={}),e},e.create=function(t,e,r,i){var n=t.eventPool;if(n||(n=t.eventPool=[]),n.length){var a=n.pop();return a.$type=e,a.$bubbles=!!r,a.$cancelable=!!i,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$eventPhase=2,a}return new t(e,r,i)},e.release=function(t){t.clean();var e=Object.getPrototypeOf(t).constructor;e.eventPool.push(t)},e.ADDED_TO_STAGE="addedToStage",e.REMOVED_FROM_STAGE="removedFromStage",e.ADDED="added",e.REMOVED="removed",e.ENTER_FRAME="enterFrame",e.RENDER="render",e.RESIZE="resize",e.CHANGE="change",e.CHANGING="changing",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e.ENDED="ended",e.ACTIVATE="activate",e.DEACTIVATE="deactivate",e.CLOSE="close",e.CONNECT="connect",e.LEAVE_STAGE="leaveStage",e.SOUND_COMPLETE="soundComplete",e}(t.HashObject);t.Event=e,__reflect(e.prototype,"egret.Event")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.type=null,r.$id=null,r.paddingTop=0,r.paddingBottom=0,r.paddingLeft=0,r.paddingRight=0,r.$uniforms={},__global.nativeRender&&t.NativeNode.createFilter(r),r}return __extends(r,e),r.prototype.$toJson=function(){return""},r.prototype.updatePadding=function(){},r.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),__global.nativeRender&&(t.NativeNode.setFilterPadding(e.$id,e.paddingTop,e.paddingBottom,e.paddingLeft,e.paddingRight),t.NativeNode.setDataToFilter(e.$id))},r}(t.HashObject);t.Filter=e,__reflect(e.prototype,"egret.Filter")}(egret||(egret={}));
var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$graphics=new t.Graphics,r.$graphics.$setTarget(r),r}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(9)},Object.defineProperty(r.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),r.prototype.$hitTest=function(e,r){if(!this.$visible)return null;var i=this.$getInvertedConcatenatedMatrix(),n=i.a*e+i.c*r+i.tx,a=i.b*e+i.d*r+i.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(e,r))return null;for(var s=this.$children,h=!1,l=null,c=s.length-1;c>=0;c--){var u=s[c];if(!u.$maskedObject&&(l=u.$hitTest(e,r))){if(h=!0,l.$touchEnabled)break;l=null}}return l?this.$touchChildren?l:this:h?this:(l=t.DisplayObject.prototype.$hitTest.call(this,e,r),l&&(l=this.$graphics.$hitTest(e,r)),l)},r.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},r}(t.DisplayObjectContainer);t.Sprite=e,__reflect(e.prototype,"egret.Sprite")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.PERMISSION_DENIED="permissionDenied",e.UNAVAILABLE="unavailable",e}(t.Event);t.GeolocationEvent=e,__reflect(e.prototype,"egret.GeolocationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),e.call(this,t,r,i)||this}return __extends(r,e),r.dispatchIOErrorEvent=function(e){var i=t.Event.create(r,r.IO_ERROR),n=e.dispatchEvent(i);return t.Event.release(i),n},r.IO_ERROR="ioError",r}(t.Event);t.IOErrorEvent=e,__reflect(e.prototype,"egret.IOErrorEvent")}(egret||(egret={}));var egret;!function(t){var e=[],r=Math.PI/180,i=function(i){function n(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var r=i.call(this)||this;return r.x=t,r.y=e,r}return __extends(n,i),n.release=function(t){t&&e.push(t)},n.create=function(t,r){var i=e.pop();return i||(i=new n),i.setTo(t,r)},Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),n.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},n.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},n.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.interpolate=function(t,e,r){var i=1-r;return new n(t.x*r+e.x*i,t.y*r+e.y*i)},n.prototype.normalize=function(t){if(0!=this.x||0!=this.y){var e=t/this.length;this.x*=e,this.y*=e}},n.prototype.offset=function(t,e){this.x+=t,this.y+=e},n.polar=function(e,i){return new n(e*t.NumberUtils.cos(i/r),e*t.NumberUtils.sin(i/r))},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},n}(t.HashObject);t.Point=i,__reflect(i.prototype,"egret.Point"),t.$TempPoint=new i}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this)||this;return i._bitmapX=0,i._bitmapY=0,i._textureMap=t.createMap(),i.$texture=r,i._bitmapX=r.$bitmapX-r.$offsetX,i._bitmapY=r.$bitmapY-r.$offsetY,i}return __extends(r,e),r.prototype.getTexture=function(t){return this._textureMap[t]},r.prototype.createTexture=function(e,r,i,n,a,o,s,h,l){void 0===o&&(o=0),void 0===s&&(s=0),void 0===h&&(h=o+n),void 0===l&&(l=s+a);var c=new t.Texture;return c.disposeBitmapData=!1,c.$bitmapData=this.$texture.$bitmapData,c.$initData(this._bitmapX+r,this._bitmapY+i,n,a,o,s,h,l,this.$texture.$sourceWidth,this.$texture.$sourceHeight),this._textureMap[e]=c,c},r.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},r}(t.HashObject);t.SpriteSheet=e,__reflect(e.prototype,"egret.SpriteSheet")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i,n,a,o,s,h){void 0===e&&(e=16711680),void 0===r&&(r=1),void 0===i&&(i=6),void 0===n&&(n=6),void 0===a&&(a=2),void 0===o&&(o=1),void 0===s&&(s=!1),void 0===h&&(h=!1);var l=t.call(this)||this,c=l;return c.type="glow",c.$color=e,c.$blue=255&e,c.$green=(65280&e)>>8,c.$red=e>>16,c.$alpha=r,c.$blurX=i,c.$blurY=n,c.$strength=a,c.$quality=o,c.$inner=s,c.$knockout=h,c.$uniforms.color={x:l.$red/255,y:l.$green/255,z:l.$blue/255,w:1},c.$uniforms.alpha=r,c.$uniforms.blurX=i,c.$uniforms.blurY=n,c.$uniforms.strength=a,c.$uniforms.inner=s?1:0,c.$uniforms.knockout=h?0:1,c.$uniforms.dist=0,c.$uniforms.angle=0,c.$uniforms.hideObject=0,c.onPropertyChange(),l}return __extends(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.$uniforms.color.x=this.$red/255,this.$uniforms.color.y=this.$green/255,this.$uniforms.color.z=this.$blue/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.$uniforms.alpha=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.$uniforms.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.$uniforms.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.$uniforms.strength=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.$uniforms.inner=t?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.$uniforms.knockout=t?0:1)},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},e.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},e}(t.Filter);t.GlowFilter=e,__reflect(e.prototype,"egret.GlowFilter")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(egret||(egret={})),function(t){var e;!function(e){function r(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var n=t.$locale_strings[t.$language][e];if(!n)return"{"+e+"}";for(var a=r.length,o=0;a>o;o++)n=n.replace("{"+o+"}",r[o]);return n}e.tr=r}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){t.$TextureScaleFactor=1;var e=function(e){function r(){var t=e.call(this)||this;return t.disposeBitmapData=!0,t.$bitmapX=0,t.$bitmapY=0,t.$bitmapWidth=0,t.$bitmapHeight=0,t.$offsetX=0,t.$offsetY=0,t.$textureWidth=0,t.$textureHeight=0,t.$sourceWidth=0,t.$sourceHeight=0,t.$bitmapData=null,t.$rotated=!1,t}return __extends(r,e),Object.defineProperty(r.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),r.prototype.$getTextureWidth=function(){return this.$textureWidth},Object.defineProperty(r.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),r.prototype.$getTextureHeight=function(){return this.$textureHeight},r.prototype.$getScaleBitmapWidth=function(){return this.$bitmapWidth*t.$TextureScaleFactor},r.prototype.$getScaleBitmapHeight=function(){return this.$bitmapHeight*t.$TextureScaleFactor},Object.defineProperty(r.prototype,"bitmapData",{get:function(){return this.$bitmapData},set:function(t){this._setBitmapData(t)},enumerable:!0,configurable:!0}),r.prototype._setBitmapData=function(e){this.$bitmapData=e;var r=t.$TextureScaleFactor,i=e.width*r,n=e.height*r;this.$initData(0,0,i,n,0,0,i,n,e.width,e.height)},r.prototype.$initData=function(e,r,i,n,a,o,s,h,l,c,u){void 0===u&&(u=!1);var d=t.$TextureScaleFactor;this.$bitmapX=e/d,this.$bitmapY=r/d,this.$bitmapWidth=i/d,this.$bitmapHeight=n/d,this.$offsetX=a,this.$offsetY=o,this.$textureWidth=s,this.$textureHeight=h,this.$sourceWidth=l,this.$sourceHeight=c,this.$rotated=u,t.BitmapData.$invalidate(this.$bitmapData)},r.prototype.getPixel32=function(t,e){throw new Error},r.prototype.getPixels=function(t,e,r,i){throw void 0===r&&(r=1),void 0===i&&(i=1),new Error},r.prototype.toDataURL=function(t,e,r){throw new Error},r.prototype.saveToFile=function(t,e,r){throw new Error},r.prototype.dispose=function(){this.$bitmapData&&(this.disposeBitmapData&&this.$bitmapData.$dispose(),this.$bitmapData=null),__global.nativeRender&&t.NativeNode.disposeTexture(this)},r}(t.HashObject);t.Texture=e,__reflect(e.prototype,"egret.Texture")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(i){var n=e.call(this)||this;return n.$texture=null,n.$bitmapData=null,n.$bitmapX=0,n.$bitmapY=0,n.$bitmapWidth=0,n.$bitmapHeight=0,n.$offsetX=0,n.$offsetY=0,n.$textureWidth=0,n.$textureHeight=0,n.$sourceWidth=0,n.$sourceHeight=0,n.$smoothing=r.defaultSmoothing,n.$explicitBitmapWidth=0/0,n.$explicitBitmapHeight=0/0,n.$scale9Grid=null,n.$fillMode="scale",n._pixelHitTest=!1,n.$renderNode=new t.sys.NormalBitmapNode,n.$setTexture(i),i&&(n.$renderNode.rotated=i.$rotated),n}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(1)},r.prototype.$onAddToStage=function(r,i){e.prototype.$onAddToStage.call(this,r,i);var n=this.$texture;n&&t.BitmapData.$addDisplayObject(this,n.$bitmapData)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var r=this.$texture;r&&t.BitmapData.$removeDisplayObject(this,r.$bitmapData)},Object.defineProperty(r.prototype,"texture",{get:function(){return this.$texture},set:function(t){var e=this;e.$setTexture(t),t&&e.$renderNode&&(e.$renderNode.rotated=t.$rotated)},enumerable:!0,configurable:!0}),r.prototype.$setTexture=function(e){var r=this,i=r.$texture;if(e==i)return!1;if(r.$texture=e,!e){i&&t.BitmapData.$removeDisplayObject(r,i.$bitmapData),r.setImageData(null,0,0,0,0,0,0,0,0,0,0),r.$renderDirty=!0;var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;return a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp()),__global.nativeRender&&this.setBitmapDataToWasm(null),!0}if(r.$refreshImageData(),r.$stage){if(i){var o=i.$bitmapData.hashCode,s=e.$bitmapData.hashCode;if(o==s){r.$renderDirty=!0;var h=r.$parent;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp());var l=r.$maskedObject;return l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp()),!0}t.BitmapData.$removeDisplayObject(r,i.$bitmapData)}t.BitmapData.$addDisplayObject(r,e.$bitmapData)}r.$renderDirty=!0;var c=r.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var u=r.$maskedObject;return u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp()),!0},r.prototype.$setBitmapData=function(t){this.$setTexture(t)},r.prototype.setBitmapDataToWasm=function(t){this.$nativeNode.setBitmapData(t)},r.prototype.$refreshImageData=function(){var t=this.$texture;t?(__global.nativeRender&&this.setBitmapDataToWasm(t),this.setImageData(t.$bitmapData,t.$bitmapX,t.$bitmapY,t.$bitmapWidth,t.$bitmapHeight,t.$offsetX,t.$offsetY,t.$getTextureWidth(),t.$getTextureHeight(),t.$sourceWidth,t.$sourceHeight)):__global.nativeRender&&this.setBitmapDataToWasm(null)},r.prototype.setImageData=function(t,e,r,i,n,a,o,s,h,l,c){this.$bitmapData=t,this.$bitmapX=e,this.$bitmapY=r,this.$bitmapWidth=i,this.$bitmapHeight=n,this.$offsetX=a,this.$offsetY=o,this.$textureWidth=s,this.$textureHeight=h,this.$sourceWidth=l,this.$sourceHeight=c},Object.defineProperty(r.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t)},enumerable:!0,configurable:!0}),r.prototype.$setScale9Grid=function(t){var e=this;if(e.$scale9Grid=t,e.$renderDirty=!0,__global.nativeRender)t?e.$nativeNode.setScale9Grid(t.x,t.y,t.width,t.height):e.$nativeNode.setScale9Grid(0,0,-1,-1);else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),r.prototype.$setFillMode=function(t){return t==this.$fillMode?!1:(this.$fillMode=t,!0)},Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t,this.$renderNode.smoothing=t)},enumerable:!0,configurable:!0}),r.prototype.$setWidth=function(t){var e=this;if(0>t||t==e.$explicitBitmapWidth)return!1;if(e.$explicitBitmapWidth=t,e.$renderDirty=!0,__global.nativeRender)e.$nativeNode.setWidth(t);else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}return!0},r.prototype.$setHeight=function(t){var e=this;if(0>t||t==e.$explicitBitmapHeight)return!1;if(e.$explicitBitmapHeight=t,e.$renderDirty=!0,__global.nativeRender)e.$nativeNode.setHeight(t);else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}return!0},r.prototype.$getWidth=function(){return isNaN(this.$explicitBitmapWidth)?this.$getContentBounds().width:this.$explicitBitmapWidth},r.prototype.$getHeight=function(){return isNaN(this.$explicitBitmapHeight)?this.$getContentBounds().height:this.$explicitBitmapHeight},r.prototype.$measureContentBounds=function(t){if(this.$bitmapData){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight;t.setTo(0,0,e,r)}else{var e=isNaN(this.$explicitBitmapWidth)?0:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?0:this.$explicitBitmapHeight;t.setTo(0,0,e,r)}},r.prototype.$updateRenderNode=function(){if(this.$texture){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,i=this.scale9Grid||this.$texture.scale9Grid;i?(this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureDataWithScale9Grid(this.$renderNode,this.$bitmapData,i,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,r,this.$sourceWidth,this.$sourceHeight,this.$smoothing)):(this.fillMode==t.BitmapFillMode.REPEAT&&this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureData(this.$renderNode,this.$bitmapData,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,r,this.$sourceWidth,this.$sourceHeight,this.$fillMode,this.$smoothing))}},Object.defineProperty(r.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),r.prototype.$hitTest=function(t,r){var i=e.prototype.$hitTest.call(this,t,r);if(i&&this._pixelHitTest){var n=this.hitTestPoint(t,r,!0);n||(i=null)}return i},r.defaultSmoothing=!0,r}(t.DisplayObject);t.Bitmap=e,__reflect(e.prototype,"egret.Bitmap")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.drawData=[],this.renderCount=0}return t.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},t.prototype.$getRenderCount=function(){return this.renderCount},t}();t.RenderNode=e,__reflect(e.prototype,"egret.sys.RenderNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}return t.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var r=this.dataPosition;this.$data[r++]=t,this.$data[r++]=e,this.dataPosition=r},t.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var r=this.dataPosition;this.$data[r++]=t,this.$data[r++]=e,this.dataPosition=r},t.prototype.curveTo=function(t,e,r,i){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=r,this.$data[n++]=i,this.dataPosition=n},t.prototype.cubicCurveTo=function(t,e,r,i,n,a){this.$commands[this.commandPosition++]=4;var o=this.dataPosition;this.$data[o++]=t,this.$data[o++]=e,this.$data[o++]=r,this.$data[o++]=i,this.$data[o++]=n,this.$data[o++]=a,this.dataPosition=o},t.prototype.drawRect=function(t,e,r,i){var n=t+r,a=e+i;this.moveTo(t,e),this.lineTo(n,e),this.lineTo(n,a),this.lineTo(t,a),this.lineTo(t,e)},t.prototype.drawRoundRect=function(t,e,r,i,n,a){var o=.5*n|0,s=a?.5*a|0:o;if(!o||!s)return void this.drawRect(t,e,r,i);var h=.5*r,l=.5*i;if(o>h&&(o=h),s>l&&(s=l),h===o&&l===s)return void(o===s?this.drawCircle(t+o,e+s,o):this.drawEllipse(t,e,2*o,2*s));var c=t+r,u=e+i,d=t+o,p=c-o,f=e+s,g=u-s;this.moveTo(c,g),this.curveTo(c,u,p,u),this.lineTo(d,u),this.curveTo(t,u,t,g),this.lineTo(t,f),this.curveTo(t,e,d,e),this.lineTo(p,e),this.curveTo(c,e,c,f),this.lineTo(c,g)},t.prototype.drawCircle=function(t,e,r){this.arcToBezier(t,e,r,r,0,2*Math.PI)},t.prototype.drawEllipse=function(t,e,r,i){var n=.5*r,a=.5*i;t+=n,e+=a,this.arcToBezier(t,e,n,a,0,2*Math.PI)},t.prototype.drawArc=function(t,e,r,i,n,a){a?n>=i&&(n-=2*Math.PI):i>=n&&(n+=2*Math.PI),this.arcToBezier(t,e,r,r,i,n,a)},t.prototype.arcToBezier=function(t,e,r,i,n,a,o){var s=.5*Math.PI,h=n,l=h;o?(l+=-s-h%s,a>l&&(l=a)):(l+=s-h%s,l>a&&(l=a));var c=t+Math.cos(h)*r,u=e+Math.sin(h)*i;(this.$lastX!=c||this.$lastY!=u)&&this.moveTo(c,u);for(var d=Math.cos(h),p=Math.sin(h),f=0;4>f;f++){var g=l-h,v=4*Math.tan(g/4)/3,y=c-p*v*r,$=u+d*v*i;d=Math.cos(l),p=Math.sin(l),c=t+d*r,u=e+p*i;var b=c+p*v*r,m=u-d*v*i;if(this.cubicCurveTo(y,$,b,m,c,u),l===a)break;h=l,o?(l=h-s,a>l&&(l=a)):(l=h+s,l>a&&(l=a))}},t}();t.Path2D=e,__reflect(e.prototype,"egret.sys.Path2D")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.DeviceOrientation=null}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.WEB="web",t.NATIVE="native"}(e=t.RuntimeType||(t.RuntimeType={}));var r=function(){function t(){}return Object.defineProperty(t,"language",{get:function(){return t.$language},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMobile",{get:function(){return t.$isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"os",{get:function(){return t.$os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"runtimeType",{get:function(){return t.$runtimeType},enumerable:!0,configurable:!0}),Object.defineProperty(t,"supportVersion",{get:function(){return t.$supportVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"engineVersion",{get:function(){return"5.1.1"},enumerable:!0,configurable:!0}),t.$setNativeCapabilities=function(e){var r=e.split("-");if(r.length<=4){var i=r[0];switch(i){case"android":i="Android";break;case"ios":i="iOS"}t.$os=i;var n=r[2].substring(1,r[2].length);t.$supportVersion=n}},Object.defineProperty(t,"renderMode",{get:function(){return t.$renderMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"boundingClientWidth",{get:function(){return t.$boundingClientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"boundingClientHeight",{get:function(){return t.$boundingClientHeight},enumerable:!0,configurable:!0}),t.$language="zh-CN",t.$os="Unknown",t.$runtimeType="Unknown",t.$supportVersion="Unknown",t.$renderMode="Unknown",t.$boundingClientWidth=0,t.$boundingClientHeight=0,t}();t.Capabilities=r,__reflect(r.prototype,"egret.Capabilities")}(egret||(egret={})),egret.Capabilities.$isMobile=function(){if(!global.navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")}(),egret.Capabilities.$runtimeType=function(){return global.navigator?!0:!1}()?egret.RuntimeType.WEB:egret.RuntimeType.NATIVE;var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t}t.createMap=e}(egret||(egret={}));var egret;!function(t){function e(t,e,r){var i=t.prototype;i.__class__=e;var n=[e];r&&(n=n.concat(r));var a=i.__types__;if(i.__types__)for(var o=a.length,s=0;o>s;s++){var h=a[s];-1==n.indexOf(h)&&n.push(h)}i.__types__=n}t.registerClass=e}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"logLevel",{set:function(t){},enumerable:!0,configurable:!0}),t.ALL="all",t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error",t.OFF="off",t}();t.Logger=e,__reflect(e.prototype,"egret.Logger")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){t.JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"}}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function t(){}return t.call=function(t,e){},t.addCallback=function(t,e){},t}();e.WebExternalInterface=r,__reflect(r.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]);var i=navigator.userAgent.toLowerCase();i.indexOf("egretnative")<0&&(t.ExternalInterface=r)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){function r(e){var r=JSON.parse(e),n=r.functionName,a=i[n];if(a){var o=r.value;a.call(null,o)}else t.$warn(1050,n)}var i={},n=function(){function t(){}return t.call=function(t,e){var r={};r.functionName=t,r.value=e,egret_native.sendInfoToPlugin(JSON.stringify(r))},t.addCallback=function(t,e){i[t]=e},t}();e.NativeExternalInterface=n,__reflect(n.prototype,"egret.web.NativeExternalInterface",["egret.ExternalInterface"]);var a=navigator.userAgent.toLowerCase();a.indexOf("egretnative")>=0&&(t.ExternalInterface=n,egret_native.receivedPluginInfo=r)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var r={},i=function(){function e(){}return e.call=function(t,e){__global.ExternalInterface.call(t,e)},e.addCallback=function(t,e){r[t]=e},e.invokeCallback=function(e,i){var n=r[e];n?n.call(null,i):t.$warn(1050,e)},e}();e.WebViewExternalInterface=i,__reflect(i.prototype,"egret.web.WebViewExternalInterface",["egret.ExternalInterface"]);var n=navigator.userAgent.toLowerCase();n.indexOf("egretwebview")>=0&&(t.ExternalInterface=i)}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(t,n,a){void 0===t&&(t=4),void 0===n&&(n=4),void 0===a&&(a=1);var o=e.call(this)||this,s=o;return s.type="blur",s.$blurX=t,s.$blurY=n,s.$quality=a,s.blurXFilter=new r(t),s.blurYFilter=new i(n),s.onPropertyChange(),o}return __extends(n,e),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.blurXFilter.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.blurYFilter.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),n.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},n.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},n.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),__global.nativeRender&&(t.NativeNode.setFilterPadding(e.blurXFilter.$id,0,0,e.paddingLeft,e.paddingRight),t.NativeNode.setFilterPadding(e.blurYFilter.$id,e.paddingTop,e.paddingBottom,0,0),t.NativeNode.setDataToFilter(e.$id))},n}(t.Filter);t.BlurFilter=e,__reflect(e.prototype,"egret.BlurFilter");var r=function(t){function e(e){void 0===e&&(e=4);var r=t.call(this)||this;return __global.nativeRender?r.type="blur":r.type="blurX",r.$uniforms.blur={x:e,y:0},r.onPropertyChange(),r}return __extends(e,t),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$uniforms.blur.x},set:function(t){this.$uniforms.blur.x=t},enumerable:!0,configurable:!0}),e}(t.Filter);__reflect(r.prototype,"BlurXFilter",["egret.IBlurXFilter"]);var i=function(t){function e(e){void 0===e&&(e=4);var r=t.call(this)||this;return __global.nativeRender?r.type="blur":r.type="blurY",r.$uniforms.blur={x:0,y:e},r.onPropertyChange(),r}return __extends(e,t),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$uniforms.blur.y},set:function(t){this.$uniforms.blur.y=t},enumerable:!0,configurable:!0}),e}(t.Filter);__reflect(i.prototype,"BlurYFilter",["egret.IBlurYFilter"])}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.$matrix=[],r.matrix2=[],r.type="colorTransform",r.$uniforms.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.$uniforms.colorAdd={x:0,y:0,z:0,w:0},r.setMatrix(e),r.onPropertyChange(),r}return __extends(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){for(var t=0;20>t;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t)},enumerable:!0,configurable:!0}),e.prototype.setMatrix=function(t){if(t)for(var e=0;20>e;e++)this.$matrix[e]=t[e];else for(var e=0;20>e;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0;for(var r=this.$matrix,i=this.$uniforms.matrix,n=this.$uniforms.colorAdd,e=0,a=0;e<r.length;e++)4===e?n.x=r[e]/255:9===e?n.y=r[e]/255:14===e?n.z=r[e]/255:19===e?n.w=r[e]/255:(i[a]=r[e],a++)},e.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},e}(t.Filter);t.ColorMatrixFilter=e,__reflect(e.prototype,"egret.ColorMatrixFilter")}(egret||(egret={}));var egret;!function(t){var e,r={},i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),a=0,o=function(){for(var t=0;36>t;t++)8===t||13===t||18===t||23===t?n[t]="-":14===t?n[t]="4":(2>=a&&(a=33554432+16777216*Math.random()|0),e=15&a,a>>=4,n[t]=i[19===t?3&e|8:e]);return n.join("")},s=function(e){function i(t,i,n){void 0===n&&(n={});var a=e.call(this)||this;a.$padding=0,a.$vertexSrc=t,a.$fragmentSrc=i;var s=t+i;return r[s]||(r[s]=o()),a.$shaderKey=r[s],a.$uniforms=n,a.type="custom",a}return __extends(i,e),Object.defineProperty(i.prototype,"padding",{get:function(){return this.$padding},set:function(t){var e=this;e.$padding!=t&&(e.$padding=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"uniforms",{get:function(){return this.$uniforms},enumerable:!0,configurable:!0}),i.prototype.onPropertyChange=function(){if(__global.nativeRender){var e=this;t.NativeNode.setFilterPadding(e.$id,e.$padding,e.$padding,e.$padding,e.$padding),t.NativeNode.setDataToFilter(e.$id)}},i}(t.Filter);t.CustomFilter=s,__reflect(s.prototype,"egret.CustomFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n,a,o,s,h,l,c,u){void 0===t&&(t=4),void 0===r&&(r=45),void 0===i&&(i=0),void 0===n&&(n=1),void 0===a&&(a=4),void 0===o&&(o=4),void 0===s&&(s=1),void 0===h&&(h=1),void 0===l&&(l=!1),void 0===c&&(c=!1),void 0===u&&(u=!1);var d=e.call(this,i,n,a,o,s,h,l,c)||this,p=d;return p.$distance=t,p.$angle=r,p.$hideObject=u,p.$uniforms.dist=t,p.$uniforms.angle=r/180*Math.PI,p.$uniforms.hideObject=u?1:0,p.onPropertyChange(),d}return __extends(r,e),Object.defineProperty(r.prototype,"distance",{get:function(){return this.$distance},set:function(t){var e=this;e.$distance!=t&&(e.$distance=t,e.$uniforms.dist=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"angle",{get:function(){return this.$angle},set:function(t){var e=this;e.$angle!=t&&(e.$angle=t,e.$uniforms.angle=t/180*Math.PI,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.$uniforms.hideObject=t?1:0)},enumerable:!0,configurable:!0}),r.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},r.prototype.updatePadding=function(){var e=this;e.paddingLeft=e.blurX,e.paddingRight=e.blurX,e.paddingTop=e.blurY,e.paddingBottom=e.blurY;var r=e.distance||0,i=e.angle||0,n=0,a=0;0!=r&&(n=r*t.NumberUtils.cos(i),n=n>0?Math.ceil(n):Math.floor(n),a=r*t.NumberUtils.sin(i),a=a>0?Math.ceil(a):Math.floor(a),e.paddingLeft+=n,e.paddingRight+=n,e.paddingTop+=a,e.paddingBottom+=a)},r}(t.GlowFilter);t.DropShadowFilter=e,__reflect(e.prototype,"egret.DropShadowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i._verticesDirty=!0,i._bounds=new t.Rectangle,i.$renderNode=new t.sys.MeshNode,i}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(12)},r.prototype.setBitmapDataToWasm=function(t){this.$nativeNode.setBitmapDataToMesh(t)},r.prototype.$updateRenderNode=function(){var e=this.$bitmapData;if(e){var r=(t.$TextureScaleFactor,this.$renderNode);r.smoothing=this.$smoothing,r.image=e,r.imageWidth=this.$sourceWidth,r.imageHeight=this.$sourceHeight;var i=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,n=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,a=i/this.$textureWidth,o=n/this.$textureHeight,s=this.$bitmapWidth,h=this.$bitmapHeight;r.drawMesh(this.$bitmapX,this.$bitmapY,s,h,this.$offsetX*a,this.$offsetY*o,a*s,o*h)}},r.prototype.$updateVertices=function(){var t=this;if(t._verticesDirty=!0,t.$renderDirty=!0,__global.nativeRender){var e=this.$renderNode;this.$nativeNode.setDataToMesh(e.vertices,e.indices,e.uvs)}else{var r=t.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=t.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},r.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,r=e.vertices;if(r.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var i=0,n=r.length;n>i;i+=2){var a=r[i],o=r[i+1];this._bounds.x>a&&(this._bounds.x=a),this._bounds.width<a&&(this._bounds.width=a),this._bounds.y>o&&(this._bounds.y=o),this._bounds.height<o&&(this._bounds.height=o)
}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},r}(t.Bitmap);t.Mesh=e,__reflect(e.prototype,"egret.Mesh")}(egret||(egret={}));var egret;!function(t){t.OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"}}(egret||(egret={}));var egret;!function(t){var e=Math.PI,r=2*e,i=e/180,n=[],a=function(a){function o(t,e,r,i,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=0);var s=a.call(this)||this;return s.a=t,s.b=e,s.c=r,s.d=i,s.tx=n,s.ty=o,s}return __extends(o,a),o.release=function(t){t&&n.push(t)},o.create=function(){var t=n.pop();return t||(t=new o),t},o.prototype.clone=function(){return new o(this.a,this.b,this.c,this.d,this.tx,this.ty)},o.prototype.concat=function(t){var e=this.a*t.a,r=0,i=0,n=this.d*t.d,a=this.tx*t.a+t.tx,o=this.ty*t.d+t.ty;(0!==this.b||0!==this.c||0!==t.b||0!==t.c)&&(e+=this.b*t.c,n+=this.c*t.b,r+=this.a*t.b+this.b*t.d,i+=this.c*t.a+this.d*t.c,a+=this.ty*t.c,o+=this.tx*t.b),this.a=e,this.b=r,this.c=i,this.d=n,this.tx=a,this.ty=o},o.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},o.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},o.prototype.invert=function(){this.$invertInto(this)},o.prototype.$invertInto=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,a=this.tx,o=this.ty;if(0==r&&0==i)return t.b=t.c=0,void(0==e||0==n?t.a=t.d=t.tx=t.ty=0:(e=t.a=1/e,n=t.d=1/n,t.tx=-e*a,t.ty=-n*o));var s=e*n-r*i;if(0==s)return void t.identity();s=1/s;var h=t.a=n*s;r=t.b=-r*s,i=t.c=-i*s,n=t.d=e*s,t.tx=-(h*a+i*o),t.ty=-(r*a+n*o)},o.prototype.rotate=function(e){if(e=+e,0!==e){e/=i;var r=t.NumberUtils.cos(e),n=t.NumberUtils.sin(e),a=this.a,o=this.b,s=this.c,h=this.d,l=this.tx,c=this.ty;this.a=a*r-o*n,this.b=a*n+o*r,this.c=s*r-h*n,this.d=s*n+h*r,this.tx=l*r-c*n,this.ty=l*n+c*r}},o.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},o.prototype.setTo=function(t,e,r,i,n,a){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=a,this},o.prototype.transformPoint=function(e,r,i){var n=this.a*e+this.c*r+this.tx,a=this.b*e+this.d*r+this.ty;return i?(i.setTo(n,a),i):new t.Point(n,a)},o.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},o.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},o.prototype.prepend=function(t,e,r,i,n,a){var o=this.tx;if(1!=t||0!=e||0!=r||1!=i){var s=this.a,h=this.c;this.a=s*t+this.b*r,this.b=s*e+this.b*i,this.c=h*t+this.d*r,this.d=h*e+this.d*i}return this.tx=o*t+this.ty*r+n,this.ty=o*e+this.ty*i+a,this},o.prototype.append=function(t,e,r,i,n,a){var o=this.a,s=this.b,h=this.c,l=this.d;return(1!=t||0!=e||0!=r||1!=i)&&(this.a=t*o+e*h,this.b=t*s+e*l,this.c=r*o+i*h,this.d=r*s+i*l),this.tx=n*o+a*h+this.tx,this.ty=n*s+a*l+this.ty,this},o.prototype.deltaTransformPoint=function(e){var r=this,i=r.a*e.x+r.c*e.y,n=r.b*e.x+r.d*e.y;return new t.Point(i,n)},o.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},o.prototype.createBox=function(e,r,n,a,o){void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=0);var s=this;if(0!==n){n/=i;var h=t.NumberUtils.cos(n),l=t.NumberUtils.sin(n);s.a=h*e,s.b=l*r,s.c=-l*e,s.d=h*r}else s.a=e,s.b=0,s.c=0,s.d=r;s.tx=a,s.ty=o},o.prototype.createGradientBox=function(t,e,r,i,n){void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),this.createBox(t/1638.4,e/1638.4,r,i+t/2,n+e/2)},o.prototype.$transformBounds=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,a=this.tx,o=this.ty,s=t.x,h=t.y,l=s+t.width,c=h+t.height,u=e*s+i*h+a,d=r*s+n*h+o,p=e*l+i*h+a,f=r*l+n*h+o,g=e*l+i*c+a,v=r*l+n*c+o,y=e*s+i*c+a,$=r*s+n*c+o,b=0;u>p&&(b=u,u=p,p=b),g>y&&(b=g,g=y,y=b),t.x=Math.floor(g>u?u:g),t.width=Math.ceil((p>y?p:y)-t.x),d>f&&(b=d,d=f,f=b),v>$&&(b=v,v=$,$=b),t.y=Math.floor(v>d?d:v),t.height=Math.ceil((f>$?f:$)-t.y)},o.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},o.prototype.$getScaleX=function(){var t=this;if(1==t.a&&0==t.b)return 1;var e=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-e:e},o.prototype.$getScaleY=function(){var t=this;if(0==t.c&&1==t.d)return 1;var e=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-e:e},o.prototype.$getSkewX=function(){return Math.atan2(this.d,this.c)-e/2},o.prototype.$getSkewY=function(){return Math.atan2(this.b,this.a)},o.prototype.$updateScaleAndRotation=function(e,n,a,o){if(!(0!=a&&a!=r||0!=o&&o!=r))return this.a=e,this.b=this.c=0,void(this.d=n);a/=i,o/=i;var s=t.NumberUtils.cos(a),h=t.NumberUtils.sin(a);a==o?(this.a=s*e,this.b=h*e):(this.a=t.NumberUtils.cos(o)*e,this.b=t.NumberUtils.sin(o)*e),this.c=-h*n,this.d=s*n},o.prototype.$preMultiplyInto=function(t,e){var r=t.a*this.a,i=0,n=0,a=t.d*this.d,o=t.tx*this.a+this.tx,s=t.ty*this.d+this.ty;(0!==t.b||0!==t.c||0!==this.b||0!==this.c)&&(r+=t.b*this.c,a+=t.c*this.b,i+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,o+=t.ty*this.c,s+=t.tx*this.b),e.a=r,e.b=i,e.c=n,e.d=a,e.tx=o,e.ty=s},o}(t.HashObject);t.Matrix=a,__reflect(a.prototype,"egret.Matrix"),t.$TempMatrix=new a}(egret||(egret={}));var egret;!function(t){var e=[],r=function(r){function i(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var a=r.call(this)||this;return a.x=t,a.y=e,a.width=i,a.height=n,a}return __extends(i,r),i.release=function(t){t&&e.push(t)},i.create=function(){var t=e.pop();return t||(t=new i),t},Object.defineProperty(i.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),i.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},i.prototype.setTo=function(t,e,r,i){return this.x=t,this.y=e,this.width=r,this.height=i,this},i.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},i.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},i.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},i.prototype.$intersectInPlace=function(t){var e=this.x,r=this.y,i=t.x,n=t.y,a=Math.max(e,i),o=Math.min(e+this.width,i+t.width);if(o>=a){var s=Math.max(r,n),h=Math.min(r+this.height,n+t.height);if(h>=s)return this.setTo(a,s,o-a,h-s),this}return this.setEmpty(),this},i.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},i.prototype.isEmpty=function(){return this.width<=0||this.height<=0},i.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>t.x&&this.y<=t.y&&this.y+this.height>t.y?!0:!1},i.prototype.containsRect=function(t){var e=t.x+t.width,r=t.y+t.height,i=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<i&&t.y>=this.y&&t.y<n&&e>this.x&&i>=e&&r>this.y&&n>=r},i.prototype.equals=function(t){return this===t?!0:this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},i.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},i.prototype.offset=function(t,e){this.x+=t,this.y+=e},i.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},i.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},i.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var r=Math.min(e.x,t.x),i=Math.min(e.y,t.y);return e.setTo(r,i,Math.max(e.right,t.right)-r,Math.max(e.bottom,t.bottom)-i),e},i.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t));return e*this.width+r*this.height},i.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t));return r*this.width+e*this.height},i}(t.HashObject);t.Rectangle=r,__reflect(r.prototype,"egret.Rectangle"),t.$TempRectangle=new r}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[1001]="Could not find Egret entry class: {0}。",e[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",e[1003]="Parameter {0} must be non-null.",e[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",e[1005]="An object cannot be added as a child of itself.",e[1006]="The supplied DisplayObject must be a child of the caller.",e[1007]="An index specified for a parameter was out of range.",e[1008]="Instantiate singleton error，singleton class {0} can not create multiple instances.",e[1009]='the Class {0} cannot use the property "{1}"',e[1010]='the property "{1}" of the Class "{0}" is readonly',e[1011]="Stream Error. URL: {0}",e[1012]="The type of parameter {0} must be Class.",e[1013]="Variable assignment is NaN, please see the code!",e[1014]='the constant "{1}" of the Class "{0}" is read-only',e[1015]="xml not found!",e[1016]="{0}has been obsoleted",e[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",e[1018]="the scale9Grid is not correct",e[1019]="Network ab:{0}",e[1020]="Cannot initialize Shader",e[1021]="Current browser does not support webgl",e[1022]="{0} ArgumentError",e[1023]="This method is not available in the ScrollView!",e[1025]="end of the file",e[1026]="! EncodingError The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="Photos can not be used across domains toDataURL to convert base64",e[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',e[1035]="Native does not support this feature!",e[1036]="Sound has stopped, please recall Sound.play () to play the sound!",e[1037]="Non-load the correct blob!",e[1038]="XML format error!",e[1039]="Cross domains pictures can not get pixel information!",e[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",e[1041]="{0} is deprecated, please use {1} replace",e[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",e[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[1044]="The current version of the Runtime does not support video playback, please use the latest version",e[1045]="The resource url is not found",e[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",e[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",e[1048]="Video loading failed",e[1049]="In the absence of sound is not allowed to play after loading",e[1050]="ExternalInterface calls the method without js registration: {0}",e[3e3]="Theme configuration file failed to load: {0}",e[3001]="Cannot find the skin name which is configured in Theme: {0}",e[3002]='Index:"{0}" is out of the collection element index range',e[3003]="Cannot be available in this component. If this component is container, please continue to use",e[3004]="addChild(){0}addElement() replace",e[3005]="addChildAt(){0}addElementAt() replace",e[3006]="removeChild(){0}removeElement() replace",e[3007]="removeChildAt(){0}removeElementAt() replace",e[3008]="setChildIndex(){0}setElementIndex() replace",e[3009]="swapChildren(){0}swapElements() replace",e[3010]="swapChildrenAt(){0}swapElementsAt() replace",e[3011]='Index:"{0}" is out of the visual element index range',e[3012]="This method is not available in Scroller component!",e[3013]="UIStage is GUI root container, and only one such instant is in the display list！",e[3014]="set fullscreen error",e[3100]="Current browser does not support WebSocket",e[3101]="Please connect Socket firstly",e[3102]="Please set the type of binary type",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;r.$renderBuffer=new t.sys.RenderBuffer;var i=new t.BitmapData(r.$renderBuffer.surface);return i.$deleteSource=!1,r._setBitmapData(i),r}return __extends(r,e),r.prototype.drawToTexture=function(e,r,i){if(void 0===i&&(i=1),r&&(0==r.width||0==r.height))return!1;var n=r||e.$getOriginalBounds();if(0==n.width||0==n.height)return!1;i/=t.$TextureScaleFactor;var a=(n.x+n.width)*i,o=(n.y+n.height)*i;r&&(a=n.width*i,o=n.height*i);var s=this.$renderBuffer;if(!s)return!1;if(s.resize(a,o),this.$bitmapData.width=a,this.$bitmapData.height=o,__global.nativeRender){var h=t.NativeDelegate.getCurrentBuffer();t.NativeDelegate.activateBuffer(this.$renderBuffer);var l=!1,c=0,u=0,d=0,p=0;r&&(l=!0,c=r.x,u=r.y,d=r.width,p=r.height),t.NativeDelegate.update(),t.NativeDelegate.renderDisplayObject(e.$nativeNode.id,i,l,c,u,d,p),t.NativeDelegate.activateBuffer(h)}else{var f=t.Matrix.create();f.identity(),r&&f.translate(-r.x,-r.y),f.scale(i,i),t.sys.systemRenderer.render(e,s,f,!0),t.Matrix.release(f)}return this.$initData(0,0,a,o,0,0,a,o,a,o),!0},r.prototype.getPixel32=function(e,r){var i;if(this.$renderBuffer){var n=t.$TextureScaleFactor;e=Math.round(e/n),r=Math.round(r/n),i=this.$renderBuffer.getPixels(e,r,1,1)}return i},r.prototype.dispose=function(){e.prototype.dispose.call(this),this.$renderBuffer=null},r}(t.Texture);t.RenderTexture=e,__reflect(e.prototype,"egret.RenderTexture")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};var e=t.$locale_strings.zh_CN;e[1001]="找不到Egret入口类: {0}。",e[1002]="Egret入口类 {0} 必须继承自egret.DisplayObject。",e[1003]="参数 {0} 不能为 null。",e[1004]="无法将对象添加为它的一个子对象（或子对象的子对象等）的子对象。",e[1005]="不能将对象添加为其自身的子对象。",e[1006]="提供的 DisplayObject 必须是调用者的子级。",e[1007]="为参数指定的索引不在范围内。",e[1008]="实例化单例出错，不允许实例化多个 {0} 对象。",e[1009]="类 {0} 不可以使用属性 {1}",e[1010]="类 {0} 属性 {1} 是只读的",e[1011]="流错误。URL: {0}",e[1012]="参数 {0} 的类型必须为 Class。",e[1013]="变量赋值为NaN，请查看代码！",e[1014]="类 {0} 常量 {1} 是只读的",e[1015]="xml not found!",e[1016]="{0}已经废弃",e[1017]="JSON文件格式不正确: {0}\ndata: {1}",e[1018]="9宫格设置错误",e[1019]="网络异常:{0}",e[1020]="无法初始化着色器",e[1021]="当前浏览器不支持webgl",e[1022]="{0} ArgumentError",e[1023]="此方法在ScrollView内不可用!",e[1025]="遇到文件尾",e[1026]="EncodingError! The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]="调用了未配置的注入规则:{0}。 请先在项目初始化里配置指定的注入规则，再调用对应单例。",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="跨域图片不可以使用toDataURL来转换成base64",e[1034]='音乐文件解码失败："{0}"，请使用标准的转换工具重新转换下mp3。',e[1035]="Native 下暂未实现此功能！",e[1036]="声音已停止，请重新调用 Sound.play() 来播放声音！",e[1037]="非正确的blob加载！",e[1038]="XML 格式错误!",e[1039]="跨域图片不能获取像素信息!",e[1040]="hitTestPoint 不能对跨域图片进行检测! 请检查该显示对象内是否含有跨域元素",e[1041]="{0} 已废弃,请使用 {1} 代替",e[1042]="drawToTexture方法传入的区域各个参数需要为整数,否则某些浏览器绘制会出现异常",e[1043]="{0} 中存在编译错误，属性名 : {1}，属性值 : {2}",e[1044]="当前的 runtime 版本不支持视频播放,请使用最新的版本",e[1045]="没有设置要加载的资源地址",e[1046]="BitmapText 找不到对应字符:{0}，请检查配置文件",e[1047]="egret.localStorage.setItem保存失败,key={0}&value={1}",e[1048]="视频加载失败",e[1049]="声音在没有加载完之前不允许播放",e[1050]="ExternalInterface调用了js没有注册的方法: {0}",e[3e3]="主题配置文件加载失败: {0}",e[3001]="找不到主题中所配置的皮肤类名: {0}",e[3002]='索引:"{0}"超出集合元素索引范围',e[3003]="在此组件中不可用，若此组件为容器类，请使用",e[3004]="addChild(){0}addElement()代替",e[3005]="addChildAt(){0}addElementAt()代替",e[3006]="removeChild(){0}removeElement()代替",e[3007]="removeChildAt(){0}removeElementAt()代替",e[3008]="setChildIndex(){0}setElementIndex()代替",e[3009]="swapChildren(){0}swapElements()代替",e[3010]="swapChildrenAt(){0}swapElementsAt()代替",e[3011]='索引:"{0}"超出可视元素索引范围',e[3012]="此方法在Scroller组件内不可用!",e[3013]="UIStage是GUI根容器，只能有一个此实例在显示列表中！",e[3014]="设置全屏模式失败",e[3100]="当前浏览器不支持WebSocket",e[3101]="请先连接WebSocket",e[3102]="请先设置type为二进制类型",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$graphics=new t.Graphics,r.$graphics.$setTarget(r),r}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(8)},Object.defineProperty(r.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),r.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},r.prototype.$hitTest=function(t,r){var i=e.prototype.$hitTest.call(this,t,r);return i==this&&(i=this.$graphics.$hitTest(t,r)),i},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},r}(t.DisplayObject);t.Shape=e,__reflect(e.prototype,"egret.Shape")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r;!function(r){function i(t){return window.localStorage.getItem(t)}function n(e,r){try{return window.localStorage.setItem(e,r),!0}catch(i){return t.$warn(1047,e,r),!1}}function a(t){window.localStorage.removeItem(t)}function o(){window.localStorage.clear()}e.getItem=i,e.setItem=n,e.removeItem=a,e.clear=o}(r=e.web||(e.web={}))}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t){i.indexOf(t)<0&&i.push(t)}function r(t){var e=i.indexOf(t);return e>=0?(i.splice(e,1),!0):!1}var i=[];t.$pushSoundChannel=e,t.$popSoundChannel=r}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){}(egret||(egret={}));var egret;!function(t){t.BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"}}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t.loaded=!1,t}return __extends(i,r),Object.defineProperty(i.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),i.prototype.load=function(e){function r(){a(),h.indexOf("firefox")>=0&&(s.pause(),s.muted=!1),o.loaded=!0,o.dispatchEventWith(t.Event.COMPLETE)}function n(){a(),o.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}function a(){s.removeEventListener("canplaythrough",r),s.removeEventListener("error",n)}var o=this;this.url=e;var s=new Audio(e);s.addEventListener("canplaythrough",r),s.addEventListener("error",n);var h=navigator.userAgent.toLowerCase();h.indexOf("firefox")>=0&&(s.autoplay=!0,s.muted=!0),s.load(),this.originAudio=s,i.clearAudios[this.url]&&delete i.clearAudios[this.url],i.$recycle(this.url,s)},i.prototype.play=function(r,n){r=+r||0,n=+n||0;var a=i.$pop(this.url);null==a&&(a=this.originAudio.cloneNode()),a.autoplay=!0;var o=new e.HtmlSoundChannel(a);return o.$url=this.url,o.$loops=n,o.$startTime=r,o.$play(),t.sys.$pushSoundChannel(o),o},i.prototype.close=function(){0==this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),i.$clear(this.url)},i.$clear=function(t){i.clearAudios[t]=!0;var e=i.audios[t];e&&(e.length=0)},i.$pop=function(t){var e=i.audios[t];return e&&e.length>0?e.pop():null},i.$recycle=function(t,e){if(!i.clearAudios[t]){var r=i.audios[t];null==i.audios[t]&&(r=i.audios[t]=[]),r.push(e)}},i.MUSIC="music",i.EFFECT="effect",i.audios={},i.clearAudios={},i}(t.EventDispatcher);e.HtmlSound=r,__reflect(r.prototype,"egret.web.HtmlSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(e){var i=r.call(this)||this;return i.$startTime=0,i.audio=null,i.isStopped=!1,i.canPlay=function(){i.audio.removeEventListener("canplay",i.canPlay);try{i.audio.currentTime=i.$startTime}catch(t){}finally{i.audio.play()}},i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(t.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._volume=1,e.addEventListener("ended",i.onPlayEnd),i.audio=e,i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(e){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()},i.prototype.stop=function(){if(this.audio){this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0;var r=this.audio;r.removeEventListener("ended",this.onPlayEnd),r.volume=0,this._volume=0,this.audio=null;var i=this.$url;window.setTimeout(function(){r.pause(),e.HtmlSound.$recycle(i,r)},200)}},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.audio&&(this.audio.volume=e)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.HtmlSoundChannel=r,__reflect(r.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function t(){}return t.decodeAudios=function(){if(!(t.decodeArr.length<=0||t.isDecoding)){t.isDecoding=!0;var e=t.decodeArr.shift();t.ctx.decodeAudioData(e.buffer,function(r){e.self.audioBuffer=r,e.success&&e.success(),t.isDecoding=!1,t.decodeAudios()},function(){alert("sound decode error: "+e.url+"！\nsee http://edn.egret.com/cn/docs/page/156"),e.fail&&e.fail(),t.isDecoding=!1,t.decodeAudios()})}},t.decodeArr=[],t.isDecoding=!1,t}();e.WebAudioDecode=r,__reflect(r.prototype,"egret.web.WebAudioDecode");var i=function(i){function n(){var t=i.call(this)||this;return t.loaded=!1,t}return __extends(n,i),Object.defineProperty(n.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(e){function i(){a.loaded=!0,a.dispatchEventWith(t.Event.COMPLETE)}function n(){a.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}var a=this;this.url=e;var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.onreadystatechange=function(){if(4==o.readyState){var e=o.status>=400||0==o.status;e?a.dispatchEventWith(t.IOErrorEvent.IO_ERROR):(r.decodeArr.push({buffer:o.response,success:i,fail:n,self:a,url:a.url}),r.decodeAudios())}},o.send()},n.prototype.play=function(r,i){r=+r||0,i=+i||0;var n=new e.WebAudioSoundChannel;return n.$url=this.url,n.$loops=i,n.$audioBuffer=this.audioBuffer,n.$startTime=r,n.$play(),t.sys.$pushSoundChannel(n),n},n.prototype.close=function(){},n.MUSIC="music",n.EFFECT="effect",n}(t.EventDispatcher);e.WebAudioSound=i,__reflect(i.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var i=r.call(this)||this;return i.$startTime=0,i.bufferSource=null,i.context=e.WebAudioDecode.ctx,i.isStopped=!1,i._currentTime=0,i._volume=1,i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(t.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._startTime=0,i.context.createGain?i.gain=i.context.createGain():i.gain=i.context.createGainNode(),i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var e=this.context,r=this.gain,i=e.createBufferSource();this.bufferSource=i,i.buffer=this.$audioBuffer,i.connect(r),r.connect(e.destination),i.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,i.start(0,this.$startTime),this._currentTime=0},i.prototype.stop=function(){if(this.bufferSource){var e=this.bufferSource;e.stop?e.stop(0):e.noteOff(0),e.onended=null,e.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.gain.gain.value=e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.WebAudioSoundChannel=r,__reflect(r.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i){void 0===i&&(i=!0);var n=e.call(this)||this;return n.loaded=!1,n.closed=!1,n.heightSet=0/0,n.widthSet=0/0,n.waiting=!1,n.userPause=!1,n.userPlay=!1,n.isPlayed=!1,n.screenChanged=function(e){var r=document.fullscreenEnabled||document.webkitIsFullScreen;r||(n.checkFullScreen(!1),t.Capabilities.isMobile||(n._fullscreen=r))},n._fullscreen=!0,n.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var e=n.video;n.loaded=!0,n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),e.width=e.videoWidth,e.height=e.videoHeight,window.setTimeout(function(){n.dispatchEventWith(t.Event.COMPLETE)},200)},n.$renderNode=new t.sys.BitmapNode,n.src=r,n.once(t.Event.ADDED_TO_STAGE,n.loadPoster,n),r&&n.load(),n}return __extends(r,e),r.prototype.load=function(e,r){var i=this;if(void 0===r&&(r=!0),e=e||this.src,this.src=e,!this.video||this.video.src!=e){var n;!this.video||t.Capabilities.isMobile?(n=document.createElement("video"),this.video=n,n.controls=null):n=this.video,n.src=e,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.addEventListener("canplay",this.onVideoLoaded),n.addEventListener("error",function(){return i.onVideoError()}),n.addEventListener("ended",function(){return i.onVideoEnded()});var a=!1;n.addEventListener("canplay",function(){i.waiting=!1,a?i.userPause?i.pause():i.userPlay&&i.play():(a=!0,n.pause())}),n.addEventListener("waiting",function(){i.waiting=!0}),n.load(),this.videoPlay(),n.style.position="absolute",n.style.top="0px",n.style.zIndex="-88888",n.style.left="0px",n.height=1,n.width=1}},r.prototype.play=function(e,r){var i=this;if(void 0===r&&(r=!1),0==this.loaded)return this.load(this.src),void this.once(t.Event.COMPLETE,function(t){return i.play(e,r)},this);this.isPlayed=!0;var n=this.video;void 0!=e&&(n.currentTime=+e||0),n.loop=!!r,t.Capabilities.isMobile?n.style.zIndex="-88888":n.style.zIndex="9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=t.Capabilities.os&&"Mac OS"!=t.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.checkFullScreen(this._fullscreen)},r.prototype.videoPlay=function(){return this.userPause=!1,this.waiting?void(this.userPlay=!0):(this.userPlay=!1,void this.video.play())},r.prototype.checkFullScreen=function(e){var r=this.video;if(e)null==r.parentElement&&(r.removeAttribute("webkit-playsinline"),document.body.appendChild(r)),t.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=r.parentElement&&r.parentElement.removeChild(r),r.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),t.startTick(this.markDirty,this),t.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();this.videoPlay()},r.prototype.goFullscreen=function(){var e,r=this.video;return e=t.web.getPrefixStyleName("requestFullscreen",r),r[e]||(e=t.web.getPrefixStyleName("requestFullScreen",r),r[e])?(r.removeAttribute("webkit-playsinline"),r[e](),this.setFullScreenMonitor(!0),!0):!0},r.prototype.setFullScreenMonitor=function(t){var e=this.video;t?(e.addEventListener("mozfullscreenchange",this.screenChanged),e.addEventListener("webkitfullscreenchange",this.screenChanged),e.addEventListener("mozfullscreenerror",this.screenError),e.addEventListener("webkitfullscreenerror",this.screenError)):(e.removeEventListener("mozfullscreenchange",this.screenChanged),e.removeEventListener("webkitfullscreenchange",this.screenChanged),e.removeEventListener("mozfullscreenerror",this.screenError),e.removeEventListener("webkitfullscreenerror",this.screenError))},r.prototype.screenError=function(){t.$error(3014)},r.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},r.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.dispatchEventWith(t.Event.ENDED)},r.prototype.onVideoError=function(){this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},r.prototype.close=function(){var t=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return t.onVideoError()}),this.video.removeEventListener("ended",function(){return t.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},r.prototype.pause=function(){return this.userPlay=!1,this.waiting?void(this.userPause=!0):(this.userPause=!1,void t.stopTick(this.markDirty,this))},Object.defineProperty(r.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video&&(this.video.currentTime=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(e){t.Capabilities.isMobile||(this._fullscreen=!!e,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new t.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),r.prototype.loadPoster=function(){var e=this,r=this.poster;if(r){var i=new t.ImageLoader;i.once(t.Event.COMPLETE,function(t){i.data;e.posterData=i.data,e.$renderDirty=!0,e.posterData.width=e.getPlayWidth(),e.posterData.height=e.getPlayHeight()},this),i.load(r)}},r.prototype.$measureContentBounds=function(t){var e=this.bitmapData,r=this.posterData;
e?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):r?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},r.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},r.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},r.prototype.$updateRenderNode=function(){var e=this.$renderNode,r=this.bitmapData,i=this.posterData,n=this.getPlayWidth(),a=this.getPlayHeight();this.isPlayed&&!t.Capabilities.isMobile||!i?this.isPlayed&&r&&(e.image=r,e.imageWidth=r.width,e.imageHeight=r.height,t.WebGLUtils.deleteWebGLTexture(r.webGLTexture),r.webGLTexture=null,e.drawImage(0,0,r.width,r.height,0,0,n,a)):(e.image=i,e.imageWidth=n,e.imageHeight=a,e.drawImage(0,0,i.width,i.height,0,0,n,a))},r.prototype.markDirty=function(){return this.$renderDirty=!0,!0},r.prototype.$setHeight=function(t){this.heightSet=t,e.prototype.$setHeight.call(this,t)},r.prototype.$setWidth=function(t){this.widthSet=t,e.prototype.$setWidth.call(this,t)},Object.defineProperty(r.prototype,"paused",{get:function(){return this.video?this.video.paused:!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),r}(t.DisplayObject);e.WebVideo=r,__reflect(r.prototype,"egret.web.WebVideo",["egret.Video","egret.DisplayObject"]),t.Video=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.GET="GET",t.POST="POST",t}();t.HttpMethod=e,__reflect(e.prototype,"egret.HttpMethod")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.ARRAY_BUFFER="arraybuffer",t}();t.HttpResponseType=e,__reflect(e.prototype,"egret.HttpResponseType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NORMAL="normal",t.ADD="add",t.ERASE="erase",t}();t.BlendMode=e,__reflect(e.prototype,"egret.BlendMode")}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=n[t];return void 0===e?0:e}function r(t){var e=i[t];return void 0===e?"normal":e}for(var i=["normal","add","erase"],n={},a=i.length,o=0;a>o;o++){var s=i[o];n[s]=o}t.blendModeToNumber=e,t.numberToBlendMode=r}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t._url="",t._method="",t}return __extends(r,e),Object.defineProperty(r.prototype,"response",{get:function(){if(!this._xhr)return null;if(void 0!=this._xhr.response)return this._xhr.response;if("text"==this._responseType)return this._xhr.responseText;if("arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)){var t=window;return t.convertResponseBodyToText(this._xhr.responseBody)}return"document"==this._responseType?this._xhr.responseXML:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),r.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},r.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e,this._xhr&&(this._xhr.abort(),this._xhr=null),this._xhr=this.getXHR(),this._xhr.onreadystatechange=this.onReadyStateChange.bind(this),this._xhr.onprogress=this.updateProgress.bind(this),this._xhr.open(this._method,this._url,!0)},r.prototype.send=function(t){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var e in this.headerObj)this._xhr.setRequestHeader(e,this.headerObj[e]);this._xhr.send(t)},r.prototype.abort=function(){this._xhr&&this._xhr.abort()},r.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var t=this._xhr.getAllResponseHeaders();return t?t:""},r.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},r.prototype.getResponseHeader=function(t){if(!this._xhr)return null;var e=this._xhr.getResponseHeader(t);return e?e:""},r.prototype.onReadyStateChange=function(){var e=this._xhr;if(4==e.readyState){var r=e.status>=400||0==e.status,i=(this._url,this);window.setTimeout(function(){r?i.dispatchEventWith(t.IOErrorEvent.IO_ERROR):i.dispatchEventWith(t.Event.COMPLETE)},0)}},r.prototype.updateProgress=function(e){e.lengthComputable&&t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.PROGRESS,e.loaded,e.total)},r}(t.EventDispatcher);e.WebHttpRequest=r,__reflect(r.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),t.HttpRequest=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=window.URL||window.webkitURL,i=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t._hasCrossOriginSet=!1,t.currentImage=null,t.request=null,t}return __extends(n,i),Object.defineProperty(n.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._hasCrossOriginSet=!0,this._crossOrigin=t},enumerable:!0,configurable:!0}),n.prototype.load=function(r){if(e.Html5Capatibility._canUseBlob&&0!=r.indexOf("wxLocalResource:")&&0!=r.indexOf("data:")&&0!=r.indexOf("http:")&&0!=r.indexOf("https:")){var i=this.request;i||(i=this.request=new t.web.WebHttpRequest,i.addEventListener(t.Event.COMPLETE,this.onBlobLoaded,this),i.addEventListener(t.IOErrorEvent.IO_ERROR,this.onBlobError,this),i.responseType="blob"),i.open(r),i.send()}else this.loadImage(r)},n.prototype.onBlobLoaded=function(t){var e=this.request.response;this.request=void 0,this.loadImage(r.createObjectURL(e))},n.prototype.onBlobError=function(t){this.dispatchIOError(this.currentURL),this.request=void 0},n.prototype.loadImage=function(t){var e=new Image;this.data=null,this.currentImage=e,this._hasCrossOriginSet?this._crossOrigin&&(e.crossOrigin=this._crossOrigin):n.crossOrigin&&(e.crossOrigin=n.crossOrigin),e.onload=this.onImageComplete.bind(this),e.onerror=this.onLoadError.bind(this),e.src=t},n.prototype.onImageComplete=function(e){var r=this.getImage(e);if(r){this.data=new t.BitmapData(r);var i=this;window.setTimeout(function(){i.dispatchEventWith(t.Event.COMPLETE)},0)}},n.prototype.onLoadError=function(t){var e=this.getImage(t);e&&this.dispatchIOError(e.src)},n.prototype.dispatchIOError=function(e){var r=this;window.setTimeout(function(){r.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},0)},n.prototype.getImage=function(e){var i=e.target,n=i.src;if(0==n.indexOf("blob:"))try{r.revokeObjectURL(i.src)}catch(a){t.$warn(1037)}return i.onerror=null,i.onload=null,this.currentImage!==i?null:(this.currentImage=null,i)},n.crossOrigin=null,n}(t.EventDispatcher);e.WebImageLoader=i,__reflect(i.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),t.ImageLoader=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(i){var n=r.call(this)||this;return n.isStage=!1,n.$renderNode=new e.BitmapNode,n.renderBuffer=null,n.offsetX=0,n.offsetY=0,n.offsetMatrix=new t.Matrix,n.needUpdateRegions=!1,n.$canvasScaleX=1,n.$canvasScaleY=1,n.root=i,n.isStage=i instanceof t.Stage,n}return __extends(i,r),i.create=function(r){var i=new t.sys.DisplayList(r);try{var n=new e.RenderBuffer;i.renderBuffer=n}catch(a){return null}return i.root=r,i},i.prototype.$getRenderNode=function(){return this.$renderNode},i.prototype.setClipRect=function(t,e){t*=i.$canvasScaleX,e*=i.$canvasScaleY,this.renderBuffer.resize(t,e)},i.prototype.drawToSurface=function(){var r=0;this.$canvasScaleX=this.offsetMatrix.a=i.$canvasScaleX,this.$canvasScaleY=this.offsetMatrix.d=i.$canvasScaleY,this.isStage||this.changeSurfaceSize();var n=this.renderBuffer;if(n.clear(),r=e.systemRenderer.render(this.root,n,this.offsetMatrix),!this.isStage){var a=n.surface,o=this.$renderNode;o.drawData.length=0;var s=a.width,h=a.height;this.bitmapData?(this.bitmapData.source=a,this.bitmapData.width=s,this.bitmapData.height=h):this.bitmapData=new t.BitmapData(a),o.image=this.bitmapData,o.imageWidth=s,o.imageHeight=h,o.drawImage(0,0,s,h,-this.offsetX,-this.offsetY,s/this.$canvasScaleX,h/this.$canvasScaleY)}return r},i.prototype.changeSurfaceSize=function(){var t=(this.root,this.offsetX),e=this.offsetY,r=this.root.$getOriginalBounds(),i=this.$canvasScaleX,n=this.$canvasScaleY;this.offsetX=-r.x,this.offsetY=-r.y,this.offsetMatrix.setTo(this.offsetMatrix.a,0,0,this.offsetMatrix.d,this.offsetX,this.offsetY);var a=this.renderBuffer,o=Math.max(257,r.width*i),s=Math.max(257,r.height*n);(this.offsetX!=t||this.offsetY!=e||a.surface.width!=o||a.surface.height!=s)&&a.resize(o,s)},i.$setCanvasScale=function(e,r){i.$canvasScaleX=e,i.$canvasScaleY=r,__global.nativeRender&&t.NativeDelegate.setCanvasScaleFactor(i.$canvasScaleFactor,e,r)},i.$canvasScaleFactor=1,i.$canvasScaleX=1,i.$canvasScaleY=1,i}(t.HashObject);e.DisplayList=r,__reflect(r.prototype,"egret.sys.DisplayList")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$stageWidth=0,r.$stageHeight=0,r.$scaleMode=t.StageScaleMode.SHOW_ALL,r.$orientation=t.OrientationMode.AUTO,r.$maxTouches=99,r.$stage=r,r.$nestLevel=1,r}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(13)},Object.defineProperty(r.prototype,"frameRate",{get:function(){return t.ticker.$frameRate},set:function(e){t.ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),r.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},r.prototype.registerImplementation=function(e,r){t.registerImplementation(e,r)},r.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(r.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dirtyRegionPolicy",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),r.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},r}(t.DisplayObjectContainer);t.Stage=e,__reflect(e.prototype,"egret.Stage")}(egret||(egret={}));var egret;!function(t){t.CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"}}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(r,n,h,l){if(n&&(t.log=function(){for(var t=arguments.length,r="",n=0;t>n;n++)r+=arguments[n]+" ";e.$logToFPS(r),console.log.apply(console,i(arguments))}),o=l?{}:l,n=!!n,this.showFPS=!!r,this.showLog=n,!this.fps){var c=void 0===l.x?0:l.x,u=void 0===l.y?0:l.y;a=this.fps=new FPS(this.stage,r,n,h,l),a.x=c,a.y=u;for(var d=s.length,p=0;d>p;p++)a.updateInfo(s[p]);s=null}}function i(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}var n=function(i){function n(e,n,a){var o=i.call(this)||this;return o.isPlaying=!1,o.entryClassName=a,o.stage=n,o.screenDisplayList=o.createDisplayList(n,e),o.showFPS=!1,o.showLog=!1,o.stageDisplayList=null,o.displayFPS=r,__global.nativeRender&&t.NativeDelegate.setRootBuffer(e),o}return __extends(n,i),n.prototype.createDisplayList=function(t,r){var i=new e.DisplayList(t);return i.renderBuffer=r,t.$displayList=i,i},n.prototype.start=function(){!this.isPlaying&&this.stage&&(e.$TempStage=e.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),t.ticker.$addPlayer(this))},n.prototype.initialize=function(){var e;if(this.entryClassName&&(e=t.getDefinitionByName(this.entryClassName)),e){var r=new e;this.root=r,r instanceof t.DisplayObject&&this.stage.addChild(r)}},n.prototype.stop=function(){this.pause(),this.stage=null},n.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,t.ticker.$removePlayer(this))},n.prototype.$render=function(e,r){if(__global.nativeRender)return t.NativeDelegate.update(),void t.NativeDelegate.render();(this.showFPS||this.showLog)&&this.stage.addChild(this.fps);var i=this.stage,n=t.getTimer(),a=i.$displayList.drawToSurface(),o=t.getTimer();e&&this.showFPS&&this.fps.update(a,o-n,r)},n.prototype.updateStageSize=function(e,r){var i=this.stage;i.$stageWidth=e,i.$stageHeight=r,__global.nativeRender?t.NativeDelegate.resize(e,r):(this.screenDisplayList.setClipRect(e,r),this.stageDisplayList&&this.stageDisplayList.setClipRect(e,r)),i.dispatchEventWith(t.Event.RESIZE)},n}(t.HashObject);e.Player=n,__reflect(n.prototype,"egret.sys.Player");var a,o,s=[];e.$logToFPS=function(t){return a?void a.updateInfo(t):void s.push(t)};var h=function(e){function r(r,i,n,a,o){var s=e.call(this)||this;s.showFPS=i,s.showLog=n,s.logFilter=a,s.styles=o,s.infoLines=[],s.totalTime=0,s.totalTick=0,s.lastTime=0,s.drawCalls=0,s.costRender=0,s.costTicker=0,s.isFPS=!0,s.infoLines=[],s.totalTime=0,s.totalTick=0,s.lastTime=0,s.drawCalls=0,s.costRender=0,s.costTicker=0,s._stage=r,s.showFPS=i,s.showLog=n,s.logFilter=a,s.touchChildren=!1,s.touchEnabled=!1,s.styles=o,s.fpsDisplay=new t.FPSDisplay(r,i,n,a,o),s.addChild(s.fpsDisplay);var h;try{h=a?new RegExp(a):null}catch(l){t.log(l)}return s.filter=function(t){return h?h.test(t):!a||0==t.indexOf(a)},s}return __extends(r,e),r.prototype.update=function(e,r,i){var n=t.getTimer();if(this.totalTime+=n-this.lastTime,this.lastTime=n,this.totalTick++,this.drawCalls+=e,this.costRender+=r,this.costTicker+=i,this.totalTime>=1e3){var a=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),t.ticker.$frameRate),o=Math.round(this.drawCalls/this.totalTick),s=Math.round(this.costRender/this.totalTick),h=Math.round(this.costTicker/this.totalTick);this.fpsDisplay.update({fps:a,draw:o,costTicker:h,costRender:s}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.costRender=0,this.costTicker=0}},r.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},r}(t.Sprite);__reflect(h.prototype,"FPSImpl"),__global.FPS=h,t.warn=function(){console.warn.apply(console,i(arguments))},t.error=function(){console.error.apply(console,i(arguments))},t.assert=function(){console.assert.apply(console,i(arguments))},t.log=function(){console.log.apply(console,i(arguments))}}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){return e.call(this)||this}return __extends(r,e),r.prototype.calculateStageSize=function(e,r,i,n,a){var o=r,s=i,h=n,l=a,c=r/h||0,u=i/l||0;switch(e){case t.StageScaleMode.EXACT_FIT:break;case t.StageScaleMode.FIXED_HEIGHT:h=Math.round(r/u);break;case t.StageScaleMode.FIXED_WIDTH:l=Math.round(i/c);break;case t.StageScaleMode.NO_BORDER:c>u?s=Math.round(l*c):o=Math.round(h*u);break;case t.StageScaleMode.SHOW_ALL:c>u?o=Math.round(h*u):s=Math.round(l*c);break;case t.StageScaleMode.FIXED_NARROW:c>u?h=Math.round(r/u):l=Math.round(i/c);break;case t.StageScaleMode.FIXED_WIDE:c>u?l=Math.round(i/c):h=Math.round(r/u);break;default:h=r,l=i}return h%2!=0&&(h+=1),l%2!=0&&(l+=1),o%2!=0&&(o+=1),s%2!=0&&(s+=1),{stageWidth:h,stageHeight:l,displayWidth:o,displayHeight:s}},r}(t.HashObject);e.DefaultScreenAdapter=r,__reflect(r.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NO_SCALE="noScale",t.SHOW_ALL="showAll",t.NO_BORDER="noBorder",t.EXACT_FIT="exactFit",t.FIXED_WIDTH="fixedWidth",t.FIXED_HEIGHT="fixedHeight",t.FIXED_NARROW="fixedNarrow",t.FIXED_WIDE="fixedWide",t}();t.StageScaleMode=e,__reflect(e.prototype,"egret.StageScaleMode")}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.$START_TIME=0,e.$invalidateRenderFlag=!1,e.$requestRenderingFlag=!1;var r=function(){function r(){this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,this.isPaused=!1,e.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}return r.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(this.playerList=this.playerList.concat(),this.playerList.push(t))},r.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);if(-1!==e){this.playerList=this.playerList.concat(),this.playerList.splice(e,1)}},r.prototype.$startTick=function(t,e){var r=this.getTickIndex(t,e);-1==r&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},r.prototype.$stopTick=function(t,e){var r=this.getTickIndex(t,e);-1!=r&&(this.concatTick(),this.callBackList.splice(r,1),this.thisObjectList.splice(r,1))},r.prototype.getTickIndex=function(t,e){for(var r=this.callBackList,i=this.thisObjectList,n=r.length-1;n>=0;n--)if(r[n]==t&&i[n]==e)return n;return-1},r.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},r.prototype.$setFrameRate=function(t){return 0>=t?!1:this.$frameRate==t?!1:(this.$frameRate=t,t>60&&(t=60),this.frameDeltaTime=1e3/t,this.lastCount=this.frameInterval=Math.round(6e4/t),!0)},r.prototype.pause=function(){this.isPaused=!0},r.prototype.resume=function(){this.isPaused=!1},r.prototype.update=function(){for(var r=t.getTimer(),i=this.callBackList,n=this.thisObjectList,a=i.length,o=e.$requestRenderingFlag,s=t.getTimer(),h=t.lifecycle.contexts,l=0,c=h;l<c.length;l++){var u=c[l];u.onUpdate&&u.onUpdate()}if(this.isPaused)return void(this.lastTimeStamp=s);this.callLaterAsyncs();for(var d=0;a>d;d++)i[d].call(n[d],s)&&(o=!0);var p=t.getTimer(),f=s-this.lastTimeStamp;if(this.lastTimeStamp=s,f>=this.frameDeltaTime)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return void(o&&this.render(!1,this.costEnterFrame+p-r));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+p-r);var g=t.getTimer();this.broadcastEnterFrame();var v=t.getTimer();this.costEnterFrame=v-g},r.prototype.render=function(t,r){var i=this.playerList,n=i.length;if(0!=n){this.callLaters(),e.$invalidateRenderFlag&&(this.broadcastRender(),e.$invalidateRenderFlag=!1);for(var a=0;n>a;a++)i[a].$render(t,r);e.$requestRenderingFlag=!1}},r.prototype.broadcastEnterFrame=function(){var e=t.DisplayObject.$enterFrameCallBackList,r=e.length;if(0!=r){e=e.concat();for(var i=0;r>i;i++)e[i].dispatchEventWith(t.Event.ENTER_FRAME)}},r.prototype.broadcastRender=function(){var e=t.DisplayObject.$renderCallBackList,r=e.length;if(0!=r){e=e.concat();for(var i=0;r>i;i++)e[i].dispatchEventWith(t.Event.RENDER)}},r.prototype.callLaters=function(){var e,r,i;if(t.$callLaterFunctionList.length>0&&(e=t.$callLaterFunctionList,t.$callLaterFunctionList=[],r=t.$callLaterThisList,t.$callLaterThisList=[],i=t.$callLaterArgsList,t.$callLaterArgsList=[]),e)for(var n=e.length,a=0;n>a;a++){var o=e[a];null!=o&&o.apply(r[a],i[a])}},r.prototype.callLaterAsyncs=function(){if(t.$callAsyncFunctionList.length>0){var e=t.$callAsyncFunctionList,r=t.$callAsyncThisList,i=t.$callAsyncArgsList;t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[];for(var n=0;n<e.length;n++){var a=e[n];null!=a&&a.apply(r[n],i[n])}}},r}();e.SystemTicker=r,__reflect(r.prototype,"egret.sys.SystemTicker")}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){var e;!function(e){function r(t){var r=new n;e.contexts.push(r),t(r)}e.contexts=[];var i=!0,n=function(){function r(){}return r.prototype.pause=function(){i&&(i=!1,e.stage.dispatchEvent(new t.Event(t.Event.DEACTIVATE)),e.onPause&&e.onPause())},r.prototype.resume=function(){i||(i=!0,e.stage.dispatchEvent(new t.Event(t.Event.ACTIVATE)),e.onResume&&e.onResume())},r}();e.LifecycleContext=n,__reflect(n.prototype,"egret.lifecycle.LifecycleContext"),e.addLifecycleListener=r}(e=t.lifecycle||(t.lifecycle={})),t.ticker=new t.sys.SystemTicker}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(t){var r=e.call(this)||this;return r.maxTouches=0,r.useTouchesCount=0,r.touchDownTarget={},r.lastTouchX=-1,r.lastTouchY=-1,r.stage=t,r}return __extends(r,e),r.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},r.prototype.onTouchBegin=function(e,r,i){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=e,this.lastTouchY=r;var n=this.findTarget(e,r);null==this.touchDownTarget[i]&&(this.touchDownTarget[i]=n,this.useTouchesCount++),t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_BEGIN,!0,!0,e,r,i,!0)}},r.prototype.onTouchMove=function(e,r,i){if(null!=this.touchDownTarget[i]&&(this.lastTouchX!=e||this.lastTouchY!=r)){this.lastTouchX=e,this.lastTouchY=r;var n=this.findTarget(e,r);t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_MOVE,!0,!0,e,r,i,!0)}},r.prototype.onTouchEnd=function(e,r,i){if(null!=this.touchDownTarget[i]){var n=this.findTarget(e,r),a=this.touchDownTarget[i];delete this.touchDownTarget[i],this.useTouchesCount--,t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_END,!0,!0,e,r,i,!1),a==n?t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_TAP,!0,!0,e,r,i,!1):t.TouchEvent.dispatchTouchEvent(a,t.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,e,r,i,!1)}},r.prototype.findTarget=function(t,e){var r=this.stage.$hitTest(t,e);return r||(r=this.stage),r},r}(t.HashObject);e.TouchHandler=r,__reflect(r.prototype,"egret.sys.TouchHandler")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=0/0,t.filter=null,t.rotated=!1,t.type=1,t}return __extends(r,e),r.prototype.drawImage=function(t,e,r,i,n,a,o,s){this.drawData.push(t,e,r,i,n,a,o,s),this.renderCount++},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=0/0,this.filter=null},r.$updateTextureData=function(e,i,n,a,o,s,h,l,c,u,d,p,f,g,v,y){if(i){var $=t.$TextureScaleFactor;if(e.smoothing=y,e.image=i,e.imageWidth=f,e.imageHeight=g,v==t.BitmapFillMode.SCALE){var b=d/c*$,m=p/u*$;e.drawImage(n,a,o,s,b*h,m*l,b*o,m*s)}else if(v==t.BitmapFillMode.CLIP){var x=Math.min(c,d),T=Math.min(u,p),_=o*$,w=s*$;r.drawClipImage(e,$,n,a,_,w,h,l,x,T)}else for(var _=o*$,w=s*$,E=0;d>E;E+=c)for(var S=0;p>S;S+=u){var x=Math.min(d-E,c),T=Math.min(p-S,u);r.drawClipImage(e,$,n,a,_,w,h,l,x,T,E,S)}}},r.$updateTextureDataWithScale9Grid=function(e,r,i,n,a,o,s,h,l,c,u,d,p,f,g,v){e.smoothing=v,e.image=r,e.imageWidth=f,e.imageHeight=g;var y=o,$=s;d-=c-o*t.$TextureScaleFactor,p-=u-s*t.$TextureScaleFactor;var b=i.x-h,m=i.y-l,x=b/t.$TextureScaleFactor,T=m/t.$TextureScaleFactor,_=i.width/t.$TextureScaleFactor,w=i.height/t.$TextureScaleFactor;0==w&&(w=1,T>=$&&T--),0==_&&(_=1,x>=y&&x--);var E=n,S=E+x,C=S+_,D=y-x-_,R=a,O=R+T,L=O+w,A=$-T-w,M=D*t.$TextureScaleFactor,B=A*t.$TextureScaleFactor;if((x+D)*t.$TextureScaleFactor>d||(T+A)*t.$TextureScaleFactor>p)return void e.drawImage(n,a,o,s,h,l,d,p);var F=h,P=F+b,N=F+(d-M),I=d-b-M,k=l,H=k+m,W=k+p-B,U=p-m-B;T>0&&(x>0&&e.drawImage(E,R,x,T,F,k,b,m),_>0&&e.drawImage(S,R,_,T,P,k,I,m),D>0&&e.drawImage(C,R,D,T,N,k,M,m)),w>0&&(x>0&&e.drawImage(E,O,x,w,F,H,b,U),_>0&&e.drawImage(S,O,_,w,P,H,I,U),D>0&&e.drawImage(C,O,D,w,N,H,M,U)),A>0&&(x>0&&e.drawImage(E,L,x,A,F,W,b,B),_>0&&e.drawImage(S,L,_,A,P,W,I,B),D>0&&e.drawImage(C,L,D,A,N,W,M,B))},r.drawClipImage=function(t,e,r,i,n,a,o,s,h,l,c,u){void 0===c&&(c=0),void 0===u&&(u=0);var d=o+n-h;d>0&&(n-=d),d=s+a-l,d>0&&(a-=d),t.drawImage(r,i,n/e,a/e,c+o,u+s,n,a)},r}(e.RenderNode);e.BitmapNode=r,__reflect(r.prototype,"egret.sys.BitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=["none","round","square"],i=["bevel","miter","round"],n=function(n){function a(){var t=n.call(this)||this;return t.dirtyRender=!0,t.type=3,t}return __extends(a,n),a.prototype.beginFill=function(t,r,i){void 0===r&&(r=1);var n=new e.FillPath;if(n.fillColor=t,n.fillAlpha=r,i){var a=this.drawData.lastIndexOf(i);this.drawData.splice(a,0,n)}else this.drawData.push(n);return n},a.prototype.beginGradientFill=function(r,i,n,a,o,s){var h=new t.Matrix;o?(h.a=819.2*o.a,h.b=819.2*o.b,h.c=819.2*o.c,h.d=819.2*o.d,h.tx=o.tx,h.ty=o.ty):(h.a=100,h.d=100);var l=new e.GradientFillPath;if(l.gradientType=r,l.colors=i,l.alphas=n,l.ratios=a,l.matrix=h,s){var c=this.drawData.lastIndexOf(s);this.drawData.splice(c,0,l)}else this.drawData.push(l);return l},a.prototype.lineStyle=function(n,a,o,s,h,l){void 0===o&&(o=1),void 0===l&&(l=3),-1==r.indexOf(s)&&(s="round"),-1==i.indexOf(h)&&(h="round");var c=new e.StrokePath;return c.lineWidth=n,c.lineColor=a,c.lineAlpha=o,c.caps=s||t.CapsStyle.ROUND,c.joints=h,c.miterLimit=l,this.drawData.push(c),c},a.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0},a.prototype.cleanBeforeRender=function(){},a.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},a}(e.RenderNode);e.GraphicsNode=n,__reflect(n.prototype,"egret.sys.GraphicsNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=4,e}return __extends(e,t),e.prototype.addNode=function(t){this.drawData.push(t)},e.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;e>=0;e--)t[e].cleanBeforeRender()},e.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,r=e.length-1;r>=0;r--)t+=e[r].$getRenderCount();return t},e}(t.RenderNode);t.GroupNode=e,__reflect(e.prototype,"egret.sys.GroupNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=e.call(this)||this;return r.image=null,r.smoothing=!0,r.bounds=new t.Rectangle,r.blendMode=null,r.alpha=0/0,r.filter=null,r.rotated=!1,r.type=5,r.vertices=[],r.uvs=[],r.indices=[],r}return __extends(r,e),r.prototype.drawMesh=function(t,e,r,i,n,a,o,s){this.drawData.push(t,e,r,i,n,a,o,s),this.renderCount++},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},r}(e.RenderNode);e.MeshNode=r,__reflect(r.prototype,"egret.sys.MeshNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.DirtyRegionPolicy={OFF:"off",ON:"on"}}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){}return t.blur_frag="precision mediump float;\nuniform vec2 blur;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\nuniform vec2 uTextureSize;\nvoid main()\n{\n    const int sampleRadius = 5;\n    const int samples = sampleRadius * 2 + 1;\n    vec2 blurUv = blur / uTextureSize;\n    vec4 color = vec4(0, 0, 0, 0);\n    vec2 uv = vec2(0.0, 0.0);\n    blurUv /= float(sampleRadius);\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\n        color += texture2D(uSampler, uv);\n    }\n    color /= float(samples);\n    gl_FragColor = color;\n}",t.colorTransform_frag="precision mediump float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform mat4 matrix;\nuniform vec4 colorAdd;\nuniform sampler2D uSampler;\nvoid main(void) {\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\n    if(texColor.a > 0.) {\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\n    }\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\n}",t.default_vert="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",t.glow_frag="precision mediump float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float dist;\nuniform float angle;\nuniform vec4 color;\nuniform float alpha;\nuniform float blurX;\nuniform float blurY;\nuniform float strength;\nuniform float inner;\nuniform float knockout;\nuniform float hideObject;\nuniform vec2 uTextureSize;\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\nvoid main(void) {\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\n    const float linearSamplingTimes = 7.0;\n    const float circleSamplingTimes = 12.0;\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\n    vec4 curColor;\n    float totalAlpha = 0.0;\n    float maxTotalAlpha = 0.0;\n    float curDistanceX = 0.0;\n    float curDistanceY = 0.0;\n    float offsetX = dist * cos(angle) * px.x;\n    float offsetY = dist * sin(angle) * px.y;\n    const float PI = 3.14159265358979323846264;\n    float cosAngle;\n    float sinAngle;\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    float stepX = blurX * px.x / linearSamplingTimes;\n    float stepY = blurY * px.y / linearSamplingTimes;\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\n        cosAngle = cos(a + offset);\n        sinAngle = sin(a + offset);\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\n            curDistanceX = i * stepX * cosAngle;\n            curDistanceY = i * stepY * sinAngle;\n            \n            curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\n            totalAlpha += (linearSamplingTimes - i) * curColor.a;\n            maxTotalAlpha += (linearSamplingTimes - i);\n        }\n    }\n    ownColor.a = max(ownColor.a, 0.0001);\n    ownColor.rgb = ownColor.rgb / ownColor.a;\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\n}",t.primitive_frag="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvoid main(void) {\n    gl_FragColor = vColor;\n}",t.texture_frag="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\n}",t
}();t.EgretShaderLib=e,__reflect(e.prototype,"egret.web.EgretShaderLib")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}return __extends(r,e),r.prototype.drawText=function(t,e,r,i){this.drawData.push(t,e,r,i),this.renderCount++,this.dirtyRender=!0},r.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.dirtyRender=!0},r}(e.RenderNode);e.TextNode=r,__reflect(r.prototype,"egret.sys.TextNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=1,e}return __extends(e,t),e}(t.Path2D);t.FillPath=e,__reflect(e.prototype,"egret.sys.FillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=2,e}return __extends(e,t),e}(t.Path2D);t.GradientFillPath=e,__reflect(e.prototype,"egret.sys.GradientFillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=3,e}return __extends(e,t),e.prototype.setLineDash=function(t){this.$commands[this.commandPosition++]=5;var e=this.dataPosition;this.$data[e++]=t,this.dataPosition=e},e}(t.Path2D);t.StrokePath=e,__reflect(e.prototype,"egret.sys.StrokePath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(t,e){var r=null==e.italic?t.italic:e.italic,i=null==e.bold?t.bold:e.bold,n=null==e.size?t.size:e.size,a=e.fontFamily||t.fontFamily,o=r?"italic ":"normal ";return o+=i?"bold ":"normal ",o+=n+"px "+a}function r(t,e){var r=t>>16,i=t>>8&255,n=255&t;return"rgba("+r+","+i+","+n+","+e+")"}function i(e,i,n,a,o,s){var h;h=i==t.GradientType.LINEAR?e.createLinearGradient(-1,0,1,0):e.createRadialGradient(0,0,0,0,0,1);for(var l=n.length,c=0;l>c;c++)h.addColorStop(o[c]/255,r(n[c],a[c]));return h}function n(t,e,r){void 0===r&&(r=0);for(var i=0,n=e.length;n>i;i++)t[i+r]=e[i]}function a(t,e,r,i){for(var n=i[0],a=i[1],o=i[2],s=i[3],h=i[4],l=i[5],c=i[6],u=i[7],d=i[8],p=i[9],f=i[10],g=i[11],v=i[12],y=i[13],$=i[14],b=i[15],m=i[16],x=i[17],T=i[18],_=i[19],w=0,E=e*r*4;E>w;w+=4){var S=t[w+0],C=t[w+1],D=t[w+2],R=t[w+3];t[w+0]=n*S+a*C+o*D+s*R+h,t[w+1]=l*S+c*C+u*D+d*R+p,t[w+2]=f*S+g*C+v*D+y*R+$,t[w+3]=b*S+m*C+x*D+T*R+_}}function o(t,e,r,i,n){s(t,e,r,i),h(t,e,r,n)}function s(t,e,r,i){var a;a=T?new Uint8ClampedArray(4*e):new Array(4*e);for(var o=4*e,s=2*i+1,h=0;r>h;h++){for(var l=h*o,c=0,u=0,d=0,p=0,f=0,g=0,v=4*-i,y=4*i+4;y>v;v+=4){var $=l+v;l>$||$>=l+o||(f=t[$+3],c+=t[$+0]*f,u+=t[$+1]*f,d+=t[$+2]*f,p+=f)}for(var v=l,y=l+o,b=0,m=v-4*i,x=v+4*(i+1);y>v;v+=4,b+=4,x+=4,m+=4)0===p?(a[b+0]=0,a[b+1]=0,a[b+2]=0,a[b+3]=0):(a[b+0]=c/p,a[b+1]=u/p,a[b+2]=d/p,a[b+3]=p/s),f=t[x+3],g=t[m+3],f||0==f?g||0==g?(c+=t[x+0]*f-t[m+0]*g,u+=t[x+1]*f-t[m+1]*g,d+=t[x+2]*f-t[m+2]*g,p+=f-g):(c+=t[x+0]*f,u+=t[x+1]*f,d+=t[x+2]*f,p+=f):(g||0==g)&&(c+=-t[m+0]*g,u+=-t[m+1]*g,d+=-t[m+2]*g,p+=-g);T?t.set(a,l):n(t,a,l)}}function h(t,e,r,i){var n;n=T?new Uint8ClampedArray(4*r):new Array(4*r);for(var a=4*e,o=2*i+1,s=0;e>s;s++){for(var h=4*s,l=0,c=0,u=0,d=0,p=0,f=0,g=-i*a,v=i*a+a;v>g;g+=a){var y=h+g;h>y||y>=h+r*a||(p=t[y+3],l+=t[y+0]*p,c+=t[y+1]*p,u+=t[y+2]*p,d+=p)}for(var g=h,v=h+r*a,$=0,b=h-i*a,m=h+(i+1)*a;v>g;g+=a,$+=4,m+=a,b+=a)0===d?(n[$+0]=0,n[$+1]=0,n[$+2]=0,n[$+3]=0):(n[$+0]=l/d,n[$+1]=c/d,n[$+2]=u/d,n[$+3]=d/o),p=t[m+3],f=t[b+3],p||0==p?f||0==f?(l+=t[m+0]*p-t[b+0]*f,c+=t[m+1]*p-t[b+1]*f,u+=t[m+2]*p-t[b+2]*f,d+=p-f):(l+=t[m+0]*p,c+=t[m+1]*p,u+=t[m+2]*p,d+=p):(f||0==f)&&(l+=-t[b+0]*f,c+=-t[b+1]*f,u+=-t[b+2]*f,d+=-f);for(var x=4*s,v=x+r*a,_=0;v>x;x+=a,_+=4)t[x+0]=n[_+0],t[x+1]=n[_+1],t[x+2]=n[_+2],t[x+3]=n[_+3]}}function l(t,e,r,i,a,s,h,l,f){var g=c(t,i);u(g,e,r,h,l),o(g,e,r,a,s),d(g,f),p(g,t),t.set(g),T?t.set(g):n(t,g)}function c(t,e){e||(e=[0,0,0,0]);var r;T?r=new Uint8ClampedArray(t):(r=new Array(t.length),n(r,t));for(var i=e[0],a=e[1],o=e[2],s=e[3],h=0,l=r.length;l>h;h+=4){var c=r[h+3];r[h+0]=i*c,r[h+1]=a*c,r[h+2]=o*c,r[h+3]=s*c}return r}function u(t,e,r,i,a){var o,s,h=Math.sin(i)*a|0,l=Math.cos(i)*a|0;if(T){o=new Int32Array(t.buffer),s=new Int32Array(o.length);for(var c=0;r>c;c++){var u=c+h;if(!(0>u||u>r))for(var d=0;e>d;d++){var p=d+l;0>p||p>e||(s[u*e+p]=o[c*e+d])}}o.set(s)}else{o=t,s=new Array(o.length);for(var c=0;r>c;c++){var u=c+h;if(!(0>u||u>r))for(var d=0;e>d;d++){var p=d+l;0>p||p>e||(s[4*(u*e+p)+0]=o[4*(c*e+d)+0],s[4*(u*e+p)+1]=o[4*(c*e+d)+1],s[4*(u*e+p)+2]=o[4*(c*e+d)+2],s[4*(u*e+p)+3]=o[4*(c*e+d)+3])}}n(o,s)}}function d(t,e){for(var r=0,i=t.length;i>r;r+=4)t[r+3]*=e}function p(t,e){for(var r=0,i=t.length;i>r;r+=4){var n=t[r+0],a=t[r+1],o=t[r+2],s=t[r+3]/255,h=e[r+0],l=e[r+1],c=e[r+2],u=e[r+3]/255;t[r+0]=h+n*(1-u),t[r+1]=l+a*(1-u),t[r+2]=c+o*(1-u),t[r+3]=255*(u+s*(1-u))}}function f(t,e,r){return t*(1-r)+e*r}function g(t,e,r,i,a,o,s,h,l,c,u,d){var p;p=T?new Uint8ClampedArray(t.length):new Array(t.length);for(var g,v,y=i[3],$=0,b=0,m=h*Math.cos(s),x=h*Math.sin(s),_=7,w=12,E=3.141592653589793,S=a/_,C=o/_,D=0;e>D;D++)for(var R=0;r>R;R++){for(var O=0,L=R*e*4+4*D,A=0,M=0,B=t[L+0]/255,F=t[L+1]/255,P=t[L+2]/255,N=t[L+3]/255,I=0;2*E>=I;I+=2*E/w){g=Math.cos(I+O),v=Math.sin(I+O);for(var k=0;_>k;k++){$=k*S*g,b=k*C*v;var H=Math.round(D+$-m),W=Math.round(R+b-x),U=0;if(H>=e||0>H||0>W||W>=r)U=0;else{var X=W*e*4+4*H;U=t[X+3]/255}A+=(_-k)*U,M+=_-k}}N=Math.max(N,1e-4);var j=A/M*l*y*(1-c)*Math.max(Math.min(d,u),1-N),Y=(M-A)/M*l*y*c*N;N=Math.max(N*u*(1-d),1e-4);var G=Y/(Y+N),V=f(B,i[0],G),z=f(F,i[1],G),q=f(P,i[2],G),K=j/(Y+N+j),J=f(V,i[0],K),Q=f(z,i[1],K),Z=f(q,i[2],K),te=Math.min(N+j+Y,1);p[L+0]=255*J,p[L+1]=255*Q,p[L+2]=255*Z,p[L+3]=255*te}T?t.set(p):n(t,p)}var v=["source-over","lighter","destination-out"],y="source-over";t.BLACK_COLOR="#000000";var $={none:"butt",square:"square",round:"round"},b=[],m=[],x=function(){function n(){this.nestLevel=0,this.renderingMask=!1}return n.prototype.render=function(e,r,i,n){this.nestLevel++;var a=r.context;a.transform(i.a,i.b,i.c,i.d,0,0);var o=this.drawDisplayObject(e,a,i.tx,i.ty,!0),s=t.Matrix.create();if(i.$invertInto(s),a.transform(s.a,s.b,s.c,s.d,0,0),t.Matrix.release(s),this.nestLevel--,0===this.nestLevel){b.length>6&&(b.length=6);for(var h=b.length,l=0;h>l;l++)b[l].resize(0,0)}return o},n.prototype.drawDisplayObject=function(e,r,i,n,a){var o,s=0,h=e.$displayList;if(h&&!a?((e.$cacheDirty||e.$renderDirty||h.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||h.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=h.drawToSurface()),o=h.$renderNode):o=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,o){switch(s++,r.$offsetX=i,r.$offsetY=n,o.type){case 1:this.renderBitmap(o,r);break;case 2:this.renderText(o,r);break;case 3:this.renderGraphics(o,r);break;case 4:this.renderGroup(o,r);break;case 5:this.renderMesh(o,r);break;case 6:this.renderNormalBitmap(o,r)}r.$offsetX=0,r.$offsetY=0}if(h&&!a)return s;var l=e.$children;if(l)for(var c=l.length,u=0;c>u;u++){var d=l[u],p=void 0,f=void 0;if(d.$useTranslate){var g=d.$getMatrix();p=i+d.$x,f=n+d.$y,r.save(),r.transform(g.a,g.b,g.c,g.d,p,f),p=-d.$anchorOffsetX,f=-d.$anchorOffsetY}else p=i+d.$x-d.$anchorOffsetX,f=n+d.$y-d.$anchorOffsetY;var v=void 0;switch(1!=d.$alpha&&(v=r.globalAlpha,r.globalAlpha*=d.$alpha),d.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(d,r,p,f);break;case 3:s+=this.drawWithClip(d,r,p,f);break;case 4:s+=this.drawWithScrollRect(d,r,p,f);break;default:s+=this.drawDisplayObject(d,r,p,f)}d.$useTranslate?r.restore():v&&(r.globalAlpha=v)}return s},n.prototype.drawWithFilter=function(e,r,i,n){if(t.Capabilities.runtimeType==t.RuntimeType.NATIVE)return this.drawWithFilterNative(e,r,i,n);var s,h=0,c=e.$filters,u=c.length,d=0!==e.$blendMode;d&&(s=v[e.$blendMode],s||(s=y));var p=e.$getOriginalBounds();if(p.width<=0||p.height<=0)return h;var f=this.createRenderBuffer(p.width,p.height,!0),$=f.context;if(h+=e.$mask?this.drawWithClip(e,r,i,n):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,r,i,n):this.drawDisplayObject(e,r,i,n),h>0){d&&(r.globalCompositeOperation=s),h++;for(var b=$.getImageData(0,0,f.surface.width,f.surface.height),x=0;u>x;x++){var T=c[x];if("colorTransform"==T.type)a(b.data,f.surface.width,f.surface.height,T.$matrix);else if("blur"==T.type)o(b.data,f.surface.width,f.surface.height,T.$blurX,T.$blurY);else if("glow"==T.type){var _=T.$red,w=T.$green,E=T.$blue,S=T.$alpha;T.$inner||T.$knockout||T.$hideObject?g(b.data,f.surface.width,f.surface.height,[_/255,w/255,E/255,S],T.$blurX,T.$blurY,T.$angle?T.$angle/180*Math.PI:0,T.$distance||0,T.$strength,T.$inner?1:0,T.$knockout?0:1,T.$hideObject?1:0):l(b.data,f.surface.width,f.surface.height,[_/255,w/255,E/255,S],T.$blurX,T.$blurY,T.$angle?T.$angle/180*Math.PI:0,T.$distance||0,T.$strength)}else"custom"==T.type}$.putImageData(b,0,0),r.globalAlpha=1,r.drawImage(f.surface,i+p.x,n+p.y),d&&(r.globalCompositeOperation=y)}return m.push(f),h},n.prototype.drawWithFilterNative=function(t,e,r,i){var n,a=0,o=t.$filters,s=0!==t.$blendMode;s&&(n=v[t.$blendMode],n||(n=y));var h=t.$getOriginalBounds();if(h.width<=0||h.height<=0)return a;if(1==o.length&&"colorTransform"==o[0].type&&!t.$children)return s&&(e.globalCompositeOperation=n),e.setGlobalShader(o[0]),a+=t.$mask?this.drawWithClip(t,e,r,i):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,e,r,i):this.drawDisplayObject(t,e,r,i),e.setGlobalShader(null),s&&(e.globalCompositeOperation=y),a;var l=this.createRenderBuffer(h.width,h.height);return a+=t.$mask?this.drawWithClip(t,e,r,i):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,e,r,i):this.drawDisplayObject(t,e,r,i),a>0&&(s&&(e.globalCompositeOperation=n),a++,e.globalAlpha=1,e.setGlobalShader(o[0]),e.drawImage(l.surface,0,0,l.width,l.height,r+h.x,i+h.y,l.width,l.height),e.setGlobalShader(null),s&&(e.globalCompositeOperation=y)),b.push(l),a},n.prototype.drawWithClip=function(e,r,i,n){var a,o=0,s=0!==e.$blendMode;s&&(a=v[e.$blendMode],a||(a=y));var h=e.$scrollRect?e.$scrollRect:e.$maskRect,l=e.$mask;if(l){var c=l.$getMatrix();if(0==c.a&&0==c.b||0==c.c&&0==c.d)return o}if(!(l||e.$children&&0!=e.$children.length))return h&&(r.save(),r.beginPath(),r.rect(h.x+i,h.y+n,h.width,h.height),r.clip()),s&&(r.globalCompositeOperation=a),o+=this.drawDisplayObject(e,r,i,n),s&&(r.globalCompositeOperation=y),h&&r.restore(),o;var u=l.$getRenderNode();if(l&&t.Capabilities.$runtimeType==t.RuntimeType.WEB&&(!l.$children||0==l.$children.length)&&u&&3==u.type&&1==u.drawData.length&&1==u.drawData[0].type&&1==u.drawData[0].fillAlpha){this.renderingMask=!0,r.save();var d=t.Matrix.create();d.copyFrom(l.$getConcatenatedMatrix()),l.$getConcatenatedMatrixAt(e,d),r.transform(d.a,d.b,d.c,d.d,d.tx,d.ty);var p=this.drawDisplayObject(l,r,i,n);return this.renderingMask=!1,d.$invertInto(d),r.transform(d.a,d.b,d.c,d.d,d.tx,d.ty),t.Matrix.release(d),h&&(r.beginPath(),r.rect(h.x+i,h.y+n,h.width,h.height),r.clip()),p+=this.drawDisplayObject(e,r,i,n),r.restore(),p}var f=e.$getOriginalBounds(),g=this.createRenderBuffer(f.width,f.height),$=g.context;if(!$)return o+=this.drawDisplayObject(e,r,i,n);if(o+=this.drawDisplayObject(e,$,0,0),l){var d=t.Matrix.create();if(d.copyFrom(l.$getConcatenatedMatrix()),l.$getConcatenatedMatrixAt(e,d),t.Capabilities.$runtimeType==t.RuntimeType.WEB&&u&&1==u.$getRenderCount()||l.$displayList)$.globalCompositeOperation="destination-in",$.save(),$.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty),o+=this.drawDisplayObject(l,$,0,0),$.restore();else{var m=this.createRenderBuffer(f.width,f.height),x=m.context;x.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty),o+=this.drawDisplayObject(l,x,-f.x,-f.y),$.globalCompositeOperation="destination-in",$.globalAlpha=1,$.drawImage(m.surface,0,0),b.push(m)}t.Matrix.release(d)}return o>0&&(o++,s&&(r.globalCompositeOperation=a),h&&(r.save(),r.beginPath(),r.rect(h.x+i,h.y+n,h.width,h.height),r.clip()),r.globalAlpha=1,r.drawImage(g.surface,i+f.x,n+f.y),h&&r.restore(),s&&(r.globalCompositeOperation=y)),b.push(g),o},n.prototype.drawWithScrollRect=function(t,e,r,i){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;return a.isEmpty()?n:(t.$scrollRect&&(r-=a.x,i-=a.y),e.save(),e.beginPath(),e.rect(a.x+r,a.y+i,a.width,a.height),e.clip(),n+=this.drawDisplayObject(t,e,r,i),e.restore(),n)},n.prototype.drawNodeToBuffer=function(t,e,r,i){var n=e.context;n.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(t,n,i)},n.prototype.drawDisplayToBuffer=function(t,e,r){var i=e.context;r&&i.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty);var n;n=t.$renderDirty?t.$getRenderNode():t.$renderNode;var a=0;if(n)switch(a++,n.type){case 1:this.renderBitmap(n,i);break;case 2:this.renderText(n,i);break;case 3:this.renderGraphics(n,i);break;case 4:this.renderGroup(n,i);break;case 5:this.renderMesh(n,i);break;case 6:this.renderNormalBitmap(n,i)}var o=t.$children;if(o)for(var s=o.length,h=0;s>h;h++){var l=o[h];switch(l.$renderMode){case 1:break;case 2:a+=this.drawWithFilter(l,i,0,0);break;case 3:a+=this.drawWithClip(l,i,0,0);break;case 4:a+=this.drawWithScrollRect(l,i,0,0);break;default:a+=this.drawDisplayObject(l,i,0,0)}}return a},n.prototype.renderNode=function(t,e,r){var i=0;switch(t.type){case 1:i=this.renderBitmap(t,e);break;case 2:i=1,this.renderText(t,e);break;case 3:i=this.renderGraphics(t,e,r);break;case 4:i=this.renderGroup(t,e);break;case 5:i=this.renderMesh(t,e);break;case 6:i+=this.renderNormalBitmap(t,e)}return i},n.prototype.renderNormalBitmap=function(t,e){var r=t.image;if(!r||!r.source)return 0;if(e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),t.rotated){var i=t.sourceX,n=t.sourceY,a=t.sourceW,o=t.sourceH,s=t.drawX,h=t.drawY,l=t.drawW,c=t.drawH;e.save(),e.transform(0,-1,1,0,0,c),e.drawImage(r.source,i,n,o,a,s+e.$offsetX,h+e.$offsetY,c,l),e.restore()}else e.drawImage(r.source,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX+e.$offsetX,t.drawY+e.$offsetY,t.drawW,t.drawH);return 1},n.prototype.renderBitmap=function(t,e){var r=t.image;if(!r||!r.source)return 0;e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing);var i,n,o=t.drawData,s=o.length,h=0,l=t.matrix,c=t.blendMode,u=t.alpha,d=!1;l&&(e.save(),d=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,n=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(l.a,l.b,l.c,l.d,l.tx,l.ty)),c&&(e.globalCompositeOperation=v[c]);var p;u==u&&(p=e.globalAlpha,e.globalAlpha*=u);var f=0,g=t.filter;if(g&&8==s){var $=o[0],m=o[1],x=o[2],T=o[3],_=o[4],w=o[5],E=o[6],S=o[7];t.rotated&&(x=o[3],T=o[2],E=o[7],S=o[6]);var C=this.createRenderBuffer(E,S),D=C.context;f++,t.rotated&&e.transform(0,-1,1,0,0,E),D.drawImage(r.source,$,m,x,T,0,0,E,S),f++;var R=D.getImageData(0,0,E,S);a(R.data,E,S,g.$matrix),D.putImageData(R,0,0),e.drawImage(C.surface,0,0,E,S,_+e.$offsetX,w+e.$offsetY,E,S),b.push(C)}else for(;s>h;)if(f++,t.rotated){var $=o[h++],m=o[h++],T=o[h++],x=o[h++],O=o[h++],L=o[h++],S=o[h++],E=o[h++];e.save(),e.transform(0,-1,1,0,0,E),e.drawImage(r.source,$,m,x,T,O+e.$offsetX,L+e.$offsetY,E,S),e.restore()}else e.drawImage(r.source,o[h++],o[h++],o[h++],o[h++],o[h++]+e.$offsetX,o[h++]+e.$offsetY,o[h++],o[h++]);return d?e.restore():(c&&(e.globalCompositeOperation=y),u==u&&(e.globalAlpha=p)),i&&(e.$offsetX=i),n&&(e.$offsetY=n),f},n.prototype.renderMesh=function(t,e){return 0},n.prototype.renderText=function(r,i){i.textAlign="left",i.textBaseline="middle",i.lineJoin="round";for(var n=r.drawData,a=n.length,o=0;a>o;){var s=n[o++],h=n[o++],l=n[o++],c=n[o++];i.font=e(r,c);var u=null==c.textColor?r.textColor:c.textColor,d=null==c.strokeColor?r.strokeColor:c.strokeColor,p=null==c.stroke?r.stroke:c.stroke;i.fillStyle=t.toColorString(u),i.strokeStyle=t.toColorString(d),p&&(i.lineWidth=2*p,i.strokeText(l,s+i.$offsetX,h+i.$offsetY)),i.fillText(l,s+i.$offsetX,h+i.$offsetY)}},n.prototype.renderGraphics=function(e,n,a){var o=e.drawData,s=o.length;a=!!a;for(var h=0;s>h;h++){var l=o[h];switch(l.type){case 1:var c=l;n.fillStyle=a?t.BLACK_COLOR:r(c.fillColor,c.fillAlpha),this.renderPath(l,n),this.renderingMask?n.clip():n.fill();break;case 2:var u=l;n.fillStyle=a?t.BLACK_COLOR:i(n,u.gradientType,u.colors,u.alphas,u.ratios,u.matrix),n.save();var d=u.matrix;this.renderPath(l,n),n.transform(d.a,d.b,d.c,d.d,d.tx,d.ty),n.fill(),n.restore();break;case 3:var p=l,f=p.lineWidth;n.lineWidth=f,n.strokeStyle=a?t.BLACK_COLOR:r(p.lineColor,p.lineAlpha),n.lineCap=$[p.caps],n.lineJoin=p.joints,n.miterLimit=p.miterLimit;var g=1===f||3===f;g&&n.translate(.5,.5),this.renderPath(l,n),n.stroke(),g&&n.translate(-.5,-.5)}}return 0==s?0:1},n.prototype.renderPath=function(t,e){e.beginPath();for(var r=t.$data,i=t.$commands,n=i.length,a=0,o=0;n>o;o++){var s=i[o];switch(s){case 4:e.bezierCurveTo(r[a++]+e.$offsetX,r[a++]+e.$offsetY,r[a++]+e.$offsetX,r[a++]+e.$offsetY,r[a++]+e.$offsetX,r[a++]+e.$offsetY);break;case 3:e.quadraticCurveTo(r[a++]+e.$offsetX,r[a++]+e.$offsetY,r[a++]+e.$offsetX,r[a++]+e.$offsetY);break;case 2:e.lineTo(r[a++]+e.$offsetX,r[a++]+e.$offsetY);break;case 1:e.moveTo(r[a++]+e.$offsetX,r[a++]+e.$offsetY);break;case 5:e.setLineDash(r[a++])}}},n.prototype.renderGroup=function(t,e){var r,i,n=t.matrix,a=!1;n&&(e.save(),a=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),r=e.$offsetX,i=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty));for(var o=0,s=t.drawData,h=s.length,l=0;h>l;l++){var c=s[l];o+=this.renderNode(c,e)}return a&&e.restore(),r&&(e.$offsetX=r),i&&(e.$offsetY=i),o},n.prototype.createRenderBuffer=function(e,r,i){var n=i?m.pop():b.pop();return n?n.resize(e,r,!0):n=new t.sys.CanvasRenderBuffer(e,r),n},n}();t.CanvasRenderer=x,__reflect(x.prototype,"egret.CanvasRenderer"),t.getFontString=e,t.getRGBAString=r;var T=!1;try{T=void 0!==typeof Uint8ClampedArray}catch(_){}}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),t.call(this,e,r,i)||this}return __extends(e,t),e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e}(t.Event);t.FocusEvent=e,__reflect(e.prototype,"egret.FocusEvent")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t){var r=e.call(this)||this;return r.format="image",r.$deleteSource=!0,r.source=t,r.width=t.width,r.height=t.height,r}return __extends(r,e),r.create=function(e,i,n){var a="";a="arraybuffer"===e?t.Base64Util.encode(i):i;var o="image/png";"/"===a.charAt(0)?o="image/jpeg":"R"===a.charAt(0)?o="image/gif":"i"===a.charAt(0)&&(o="image/png");var s=new Image;s.src="data:"+o+";base64,"+a,s.crossOrigin="*";var h=new r(s);return s.onload=function(){s.onload=void 0,h.source=s,h.height=s.height,h.width=s.width,n&&n(h)},h},r.prototype.$dispose=function(){t.Capabilities.runtimeType==t.RuntimeType.WEB&&"webgl"==t.Capabilities.renderMode&&this.webGLTexture&&(t.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source=null,r.$dispose(this)},r.$addDisplayObject=function(t,e){if(e){var i=e.hashCode;if(i){if(!r._displayList[i])return void(r._displayList[i]=[t]);var n=r._displayList[i];n.indexOf(t)<0&&n.push(t)}}},r.$removeDisplayObject=function(t,e){if(e){var i=e.hashCode;if(i&&r._displayList[i]){var n=r._displayList[i],a=n.indexOf(t);a>=0&&n.splice(a)}}},r.$invalidate=function(e){if(e){var i=e.hashCode;if(i&&r._displayList[i])for(var n=r._displayList[i],a=0;a<n.length;a++){n[a]instanceof t.Bitmap&&n[a].$refreshImageData();var o=n[a];o.$renderDirty=!0;var s=o.$parent;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp());var h=o.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}}},r.$dispose=function(e){if(e){var i=e.hashCode;if(i&&r._displayList[i]){for(var n=r._displayList[i],a=0,o=n;a<o.length;a++){var s=o[a];s instanceof t.Bitmap&&(s.$bitmapData=null),s.$renderDirty=!0;var h=s.$parent;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp());var l=s.$maskedObject;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp())}__global.nativeRender&&t.NativeNode.disposeBitmapData(e),delete r._displayList[i]}}},r._displayList=t.createMap(),r}(t.HashObject);t.BitmapData=e,__reflect(e.prototype,"egret.BitmapData")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onChange=function(e){var i=new t.OrientationEvent(t.Event.CHANGE);i.beta=e.beta,i.gamma=e.gamma,i.alpha=e.alpha,r.dispatchEvent(i)},r}return __extends(r,e),r.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},r.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},r}(t.EventDispatcher);e.WebDeviceOrientation=r,__reflect(r.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(e=t.web||(t.web={}))}(egret||(egret={})),egret.DeviceOrientation=egret.web.WebDeviceOrientation;var egret;!function(t){var e;!function(e){var r=function(e){function r(r){var i=e.call(this)||this;return i.onUpdate=function(e){var r=new t.GeolocationEvent(t.Event.CHANGE),n=e.coords;r.altitude=n.altitude,r.heading=n.heading,r.accuracy=n.accuracy,r.latitude=n.latitude,r.longitude=n.longitude,r.speed=n.speed,r.altitudeAccuracy=n.altitudeAccuracy,i.dispatchEvent(r)},i.onError=function(e){var r=t.GeolocationEvent.UNAVAILABLE;e.code==e.PERMISSION_DENIED&&(r=t.GeolocationEvent.PERMISSION_DENIED);var n=new t.GeolocationEvent(t.IOErrorEvent.IO_ERROR);n.errorType=r,n.errorMessage=e.message,i.dispatchEvent(n)},i.geolocation=navigator.geolocation,i}return __extends(r,e),r.prototype.start=function(){var e=this.geolocation;e?this.watchId=e.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:t.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},r.prototype.stop=function(){var t=this.geolocation;t.clearWatch(this.watchId)},r}(t.EventDispatcher);e.WebGeolocation=r,__reflect(r.prototype,"egret.web.WebGeolocation",["egret.Geolocation"]),t.Geolocation=t.web.WebGeolocation}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onChange=function(e){var i=new t.MotionEvent(t.Event.CHANGE),n={x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},a={x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},o={alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma};i.acceleration=n,i.accelerationIncludingGravity=a,i.rotationRate=o,r.dispatchEvent(i)},r}return __extends(r,e),r.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},r.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},r}(t.EventDispatcher);e.WebMotion=r,__reflect(r.prototype,"egret.web.WebMotion",["egret.Motion"]),t.Motion=t.web.WebMotion}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var n=e.call(this,t,r,i)||this;return n._status=0,n}return __extends(r,e),Object.defineProperty(r.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),r.dispatchHTTPStatusEvent=function(e,i){var n=t.Event.create(r,r.HTTP_STATUS);n._status=i;var a=e.dispatchEvent(n);return t.Event.release(n),a},r.HTTP_STATUS="httpStatus",r}(t.Event);t.HTTPStatusEvent=e,__reflect(e.prototype,"egret.HTTPStatusEvent")}(egret||(egret={}));var egret;!function(t){function e(t,e){i[t]=e}function r(t){return i[t]}var i={};t.registerImplementation=e,t.getImplementation=r}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LINEAR="linear",t.RADIAL="radial",t}();t.GradientType=e,__reflect(e.prototype,"egret.GradientType")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r,i,n,a,o,s,h,l,c,u,d,p,f,g,v;e.forHitTest=!1;var y=[],$=[],b=!1;e.addModuleCallback=function(t,e){y.push(t),$.push(e)},e.init=function(e){function v(){Module.__bitmapDataMap=R,Module.__textFieldDataMap=O,Module.__customFilterDataMap=L,f=Module.getPixels,Module.customInit(),Module.downloadBuffers(function(e,f,v,b){if(r=e,i=f,n=v,t.NativeNode.init(b,__global.nativeRender,R,M,L),a=Module.update,o=Module.render,s=Module.resize,h=Module.setRenderMode,l=Module.updateCallbackList,c=Module.renderDisplayObject,u=Module.renderDisplayObject2,d=Module.localToGlobal,p=Module.globalToLocal,g=Module.activateBuffer,m=t.getTimer(),y.length>0)for(var x=y,T=$,_=0;_<x.length;_++){var w=x[_];null!=w&&w.apply(T[_])}t.startTick(E.updatePreCallback,E)})}if(void 0===e&&(e=134217728),b){if(y.length>0)for(var x=y,T=$,_=0;_<x.length;_++){var w=x[_];null!=w&&w.apply(T[_])}}else{b=!0;var E=this;v()}},e.setRootBuffer=function(t){v=t},e.setRenderMode=function(t){h(2)},e.renderDisplayObject=function(t,e,r,i,n,a,o){c(t,e,r,i,n,a,o)},e.renderDisplayObjectWithOffset=function(t,r,i){u(t,r,i,e.forHitTest)},e.localToGlobal=function(t,e,r){return d(t,e,r)},e.globalToLocal=function(t,e,r){return p(t,e,r)},e.resize=function(t,e){s(t,e)},e.setCanvasScaleFactor=function(t,e,r){Module.setCanvasScaleFactor(t,e,r)},e.update=function(){x(),T(),t.NativeNode.update(),a&&a()},e.dirtyTextField=function(t){B.push(t),C[t.$nativeNode.id]=t},e.dirtyGraphics=function(t){F.push(t),D[t.$targetDisplay.$nativeNode.id]=t};var m,x=function(){var t=B.length;if(t>0){var e=B;B=[];for(var r=0;t>r;r++){var i=e[r];i.$getRenderNode();var n=i.$renderNode,a=n.width-n.x,o=n.height-n.y;if(0==n.drawData.length){var s=i.$graphicsNode;s?i.$nativeNode.setTextRect(s.x,s.y,s.width,s.height):i.$nativeNode.setTextRect(0,0,0,0)}else i.$nativeNode.setTextRect(n.x,n.y,a,o);E(i.$nativeNode.id)}}},T=function(){var t=F.length;if(t>0){var e=F;F=[];for(var r=0;t>r;r++){var i=e[r],n=i.$renderNode,a=n.width,o=n.height;0>=a||0>=o||!a||!o||0==n.drawData.length?i.$targetDisplay.$nativeNode.setGraphicsRect(0,0,0,0,i.$targetIsSprite):i.$targetDisplay.$nativeNode.setGraphicsRect(n.x,n.y,n.width,n.height,i.$targetIsSprite),S(i.$targetDisplay.$nativeNode.id,n)}}};e.updatePreCallback=function(t){var e=t-m;return m=t,l&&l(e),!1};e.render=function(){o&&o()};var _=function(t,e){if(-1==t.indexOf("r"))t=t.replace(/#/,""),e.color=parseInt(t,16);else{t=t.replace(/rgba\(/,""),t=t.replace(/\)/,"");var r=t.split(",");e.color=Number(r[0])<<16|Number(r[1])<<8|Number(r[2]),e.alpha=Number(r[3])}},w=function(t,e){e.push(1023);for(var r=t.$data,i=t.$commands,n=i.length,a=0,o=0;n>o;o++){var s=i[o];switch(s){case 4:e.push(1024),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]);break;case 3:e.push(1025),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]);break;case 2:e.push(1026),e.push(r[a++]),e.push(r[a++]);break;case 1:e.push(1027),e.push(r[a++]),e.push(r[a++])}}},E=function(e){var r=C[e],i=r.$renderNode,n=i.width-i.x,a=i.height-i.y;if(!(0>=n||0>=a)&&n&&a){var o=t.sys.DisplayList.$canvasScaleX,s=t.sys.DisplayList.$canvasScaleY,h=4096;n*o>h&&(o*=h/(n*o)),a*s>h&&(s*=h/(a*s)),n*=o,a*=s;var l=i.x*o,c=i.y*s;if(!O[e]){var u={x:i.x,y:i.y,width:i.width,height:i.height,renderCmds:[],renderParms:""};O[e]=u}var d=(-i.x,-i.y,O[e]),p=d.renderCmds;if(i.dirtyRender){p.length=0,d.renderParms="",p.push(1010),p.push(1),d.x=i.x,d.y=i.y,d.width=i.width,d.height=i.height,p.push(1011),p.push(n),p.push(a),p.push(i.x),p.push(i.y),(1!=o||1!=s)&&(p.push(1019),p.push(o),p.push(0),p.push(0),p.push(s),p.push(0),p.push(0),p.push(0)),(l||c)&&(p.push(1019),p.push(o),p.push(0),p.push(0),p.push(s),p.push(-l),p.push(-c),p.push(1)),r.$graphicsNode&&(p.push(1015),S(e,r.$graphicsNode,p),p.push(1016));for(var f=i.drawData,g=f.length,v=0;g>v;){var y=f[v++],$=f[v++],b=f[v++],m=f[v++],x=null==m.textColor?i.textColor:m.textColor,T=null==m.strokeColor?i.strokeColor:m.strokeColor,_=null==m.stroke?i.stroke:m.stroke;p.push(1012);var w=t.getFontString(i,m),E="",D=-1,R=w.split(",");if(R.length>0){for(var L=R[0].split(" "),A=0;A<L.length;A++)if(-1!=L[A].indexOf("px")){D=Number(L[A].replace(/px/,"")),E=w.substring(w.indexOf(L[A])+L[A].length+1);break}p.push(D),d.renderParms+=E,-1==w.indexOf("bold")?p.push(0):p.push(1),-1==w.indexOf("italic")?p.push(0):p.push(1),d.renderParms+=";";var M=0,B=void 0,F=void 0,P=t.toColorString(x);if(-1==P.indexOf("r"))P=P.replace(/#/,""),M=parseInt(P,16);else{P=P.replace(/rgba\(/,""),P=P.replace(/\)/,"");var N=P.split(",");B=Number(N[0])<<16|Number(N[1])<<8|Number(N[2]),F=Number(L[3])}p.push(M);var I=t.toColorString(T),k=0,H=void 0;if(-1==I.indexOf("r"))I=I.replace(/#/,""),k=parseInt(I,16);else{I=I.replace(/rgba\(/,""),I=I.replace(/\)/,"");var W=I.split(",");k=Number(W[0])<<16|Number(W[1])<<8|Number(W[2]),H=Number(L[3])}p.push(k),d.renderParms+=b,d.renderParms+=";",p.push(1013),_?p.push(2*_):p.push(0),p.push(1014),p.push(y),p.push($)}}(l||c)&&(p.push(1019),p.push(o),p.push(0),p.push(0),p.push(s),p.push(0),p.push(0),p.push(-1)),r.$nativeNode.setDataToTextField(e,p),i.dirtyRender=!1}}},S=function(r,i,n){void 0===n&&(n=null);var a=i.width,o=i.height,s=!1;if(null===n){if(!A[r]){var h={x:i.x,y:i.y,width:i.width,height:i.height,renderCmds:[]};A[r]=h}var l=A[r];l.x=i.x,l.y=i.y,l.width=i.width,l.height=i.height,l.renderCmds.length=0,n=l.renderCmds,s=!0}var c=t.sys.DisplayList.$canvasScaleX,u=t.sys.DisplayList.$canvasScaleY;if((1>a*c||1>o*u)&&(c=u=1),(i.$canvasScaleX!=c||i.$canvasScaleY!=u)&&(i.$canvasScaleX=c,i.$canvasScaleY=u,i.dirtyRender=!0),a*=c,o*=u,i.dirtyRender||e.forHitTest){n.push(1010),n.push(1),n.push(1011),n.push(a),n.push(o),n.push(i.x),n.push(i.y),(1!=c||1!=u)&&(n.push(1019),n.push(c),n.push(0),n.push(0),n.push(u),n.push(0),n.push(0),n.push(0)),(i.x||i.y)&&(n.push(1020),n.push(-i.x),n.push(-i.y),n.push(1));for(var d=i.drawData,p=d.length,f={color:0,alpha:1},g=0;p>g;g++){var v=d[g];switch(f.color=0,f.alpha=1,v.type){case 1:var y=v;_(e.forHitTest?t.BLACK_COLOR:t.getRGBAString(y.fillColor,y.fillAlpha),f),n.push(1021),n.push(f.color),n.push(f.alpha),w(v,n),n.push(1028);break;case 2:break;case 3:var $=v,b=$.lineWidth;_(e.forHitTest?t.BLACK_COLOR:t.getRGBAString($.lineColor,$.lineAlpha),f),n.push(1022),n.push(f.color),n.push(f.alpha),n.push(b);var m=1===b||3===b;m&&(n.push(1020),n.push(.5),n.push(.5),n.push(0)),w(v,n),n.push(1029),m&&(n.push(1020),n.push(-.5),n.push(-.5),n.push(0))}}(i.x||i.y)&&(n.push(1020),n.push(i.x),n.push(i.y),n.push(-1)),s&&D[r].$targetDisplay.$nativeNode.setGraphicsRenderData(n),e.forHitTest||(i.dirtyRender=!1)}};e.activateWebGLBuffer=function(t){t||(t=v),g(t.bufferIdForWasm,t.width,t.height)},e.getCurrentBuffer=function(){return e.currentWebGLBuffer},e.getPixels=function(t,e,r,i){void 0===r&&(r=1),void 0===i&&(i=1);var n=new Uint8Array(4*r*i);return f(t,e,r,i,n),n},e.activateBuffer=function(t){e.activateWebGLBuffer(t)};var C=t.createMap(),D=t.createMap(),R={},O={},L={},A={},M=t.createMap(),B=[],F=[]}(e=t.NativeDelegate||(t.NativeDelegate={}))}(egret||(egret={}));var egret;!function(t){var e,r,i,n=0,a=1,o=1,s={},h={},l=2,c=0;__global.nativeRender&&(i=new Float32Array(2e4));var u=!1,d=function(){function t(t){this.id=n,this.$obj=new Module.WasmNode(this.id,t),i[l++]=0,i[l++]=n,i[l++]=t,c++,n++}return t.init=function(t,n,a,o,h){if(2!=l){console.log("displayCmdBufferIndex "+l);for(var c=2;l>c;c++)t[c]=i[c]}i=t,u=n,i[0]=0,i[1]=2,e=a,r=o,s=h},t.update=function(){i[0]=c,i[1]=l,c=0,l=2},t.prototype.addChildAt=function(t,e){i[l++]=3,i[l++]=this.id,i[l++]=t,i[l++]=e,c++},t.prototype.removeChild=function(t){i[l++]=2,i[l++]=this.id,i[l++]=t,c++},t.prototype.swapChild=function(t,e){i[l++]=4,i[l++]=this.id,i[l++]=t,i[l++]=e,c++},t.prototype.setX=function(t){i[l++]=101,i[l++]=this.id,i[l++]=t,c++},t.prototype.setY=function(t){i[l++]=102,i[l++]=this.id,i[l++]=t,c++
},t.prototype.setRotation=function(t){i[l++]=103,i[l++]=this.id,i[l++]=t,c++},t.prototype.setScaleX=function(t){i[l++]=104,i[l++]=this.id,i[l++]=t,c++},t.prototype.setScaleY=function(t){i[l++]=105,i[l++]=this.id,i[l++]=t,c++},t.prototype.setSkewX=function(t){i[l++]=106,i[l++]=this.id,i[l++]=t,c++},t.prototype.setSkewY=function(t){i[l++]=107,i[l++]=this.id,i[l++]=t,c++},t.prototype.setAlpha=function(t){i[l++]=108,i[l++]=this.id,i[l++]=t,c++},t.prototype.setAnchorOffsetX=function(t){i[l++]=116,i[l++]=this.id,i[l++]=t,c++},t.prototype.setAnchorOffsetY=function(t){i[l++]=117,i[l++]=this.id,i[l++]=t,c++},t.prototype.setVisible=function(t){i[l++]=118,i[l++]=this.id,i[l++]=t?1:0,c++},t.prototype.setBlendMode=function(t){i[l++]=126,i[l++]=this.id,i[l++]=t,c++},t.prototype.setMaskRect=function(t,e,r,n){i[l++]=127,i[l++]=this.id,i[l++]=t,i[l++]=e,i[l++]=r,i[l++]=n,c++},t.prototype.setScrollRect=function(t,e,r,n){i[l++]=128,i[l++]=this.id,i[l++]=t,i[l++]=e,i[l++]=r,i[l++]=n,c++},t.prototype.setFilters=function(t){if(!t)return i[l++]=134,i[l++]=this.id,i[l++]=0,void c++;i[l++]=134,i[l++]=this.id;for(var e=l++,r=t.length,n=r,a=0;r>a;a++){var o=t[a];if("blur"==o.type){var s=o;0!=s.$blurX&&0!=s.$blurY?(n++,i[l++]=s.blurXFilter.$id,i[l++]=s.blurYFilter.$id):0!=s.$blurX?i[l++]=s.blurXFilter.$id:0!=s.$blurY?i[l++]=s.blurYFilter.$id:n--}else i[l++]=o.$id}i[e]=n,c++},t.createFilter=function(t){t.$id=o,t.$obj=new Module.WasmNode(o,6),r[o]=t,o++,i[l++]=0,i[l++]=t.$id,i[l++]=6,c++},t.setFilterPadding=function(t,e,r,n,a){i[l++]=136,i[l++]=t,i[l++]=e,i[l++]=r,i[l++]=n,i[l++]=a,c++},t.prototype.setMask=function(t){i[l++]=131,i[l++]=this.id,i[l++]=t,c++},t.setValuesToBitmapData=function(t){var r=t.bitmapData;r.$bitmapDataId||(r.$bitmapDataId=a,e[a]=r,a++),t.$textureId||(t.$textureId=a,i[l++]=0,i[l++]=a,i[l++]=2,c++,i[l++]=122,i[l++]=t.$textureId,i[l++]=t.$bitmapX,i[l++]=t.$bitmapY,i[l++]=t.$bitmapWidth,i[l++]=t.$bitmapHeight,i[l++]=t.$offsetX,i[l++]=t.$offsetY,i[l++]=t.$getTextureWidth(),i[l++]=t.$getTextureHeight(),i[l++]=t.$sourceWidth,i[l++]=t.$sourceHeight,i[l++]=t.$rotated?1:0,c++,i[l++]=123,i[l++]=t.$textureId,i[l++]=r.$bitmapDataId,c++,a++)},t.setValuesToRenderBuffer=function(t){var r;return t.rootRenderTarget?r=t.rootRenderTarget.texture:t.texture?r=t.texture:(r={},t.texture=r),r.$bitmapDataId||(r.isTexture=!0,r.$bitmapDataId=a,e[a]=r,i[l++]=0,i[l++]=r.$bitmapDataId,i[l++]=2,c++,i[l++]=123,i[l++]=r.$bitmapDataId,i[l++]=r.$bitmapDataId,c++,a++,t.bufferIdForWasm=a),r.$bitmapDataId},t.prototype.setBitmapData=function(r){if(!r)return i[l++]=121,i[l++]=this.id,i[l++]=-1,void c++;if(r.$renderBuffer){var n=void 0;n=r.$renderBuffer.rootRenderTarget?r.$renderBuffer.rootRenderTarget.texture:r.$renderBuffer.texture?r.$renderBuffer.texture:r.$renderBuffer.surface,n.$bitmapDataId||(n.isTexture=!0,n.$bitmapDataId=a,e[a]=n,i[l++]=0,i[l++]=n.$bitmapDataId,i[l++]=2,c++,i[l++]=123,i[l++]=n.$bitmapDataId,i[l++]=n.$bitmapDataId,c++,a++),i[l++]=122,i[l++]=n.$bitmapDataId,i[l++]=r.$bitmapX,i[l++]=r.$bitmapY,i[l++]=r.$bitmapWidth,i[l++]=r.$bitmapHeight,i[l++]=r.$offsetY,i[l++]=r.$offsetX,i[l++]=r.textureHeight,i[l++]=r.textureWidth,i[l++]=r.$sourceWidth,i[l++]=r.$sourceHeight,i[l++]=r.$rotated?1:0,c++,i[l++]=121,i[l++]=this.id,i[l++]=n.$bitmapDataId,c++}else t.setValuesToBitmapData(r),i[l++]=121,i[l++]=this.id,i[l++]=r.$textureId,c++},t.prototype.setBitmapDataToMesh=function(e){return e?(t.setValuesToBitmapData(e),i[l++]=147,i[l++]=this.id,i[l++]=e.$textureId,void c++):(i[l++]=147,i[l++]=this.id,i[l++]=-1,void c++)},t.prototype.setBitmapDataToParticle=function(e){t.setValuesToBitmapData(e),i[l++]=902,i[l++]=this.id,i[l++]=e.$textureId,c++},t.prototype.setStopToParticle=function(t){i[l++]=903,i[l++]=this.id,i[l++]=t?1:0,c++},t.prototype.setCustomData=function(t){i[l++]=901,i[l++]=this.id;t.length;i[l++]=t.length;for(var e=0;e<t.length;e++)i[l++]=t[e];c++},t.prototype.setWidth=function(t){i[l++]=114,i[l++]=this.id,i[l++]=t,c++},t.prototype.setHeight=function(t){i[l++]=115,i[l++]=this.id,i[l++]=t,c++},t.prototype.setCacheAsBitmap=function(t){i[l++]=135,i[l++]=this.id,i[l++]=t?1:0,c++},t.prototype.setScale9Grid=function(t,e,r,n){i[l++]=124,i[l++]=this.id,i[l++]=t,i[l++]=e,i[l++]=r,i[l++]=n,c++},t.prototype.setMatrix=function(t,e,r,n,a,o){i[l++]=125,i[l++]=this.id,i[l++]=t,i[l++]=e,i[l++]=r,i[l++]=n,i[l++]=a,i[l++]=o,c++},t.prototype.setIsTyping=function(t){i[l++]=137,i[l++]=this.id,i[l++]=t?1:0,c++},t.prototype.setTextRect=function(t,e,r,n){i[l++]=138,i[l++]=this.id,i[l++]=t,i[l++]=e,i[l++]=r,i[l++]=n,c++},t.prototype.setGraphicsRect=function(t,e,r,n,a){a?i[l++]=143:i[l++]=139,i[l++]=this.id,i[l++]=t,i[l++]=e,i[l++]=r,i[l++]=n,c++},t.prototype.setGraphicsRenderData=function(t){i[l++]=1003,i[l++]=this.id;var e=t.length;i[l++]=e;for(var r=0;e>r;r++)i[l++]=t[r];c++},t.prototype.setDataToBitmapNode=function(e,r,n){t.setValuesToBitmapData(r),i[l++]=1001,i[l++]=e,i[l++]=r.$bitmapData.$bitmapDataId;var a=n.length;i[l++]=a/10;for(var o=0;a>o;o++)i[l++]=n[o];c++},t.prototype.setDataToMesh=function(t,e,r){i[l++]=144,i[l++]=this.id;var n=t.length;i[l++]=n;for(var a=0;n>a;a++)i[l++]=t[a];i[l++]=146,i[l++]=this.id,n=e.length,i[l++]=n;for(var a=0;n>a;a++)i[l++]=e[a];i[l++]=145,i[l++]=this.id,n=r.length,i[l++]=n;for(var a=0;n>a;a++)i[l++]=r[a];c+=3},t.setDataToFilter=function(t){if(u!==!1){var e,n=r[t],a=[];h[n.$id]||(h[n.$id]=[]);var o=h[n.$id],d="",p="";"custom"==n.type?(d=n.$vertexSrc,p=n.$fragmentSrc,e=4):"colorTransform"==n.type?e=1:"blur"==n.type?e=2:"glow"==n.type&&(e=3);var f="",g=0,v=n.$uniforms;for(var y in v)f+=y,f+=" ",o[g]=y,g++;s[n.$id]={vertexSrc:d,fragmentSrc:p,uniformsSrc:f};for(var $=0;$<o.length;$++){var b=v[o[$]],m=typeof b;if("number"==m)a.push(1),a.push(b);else if(b instanceof Array){a.push(b.length);for(var x=0;x<b.length;x++)a.push(b[x])}else if("object"==m){a.push(1);var T=1;null!==b.x&&void 0!==b.x&&(T++,a.push(b.x)),null!==b.y&&void 0!==b.y&&(T++,a.push(b.y)),null!==b.z&&void 0!==b.z&&(T++,a.push(b.z)),null!==b.w&&void 0!==b.w&&(T++,a.push(b.w)),a[a.length-T]=T-1}}i[l++]=1004,i[l++]=t,i[l++]=e;var _=a.length;i[l++]=_;for(var $=0;_>$;$++)i[l++]=a[$];c++}},t.prototype.setDataToTextField=function(t,e){i[l++]=1002,i[l++]=t;var r=e.length;i[l++]=r;for(var n=0;r>n;n++)i[l++]=e[n];c++},t.prototype.disposeDisplayObject=function(){i[l++]=140,i[l++]=this.id,c++},t.disposeTexture=function(t){i[l++]=141,i[l++]=t.$textureId,c++},t.disposeBitmapData=function(t){t.$bitmapDataId&&delete e[t.$bitmapDataId]},t.disposeTextData=function(t){i[l++]=149,i[l++]=t.$nativeNode.id,c++},t.disposeGraphicData=function(t){i[l++]=148,i[l++]=t.$targetDisplay.$nativeNode.id,c++},t.disposeFilter=function(t){i[l++]=142,i[l++]=t.$id,c++,delete r[t.$id];var e=t;e.blurXFilter&&delete r[e.blurXFilter.$id],e.blurYFilter&&delete r[e.blurYFilter.$id]},t}();t.NativeNode=d,__reflect(d.prototype,"egret.NativeNode")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r){var i=t.call(this,e)||this;return i.firstCharHeight=0,"string"==typeof r?i.charList=i.parseConfig(r):r&&r.hasOwnProperty("frames")?i.charList=r.frames:i.charList={},i}return __extends(e,t),e.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var r=this.charList[t];if(!r)return null;e=this.createTexture(t,r.x,r.y,r.w,r.h,r.offX,r.offY,r.sourceW,r.sourceH),this._textureMap[t]=e}return e},e.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},e.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var r=e.sourceH;if(void 0===r){var i=e.h;void 0===i&&(i=0);var n=e.offY;void 0===n&&(n=0),r=i+n}if(0>=r)continue;this.firstCharHeight=r;break}}return this.firstCharHeight},e.prototype.parseConfig=function(t){t=t.split("\r\n").join("\n");for(var e=t.split("\n"),r=this.getConfigByKey(e[3],"count"),i={},n=4;4+r>n;n++){var a=e[n],o=String.fromCharCode(this.getConfigByKey(a,"id")),s={};i[o]=s,s.x=this.getConfigByKey(a,"x"),s.y=this.getConfigByKey(a,"y"),s.w=this.getConfigByKey(a,"width"),s.h=this.getConfigByKey(a,"height"),s.offX=this.getConfigByKey(a,"xoffset"),s.offY=this.getConfigByKey(a,"yoffset"),s.xadvance=this.getConfigByKey(a,"xadvance")}return i},e.prototype.getConfigByKey=function(t,e){for(var r=t.split(" "),i=0,n=r.length;n>i;i++){var a=r[i];if(e==a.substring(0,e.length)){var o=a.substring(e.length+1);return parseInt(o)}}return 0},e}(t.SpriteSheet);t.BitmapFont=e,__reflect(e.prototype,"egret.BitmapFont")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$smoothing=t.Bitmap.defaultSmoothing,r.$text="",r.$textFieldWidth=0/0,r.$textLinesChanged=!1,r.$textFieldHeight=0/0,r.$font=null,r.$fontStringChanged=!1,r.$lineSpacing=0,r.$letterSpacing=0,r.$textAlign=t.HorizontalAlign.LEFT,r.$verticalAlign=t.VerticalAlign.TOP,r.$textWidth=0/0,r.$textHeight=0/0,r.$textOffsetX=0,r.$textOffsetY=0,r.$textStartX=0,r.$textStartY=0,r.$lineHeights=[],__global.nativeRender||(r.$renderNode=new t.sys.BitmapNode),r}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(11)},Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){var e=this;t!=e.$smoothing&&(e.$smoothing=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"text",{get:function(){return this.$text},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),r.prototype.$setText=function(t){null==t&&(t="");var e=this;return t==e.$text?!1:(e.$text=t,e.$invalidateContentBounds(),!0)},r.prototype.$getWidth=function(){var t=this,e=t.$textFieldWidth;return isNaN(e)?t.$getContentBounds().width:e},r.prototype.$setWidth=function(t){var e=this;return 0>t||t==e.$textFieldWidth?!1:(e.$textFieldWidth=t,e.$invalidateContentBounds(),!0)},r.prototype.$invalidateContentBounds=function(){this.$renderDirty=!0,this.$textLinesChanged=!0,this.$updateRenderNode()},r.prototype.$getHeight=function(){var t=this,e=t.$textFieldHeight;return isNaN(e)?t.$getContentBounds().height:e},r.prototype.$setHeight=function(t){var e=this;return 0>t||t==e.$textFieldHeight?!1:(e.$textFieldHeight=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"font",{get:function(){return this.$font},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),r.prototype.$setFont=function(t){var e=this;return e.$font==t?!1:(e.$font=t,e.$fontStringChanged=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"lineSpacing",{get:function(){return this.$lineSpacing},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),r.prototype.$setLineSpacing=function(t){var e=this;return e.$lineSpacing==t?!1:(e.$lineSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"letterSpacing",{get:function(){return this.$letterSpacing},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),r.prototype.$setLetterSpacing=function(t){var e=this;return e.$letterSpacing==t?!1:(e.$letterSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),r.prototype.$setTextAlign=function(t){var e=this;return e.$textAlign==t?!1:(e.$textAlign=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),r.prototype.$setVerticalAlign=function(t){var e=this;return e.$verticalAlign==t?!1:(e.$verticalAlign=t,e.$invalidateContentBounds(),!0)},r.prototype.$updateRenderNode=function(){var e=this,i=this.$getTextLines(),n=i.length;if(0!=n){var a,o=[],s=this.$textLinesWidth,h=e.$font;__global.nativeRender||(a=this.$renderNode,h.$texture&&(a.image=h.$texture.$bitmapData),a.smoothing=e.$smoothing);for(var l=h._getFirstCharHeight(),c=Math.ceil(l*r.EMPTY_FACTOR),u=!isNaN(e.$textFieldHeight),d=e.$textWidth,p=e.$textFieldWidth,f=e.$textFieldHeight,g=e.$textAlign,v=this.$textOffsetY+this.$textStartY,y=this.$lineHeights,$=0;n>$;$++){var b=y[$];if(u&&$>0&&v+b>f)break;var m=i[$],x=m.length,T=this.$textOffsetX;if(g!=t.HorizontalAlign.LEFT){var _=p>d?p:d;g==t.HorizontalAlign.RIGHT?T+=_-s[$]:g==t.HorizontalAlign.CENTER&&(T+=Math.floor((_-s[$])/2))}for(var w=0;x>w;w++){var E=m.charAt(w),S=h.getTexture(E);if(S){var C=S.$bitmapWidth,D=S.$bitmapHeight;__global.nativeRender?o.push(S.$bitmapX,S.$bitmapY,C,D,T+S.$offsetX,v+S.$offsetY,S.$getScaleBitmapWidth(),S.$getScaleBitmapHeight(),S.$sourceWidth,S.$sourceHeight):(a.imageWidth=S.$sourceWidth,a.imageHeight=S.$sourceHeight,a.drawImage(S.$bitmapX,S.$bitmapY,C,D,T+S.$offsetX,v+S.$offsetY,S.$getScaleBitmapWidth(),S.$getScaleBitmapHeight())),T+=(h.getConfig(E,"xadvance")||S.$getTextureWidth())+e.$letterSpacing}else" "==E?T+=c:t.$warn(1046,E)}v+=b+e.$lineSpacing}if(__global.nativeRender){e.$nativeNode.setDataToBitmapNode(e.$nativeNode.id,h.$texture,o);var R=e.$getContentBounds();e.$nativeNode.setWidth(R.width),e.$nativeNode.setHeight(R.height)}}},r.prototype.$measureContentBounds=function(t){var e=this.$getTextLines();0==e.length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$textWidth-this.$textOffsetX,this.$textHeight-this.$textOffsetY)},Object.defineProperty(r.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$textHeight},enumerable:!0,configurable:!0}),r.prototype.$getTextLines=function(){function e(t){return b&&n.length>0&&f>b?!1:(f+=l+u,s||h||(c-=d),n.push(t),o.push(l),a.push(c),p=Math.max(c,p),!0)}var i=this;if(!i.$textLinesChanged)return i.textLines;var n=[];i.textLines=n;var a=[];i.$textLinesWidth=a,i.$textLinesChanged=!1;var o=[];if(i.$lineHeights=o,!i.$text||!i.$font)return n;for(var s,h,l,c,u=i.$lineSpacing,d=i.$letterSpacing,p=0,f=0,g=0,v=0,y=!isNaN(i.$textFieldWidth),$=i.$textFieldWidth,b=i.$textFieldHeight,m=i.$font,x=m._getFirstCharHeight(),T=Math.ceil(x*r.EMPTY_FACTOR),_=i.$text,w=_.split(/(?:\r\n|\r|\n)/),E=w.length,S=!0,C=0;E>C;C++){var D=w[C],R=D.length;l=0,c=0,s=!0,h=!1;for(var O=0;R>O;O++){s||(c+=d);var L=D.charAt(O),A=void 0,M=void 0,B=0,F=0,P=m.getTexture(L);if(P)A=P.$getTextureWidth(),M=P.$getTextureHeight(),B=P.$offsetX,F=P.$offsetY;else{if(" "!=L){t.$warn(1046,L),s&&(s=!1);continue}A=T,M=x}if(s&&(s=!1,g=Math.min(B,g)),S&&(S=!1,v=Math.min(F,v)),y&&O>0&&c+A>$){if(!e(D.substring(0,O)))break;D=D.substring(O),R=D.length,O=0,c=O==R-1?A:m.getConfig(L,"xadvance")||A,l=M}else c+=O==R-1?A:m.getConfig(L,"xadvance")||A,l=Math.max(M,l)}if(b&&C>0&&f>b)break;if(h=!0,!e(D))break}f-=u,i.$textWidth=p,i.$textHeight=f,this.$textOffsetX=g,this.$textOffsetY=v,this.$textStartX=0,this.$textStartY=0;var N;return $>p&&(N=i.$textAlign,N==t.HorizontalAlign.RIGHT?this.$textStartX=$-p:N==t.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor(($-p)/2))),b>f&&(N=i.$verticalAlign,N==t.VerticalAlign.BOTTOM?this.$textStartY=b-f:N==t.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((b-f)/2))),n},r.EMPTY_FACTOR=.33,r}(t.DisplayObject);t.BitmapText=e,__reflect(e.prototype,"egret.BitmapText")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.HorizontalAlign=e,__reflect(e.prototype,"egret.HorizontalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}return e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var r=this.replaceArr[e][0],i=this.replaceArr[e][1];t=t.replace(r,i)}return t},e.prototype.parse=function(e){this.stackArray=[],this.resutlArr=[];for(var r=0,i=e.length;i>r;){var n=e.indexOf("<",r);if(0>n)this.addToResultArr(e.substring(r)),r=i;else{this.addToResultArr(e.substring(r,n));var a=e.indexOf(">",n);-1==a?(t.$error(1038),a=n):"/"==e.charAt(n+1)?this.stackArray.pop():this.addToArray(e.substring(n+1,a)),r=a+1}}return this.resutlArr},e.prototype.parser=function(t){return this.parse(t)},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),this.stackArray.length>0?this.resutlArr.push({text:t,style:this.stackArray[this.stackArray.length-1]}):this.resutlArr.push({text:t}))},e.prototype.changeStringToObject=function(t){t=t.trim();var e={},r=[];if("i"==t.charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(e,t,"true");else if(r=t.match(/^(font|a)\s/)){t=t.substring(r[0].length).trim();for(var i=0,n=void 0;n=t.match(this.getHeadReg());){var a=n[0],o="";t=t.substring(a.length).trim(),'"'==t.charAt(0)?(i=t.indexOf('"',1),o=t.substring(1,i),i+=1):"'"==t.charAt(0)?(i=t.indexOf("'",1),o=t.substring(1,i),i+=1):(o=t.match(/(\S)+/)[0],i=o.length),this.addProperty(e,a.substring(0,a.length-1).trim(),o.trim()),t=t.substring(i).trim()}}return e},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,r){switch(e.toLowerCase()){case"color":case"textcolor":r=r.replace(/#/,"0x"),t.textColor=parseInt(r);break;case"strokecolor":r=r.replace(/#/,"0x"),t.strokeColor=parseInt(r);break;case"stroke":t.stroke=parseInt(r);break;case"b":case"bold":t.bold="true"==r;break;case"u":t.underline="true"==r;break;case"i":case"italic":t.italic="true"==r;break;case"size":t.size=parseInt(r);break;case"fontfamily":t.fontFamily=r;break;case"href":t.href=this.replaceSpecial(r);break;case"target":t.target=this.replaceSpecial(r)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var r=this.stackArray[this.stackArray.length-1];for(var i in r)null==e[i]&&(e[i]=r[i]);this.stackArray.push(e)}},e}();t.HtmlTextParser=e,__reflect(e.prototype,"egret.HtmlTextParser")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}return __extends(r,e),r.prototype.init=function(e){this._text=e,this.stageText=new t.StageText,this.stageText.$setTextField(this._text)},r.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},r.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)},r.prototype._getText=function(){return this.stageText.$getText()},r.prototype._setText=function(t){this.stageText.$setText(t)},r.prototype._setColor=function(t){this.stageText.$setColor(t)},r.prototype.focusHandler=function(e){this._isFocus||(this._isFocus=!0,e.showing||(this._text.$isTyping=!0,this._text.$invalidateTextField()),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_IN,!0)))},r.prototype.blurHandler=function(e){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$isTyping=!1,this._text.$invalidateTextField(),this.stageText.$onBlur(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_OUT,!0)))},r.prototype.onMouseDownHandler=function(t){this.$onFocus()},r.prototype.$onFocus=function(){var e=this;this._text.visible&&(this._isFocus||(this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),t.callLater(function(){e.tempStage.addEventListener(t.TouchEvent.TOUCH_BEGIN,e.onStageDownHandler,e)},this),this.stageText.$show()))},r.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},r.prototype.updateTextHandler=function(e){var r,i,n=this._text.$TextField,a=this.stageText.$getText(),o=!1;null!=n[35]&&(r=new RegExp("["+n[35]+"]","g"),i=a.match(r),a=i?i.join(""):"",o=!0),null!=n[36]&&(r=new RegExp("[^"+n[36]+"]","g"),i=a.match(r),a=i?i.join(""):"",o=!0),o&&this.stageText.$getText()!=a&&this.stageText.$setText(a),this.resetText(),this._text.dispatchEvent(new t.Event(t.Event.CHANGE,!0))},r.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},r.prototype._hideInput=function(){this.stageText.$removeFromStage()},r.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},r.prototype._updateProperties=function(){if(this._isFocus)return this.stageText.$resetStageText(),void this.updateInput();var t=this._text.$stage;if(null==t);else for(var e=this._text,r=e.$visible;;){if(!r)break;if(e=e.parent,e==t)break;r=e.$visible}this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),this.updateInput()},r}(t.HashObject);t.InputController=e,__reflect(e.prototype,"egret.InputController")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.MotionEvent=e,__reflect(e.prototype,"egret.MotionEvent")}(egret||(egret={}));var egret;!function(t){function e(e,r,n){n=n||{};var a=null==n.italic?r[16]:n.italic,o=null==n.bold?r[15]:n.bold,s=null==n.size?r[0]:n.size,h=n.fontFamily||r[8]||i.default_fontFamily;return t.sys.measureText(e,h,s,o,a)}var r=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![。，！、》…）)}”】\\.\\,\\!\\?\\]\\:])"),i=function(i){function n(){var e=i.call(this)||this;e.$inputEnabled=!1,e.inputUtils=null,e.$graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1;var r=new t.sys.TextNode;return r.fontFamily=n.default_fontFamily,e.textNode=r,e.$renderNode=r,e.$TextField={0:n.default_size,1:0,2:n.default_textColor,3:0/0,4:0/0,5:0,6:0,7:0,8:n.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT},e}return __extends(n,i),n.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(7)},n.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},n.prototype.$setTouchEnabled=function(t){i.prototype.$setTouchEnabled.call(this,t),this.isInput()&&(this.$inputEnabled=!0)},Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),n.prototype.$setFontFamily=function(t){var e=this.$TextField;return e[8]==t?!1:(e[8]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),n.prototype.$setSize=function(t){var e=this.$TextField;return e[0]==t?!1:(e[0]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),n.prototype.$setBold=function(t){var e=this.$TextField;return t==e[15]?!1:(e[15]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),n.prototype.$setItalic=function(t){var e=this.$TextField;return t==e[16]?!1:(e[16]=t,this.invalidateFontString(),!0)},n.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextAlign=function(t){var e=this.$TextField;return e[9]==t?!1:(e[9]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setVerticalAlign=function(t){var e=this.$TextField;return e[10]==t?!1:(e[10]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),n.prototype.$setLineSpacing=function(t){var e=this.$TextField;return e[1]==t?!1:(e[1]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextColor=function(t){var e=this.$TextField;return e[2]==t?!1:(e[2]=t,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),n.prototype.$setWordWrap=function(t){var e=this.$TextField;t!=e[19]&&(e[20]||(e[19]=t,this.$invalidateTextField()))},Object.defineProperty(n.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),n.prototype.$setType=function(e){var r=this.$TextField;return r[24]!=e?(r[24]=e,e==t.TextFieldType.INPUT?(isNaN(r[3])&&this.$setWidth(100),isNaN(r[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0):!1},Object.defineProperty(n.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(t){this.$TextField[37]=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),n.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},n.prototype.$setBaseText=function(t){null==t&&(t=""),this.isFlow=!1;var e=this.$TextField;if(e[13]!=t){this.$invalidateTextField(),e[13]=t;var r="";return r=e[20]?this.changeToPassText(t):t,this.setMiddleStyle([{text:r}]),!0}return!1},n.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),n.prototype.$setDisplayAsPassword=function(t){var e=this.$TextField;if(e[20]!=t){e[20]=t,this.$invalidateTextField();var r="";return r=t?this.changeToPassText(e[13]):e[13],this.setMiddleStyle([{text:r}]),!0}return!1},Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setStrokeColor=function(e){var r=this.$TextField;return r[25]!=e?(this.$invalidateTextField(),r[25]=e,r[26]=t.toColorString(e),!0):!1},Object.defineProperty(n.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),n.prototype.$setStroke=function(t){return this.$TextField[27]!=t?(this.$invalidateTextField(),this.$TextField[27]=t,!0):!1},Object.defineProperty(n.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),n.prototype.$setMaxChars=function(t){return this.$TextField[21]!=t?(this.$TextField[21]=t,!0):!1},Object.defineProperty(n.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(t){this.$TextField[28]=Math.max(t,1),this.$invalidateTextField()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),n.prototype.$setSelection=function(t,e){return!1},n.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(n.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),n.prototype.$setMultiline=function(t){return this.$TextField[30]=t,this.$invalidateTextField(),!0},Object.defineProperty(n.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var r=-1;r<t.length&&(r=t.indexOf("^",r),0!=r)&&r>0&&"\\"==t.charAt(r-1);)r++;0==r?(e[35]=null,e[36]=t.substring(r+1)):r>0?(e[35]=t.substring(0,r),e[36]=t.substring(r+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),n.prototype.$setWidth=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[3]))return!1;e[3]=0/0}else{if(e[3]==t)return!1;e[3]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),!0)},n.prototype.$setHeight=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[4]))return!1;e[4]=0/0}else{if(e[4]==t)return!1;e[4]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),!0)},n.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},n.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(n.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorder=function(t){this.$TextField[31]=!!t},Object.defineProperty(n.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorderColor=function(t){this.$TextField[32]=+t||0},Object.defineProperty(n.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackground=function(t){this.$TextField[33]=t},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackgroundColor=function(t){this.$TextField[34]=t},n.prototype.fillBackground=function(e){var r=this.$graphicsNode;
r&&r.clear();var i=this.$TextField;if(i[33]||i[31]||e&&e.length>0){if(!r)if(r=this.$graphicsNode=new t.sys.GraphicsNode,__global.nativeRender)this.$renderNode=this.textNode;else{var n=new t.sys.GroupNode;n.addNode(r),n.addNode(this.textNode),this.$renderNode=n}var a=void 0,o=void 0;if(i[33]&&(a=r.beginFill(i[34]),a.drawRect(0,0,this.$getWidth(),this.$getHeight())),i[31]&&(o=r.lineStyle(1,i[32]),o.drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1)),e&&e.length>0)for(var s=i[2],h=-1,l=e.length,c=0;l>c;c+=4){var u=e[c],d=e[c+1],p=e[c+2],f=e[c+3]||s;(0>h||h!=f)&&(h=f,o=r.lineStyle(2,f,1,t.CapsStyle.NONE)),o.moveTo(u,d),o.lineTo(u+p,d)}}if(r){var g=this.$getRenderBounds();r.x=g.x,r.y=g.y,r.width=g.width,r.height=g.height,t.Rectangle.release(g)}},n.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus()},n.prototype.$onRemoveFromStage=function(){i.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&(this.textNode.clean(),__global.nativeRender&&t.NativeNode.disposeTextData(this))},n.prototype.$onAddToStage=function(e,r){i.prototype.$onAddToStage.call(this,e,r),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},n.prototype.$invalidateTextField=function(){var e=this;if(e.$renderDirty=!0,e.$TextField[18]=!0,__global.nativeRender)t.NativeDelegate.dirtyTextField(this);else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},n.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),r=t.Rectangle.create();r.copyFrom(e),this.$TextField[31]&&(r.width+=2,r.height+=2);var i=2*this.$TextField[27];return i>0&&(r.width+=2*i,r.height+=2*i),r.x-=i+2,r.y-=i+2,r.width=Math.ceil(r.width)+4,r.height=Math.ceil(r.height)+4,r},n.prototype.$measureContentBounds=function(e){this.$getLinesArr();var r=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],i=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4];e.setTo(0,0,r,i)},n.prototype.$updateRenderNode=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.$graphicsNode;return void(e&&e.clear())}var r=this.drawText();this.fillBackground(r);var i=this.$getRenderBounds(),n=this.textNode;n.x=i.x,n.y=i.y,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),t.Rectangle.release(i)},Object.defineProperty(n.prototype,"textFlow",{get:function(){return this.textArr},set:function(t){this.isFlow=!0;var e="";null==t&&(t=[]);for(var r=0;r<t.length;r++){var i=t[r];e+=i.text}this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.setMiddleStyle(t))},enumerable:!0,configurable:!0}),n.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",r=0,i=t.length;i>r;r++)switch(t.charAt(r)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},n.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.$getLinesArr(),this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),n.prototype.appendText=function(t){this.appendElement({text:t})},n.prototype.appendElement=function(t){var e=this.$TextField[13]+t.text;this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.textArr.push(t),this.setMiddleStyle(this.textArr))},n.prototype.$getLinesArr=function(){var i=this.$TextField;if(!i[18])return this.linesArr;i[18]=!1;var n=this.textArr;this.linesArr.length=0,i[6]=0,i[5]=0;var a=i[3];if(!isNaN(a)&&0==a)return i[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var o,s=this.linesArr,h=0,l=0,c=0,u=0,d=0,p=n.length;p>d;d++){var f=n[d];if(f.text){f.style=f.style||{};for(var g=f.text.toString(),v=g.split(/(?:\r\n|\r|\n)/),y=0,$=v.length;$>y;y++){null==s[u]&&(o={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},s[u]=o,h=0,c=0,l=0),c=i[24]==t.TextFieldType.INPUT?i[0]:Math.max(c,f.style.size||i[0]);var b=!0;if(""==v[y])y==$-1&&(b=!1);else{var m=e(v[y],i,f.style);if(isNaN(a))h+=m,l+=v[y].length,o.elements.push({width:m,text:v[y],style:f.style}),y==$-1&&(b=!1);else if(a>=h+m)o.elements.push({width:m,text:v[y],style:f.style}),h+=m,l+=v[y].length,y==$-1&&(b=!1);else{var x=0,T=0,_=v[y],w=void 0;w=i[19]?_.split(r):_.match(/./g);for(var E=w.length,S=0;E>x;x++){var C=w[x].length,D=!1;if(1==C&&E-1>x){var R=w[x].charCodeAt(0),O=w[x+1].charCodeAt(0);if(R>=55296&&56319>=R&&56320==(64512&O)){var L=w[x]+w[x+1];C=2,D=!0,m=e(L,i,f.style)}else m=e(w[x],i,f.style)}else m=e(w[x],i,f.style);if(0!=h&&h+m>a&&h+x!=0)break;if(T+m>a)for(var A=w[x].match(/./g),M=0,B=A.length;B>M;M++){var C=A[M].length,F=!1;if(1==C&&B-1>M){var R=A[M].charCodeAt(0),O=A[M+1].charCodeAt(0);if(R>=55296&&56319>=R&&56320==(64512&O)){var L=A[M]+A[M+1];C=2,F=!0,m=e(L,i,f.style)}else m=e(A[M],i,f.style)}else m=e(A[M],i,f.style);if(M>0&&h+m>a)break;S+=C,T+=m,h+=m,l+=S,F&&M++}else S+=C,T+=m,h+=m,l+=S;D&&x++}if(x>0){o.elements.push({width:T,text:_.substring(0,S),style:f.style});var P=_.substring(S),N=void 0,I=P.length;for(N=0;I>N&&" "==P.charAt(N);N++);v[y]=P.substring(N)}""!=v[y]&&(y--,b=!1)}}b&&(l++,o.hasNextLine=!0),y<v.length-1&&(o.width=h,o.height=c,o.charNum=l,i[5]=Math.max(i[5],h),i[6]+=c,u++)}d==n.length-1&&o&&(o.width=h,o.height=c,o.charNum=l,i[5]=Math.max(i[5],h),i[6]+=c)}else o&&(o.width=h,o.height=c,o.charNum=l,i[5]=Math.max(i[5],h),i[6]+=c)}return i[29]=s.length,s},n.prototype.drawText=function(){var e=this.textNode,r=this.$TextField;e.bold=r[15],e.fontFamily=r[8]||n.default_fontFamily,e.italic=r[16],e.size=r[0],e.stroke=r[27],e.strokeColor=r[25],e.textColor=r[2];var i=this.$getLinesArr();if(0==r[5])return[];var a=isNaN(r[3])?r[5]:r[3],o=t.TextFieldUtils.$getTextHeight(this),s=0,h=t.TextFieldUtils.$getStartLine(this),l=r[4];if(!isNaN(l)&&l>o){var c=t.TextFieldUtils.$getValign(this);s+=c*(l-o)}s=Math.round(s);for(var u=t.TextFieldUtils.$getHalign(this),d=0,p=[],f=h,g=r[29];g>f;f++){var v=i[f],y=v.height;if(s+=y/2,f!=h){if(r[24]==t.TextFieldType.INPUT&&!r[30])break;if(!isNaN(l)&&s>l)break}d=Math.round((a-v.width)*u);for(var $=0,b=v.elements.length;b>$;$++){var m=v.elements[$],x=m.style.size||r[0];e.drawText(d,s+(y-x)/2,m.text,m.style),m.style.underline&&p.push(d,s+y/2,m.width,m.style.textColor),d+=m.width}s+=y/2+r[1]}return p},n.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.onTapHandler=function(e){if(this.$TextField[24]!=t.TextFieldType.INPUT){var r=t.TextFieldUtils.$getTextElement(this,e.localX,e.localY);if(null!=r){var i=r.style;if(i&&i.href)if(i.href.match(/^event:/)){var n=i.href.match(/^event:/)[0];t.TextEvent.dispatchTextEvent(this,t.TextEvent.LINK,i.href.substring(n.length))}else open(i.href,i.target||"_blank")}}},n.default_fontFamily="Arial",n.default_size=30,n.default_textColor=16777215,n}(t.DisplayObject);t.TextField=i,__reflect(i.prototype,"egret.TextField")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.TEL="tel",t.PASSWORD="password",t}();t.TextFieldInputType=e,__reflect(e.prototype,"egret.TextFieldInputType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.DYNAMIC="dynamic",t.INPUT="input",t}();t.TextFieldType=e,__reflect(e.prototype,"egret.TextFieldType")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.$getStartLine=function(t){var r=t.$TextField,i=e.$getTextHeight(t),n=0,a=r[4];return isNaN(a)||(a>i||i>a&&(n=Math.max(r[28]-1,0),n=Math.min(r[29]-1,n)),r[30]||(n=Math.max(r[28]-1,0),r[29]>0&&(n=Math.min(r[29]-1,n)))),n},e.$getHalign=function(e){var r=e.$getLinesArr(),i=0;return e.$TextField[9]==t.HorizontalAlign.CENTER?i=.5:e.$TextField[9]==t.HorizontalAlign.RIGHT&&(i=1),e.$TextField[24]==t.TextFieldType.INPUT&&!e.$TextField[30]&&r.length>1&&(i=0),i},e.$getTextHeight=function(e){var r=t.TextFieldType.INPUT!=e.$TextField[24]||e.$TextField[30]?e.$TextField[6]+(e.$TextField[29]-1)*e.$TextField[1]:e.$TextField[0];return r},e.$getValign=function(r){var i=e.$getTextHeight(r),n=r.$TextField[4];if(!isNaN(n)&&n>i){var a=0;return r.$TextField[10]==t.VerticalAlign.MIDDLE?a=.5:r.$TextField[10]==t.VerticalAlign.BOTTOM&&(a=1),a}return 0},e.$getTextElement=function(t,r,i){var n=e.$getHit(t,r,i),a=t.$getLinesArr();return n&&a[n.lineIndex]&&a[n.lineIndex].elements[n.textElementIndex]?a[n.lineIndex].elements[n.textElementIndex]:null},e.$getHit=function(t,r,i){var n=t.$getLinesArr();if(0==t.$TextField[3])return null;var a=0,o=e.$getTextHeight(t),s=0,h=t.$TextField[4];if(!isNaN(h)&&h>o){var l=e.$getValign(t);s=l*(h-o),0!=s&&(i-=s)}for(var c=e.$getStartLine(t),u=0,d=c;d<n.length;d++){var p=n[d];if(u+p.height>=i){i>u&&(a=d+1);break}if(u+=p.height,u+t.$TextField[1]>i)return null;u+=t.$TextField[1]}if(0==a)return null;var f=n[a-1],g=t.$TextField[3];isNaN(g)&&(g=t.textWidth);var v=e.$getHalign(t);r-=v*(g-f.width);for(var y=0,d=0;d<f.elements.length;d++){var $=f.elements[d];if(y+$.width<=r)y+=$.width;else if(r>y)return{lineIndex:a-1,textElementIndex:d}}return null},e.$getScrollNum=function(t){var e=1;if(t.$TextField[30]){var r=t.height,i=t.size,n=t.lineSpacing;e=Math.floor(r/(i+n));var a=r-(i+n)*e;a>i/2&&e++}return e},e}();t.TextFieldUtils=e,__reflect(e.prototype,"egret.TextFieldUtils")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.OrientationEvent=e,__reflect(e.prototype,"egret.OrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TOP="top",t.BOTTOM="bottom",t.MIDDLE="middle",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.VerticalAlign=e,__reflect(e.prototype,"egret.VerticalAlign")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t._isNeedShow=!1,t.inputElement=null,t.inputDiv=null,t._gscaleX=0,t._gscaleY=0,t.textValue="",t.colorValue=16777215,t._styleInfoes={},t}return __extends(i,r),i.prototype.$setTextField=function(t){return this.$textfield=t,!0},i.prototype.$addToStage=function(){this.htmlInput=t.web.$getTextAdapter(this.$textfield)},i.prototype._initElement=function(){var e=this.$textfield.localToGlobal(0,0),r=e.x,i=e.y,n=this.htmlInput.$scaleX,a=this.htmlInput.$scaleY;this.inputDiv.style.left=r*n+"px",this.inputDiv.style.top=i*a+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=i*a+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*a+"px"):(this.inputDiv.style.top=i*a+"px",this.inputElement.style.top="0px");for(var o=this.$textfield,s=1,h=1,l=0;o.parent;)s*=o.scaleX,h*=o.scaleY,l+=o.rotation,o=o.parent;var c=t.web.getPrefixStyleName("transform");this.inputDiv.style[c]="rotate("+l+"deg)",this._gscaleX=n*s,this._gscaleY=a*h},i.prototype.$show=function(){this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.$textfield.multiline?this.inputElement.type="text":this.inputElement.type=this.$textfield.inputType,this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement()},i.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},i.prototype.executeShow=function(){this.inputElement.value=this.$getText(),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},i.prototype.$hide=function(){this.htmlInput&&this.htmlInput.disconnectStageText(this)},i.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},i.prototype.$setText=function(t){return this.textValue=t,this.resetText(),!0},i.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},i.prototype.$setColor=function(t){return this.colorValue=t,this.resetColor(),!0},i.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",t.toColorString(this.colorValue))},i.prototype.$onBlur=function(){e.Html5Capatibility._System_OS==e.SystemOSType.WPHONE&&t.Event.dispatchEvent(this,"updateText",!1)},i.prototype._onInput=function(){var r=this;if(e.Html5Capatibility._System_OS==e.SystemOSType.WPHONE){var i=this.$textfield.$TextField;null==i[35]&&null==i[36]?(r.textValue=r.inputElement.value,t.Event.dispatchEvent(r,"updateText",!1)):window.setTimeout(function(){r.inputElement&&r.inputElement.selectionStart&&r.inputElement.selectionEnd&&r.inputElement.selectionStart==r.inputElement.selectionEnd&&(r.textValue=r.inputElement.value,t.Event.dispatchEvent(r,"updateText",!1))},0)}else window.setTimeout(function(){r.inputElement&&r.inputElement.selectionStart==r.inputElement.selectionEnd&&(r.textValue=r.inputElement.value,t.Event.dispatchEvent(r,"updateText",!1))},0)},i.prototype.setAreaHeight=function(){var e=this.$textfield;if(e.multiline){var r=t.TextFieldUtils.$getTextHeight(e);if(e.height<=e.size)this.setElementStyle("height",e.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",e.size*this._gscaleY+"px");else if(e.height<r)this.setElementStyle("height",e.height*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px");else{this.setElementStyle("height",(r+e.lineSpacing)*this._gscaleY+"px");var i=(e.height-r)*this._gscaleY,n=t.TextFieldUtils.$getValign(e),a=i*n,o=i-a;this.setElementStyle("padding",a+"px 0px "+o+"px 0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px")}}},i.prototype._onClickHandler=function(e){this._isNeedShow&&(e.stopImmediatePropagation(),this._isNeedShow=!1,this.executeShow(),this.dispatchEvent(new t.Event("focus")))},i.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new t.Event("blur"))},i.prototype.setElementStyle=function(t,e){this.inputElement&&this._styleInfoes[t]!=e&&(this.inputElement.style[t]=e)},i.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},i.prototype.$resetStageText=function(){if(this.inputElement){var e=this.$textfield;this.setElementStyle("fontFamily",e.fontFamily),this.setElementStyle("fontStyle",e.italic?"italic":"normal"),this.setElementStyle("fontWeight",e.bold?"bold":"normal"),this.setElementStyle("textAlign",e.textAlign),this.setElementStyle("fontSize",e.size*this._gscaleY+"px"),this.setElementStyle("color",t.toColorString(e.textColor));var r=void 0;if(e.stage?(r=e.localToGlobal(0,0).x,r=Math.min(e.width,e.stage.stageWidth-r)):r=e.width,this.setElementStyle("width",r*this._gscaleX+"px"),this.setElementStyle("verticalAlign",e.verticalAlign),e.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",e.size*this._gscaleY+"px"),e.height<e.size){this.setElementStyle("height",e.size*this._gscaleY+"px");var i=e.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+i+"px 0px")}else{this.setElementStyle("height",e.size*this._gscaleY+"px");var n=(e.height-e.size)*this._gscaleY,a=t.TextFieldUtils.$getValign(e),o=n*a,i=n-o;i<e.size/2*this._gscaleY&&(i=e.size/2*this._gscaleY),this.setElementStyle("padding",o+"px 0px "+i+"px 0px")}this.inputDiv.style.clip="rect(0px "+e.width*this._gscaleX+"px "+e.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=e.height*this._gscaleY+"px",this.inputDiv.style.width=r*this._gscaleX+"px"}},i}(t.EventDispatcher);e.HTML5StageText=r,__reflect(r.prototype,"egret.web.HTML5StageText",["egret.StageText"]),t.StageText=r}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var r=function(){function e(){this._needShow=!1,this.$scaleX=1,this.$scaleY=1}return e.prototype.isInputOn=function(){return null!=this._stageText},e.prototype.isCurrentStageText=function(t){return this._stageText==t},e.prototype.initValue=function(t){t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.border="none",t.style.padding="0"},e.prototype.$updateSize=function(){if(this.canvas){this.$scaleX=t.sys.DisplayList.$canvasScaleX,this.$scaleY=t.sys.DisplayList.$canvasScaleY,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var e=t.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[e]=this.canvas.style[e],this.StageDelegateDiv.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},e.prototype._initStageDelegateDiv=function(e,r){this.canvas=r;var i,n=this;i||(i=document.createElement("div"),this.StageDelegateDiv=i,i.id="StageDelegateDiv",e.appendChild(i),n.initValue(i),n._inputDIV=document.createElement("div"),n.initValue(n._inputDIV),n._inputDIV.style.width="0px",n._inputDIV.style.height="0px",n._inputDIV.style.left="0px",n._inputDIV.style.top="-100px",n._inputDIV.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",i.appendChild(n._inputDIV),this.canvas.addEventListener("click",function(t){n._needShow?(n._needShow=!1,n._stageText._onClickHandler(t),n.show()):n._inputElement&&(n.clearInputElement(),n._inputElement.blur(),n._inputElement=null)}),n.initInputElement(!0),n.initInputElement(!1))},e.prototype.initInputElement=function(t){var e,r=this;t?(e=document.createElement("textarea"),e.style.resize="none",r._multiElement=e,e.id="egretTextarea"):(e=document.createElement("input"),r._simpleElement=e,e.id="egretInput"),e.type="text",r._inputDIV.appendChild(e),e.setAttribute("tabindex","-1"),e.style.width="1px",e.style.height="12px",r.initValue(e),e.style.outline="thin",e.style.background="none",e.style.overflow="hidden",e.style.wordBreak="break-all",e.style.opacity=0,e.oninput=function(){r._stageText&&r._stageText._onInput()}},e.prototype.show=function(){var e=this,r=e._inputElement;t.$callAsync(function(){r.style.opacity=1},e)},e.prototype.disconnectStageText=function(t){(null==this._stageText||this._stageText==t)&&(this.clearInputElement(),this._inputElement&&this._inputElement.blur())},e.prototype.clearInputElement=function(){var t=this;if(t._inputElement){t._inputElement.value="",t._inputElement.onblur=null,t._inputElement.style.width="1px",t._inputElement.style.height="12px",t._inputElement.style.left="0px",t._inputElement.style.top="0px",t._inputElement.style.opacity=0;var e=void 0;e=t._simpleElement==t._inputElement?t._multiElement:t._simpleElement,e.style.display="block",t._inputDIV.style.left="0px",t._inputDIV.style.top="-100px",t._inputDIV.style.height="0px",t._inputDIV.style.width="0px"}t._stageText&&(t._stageText._onDisconnect(),t._stageText=null,this.canvas.userTyping=!1)},e.prototype.getInputElement=function(t){var e=this;e.clearInputElement(),e._stageText=t,this.canvas.userTyping=!0,e._stageText.$textfield.multiline?e._inputElement=e._multiElement:e._inputElement=e._simpleElement;var r;return r=e._simpleElement==e._inputElement?e._multiElement:e._simpleElement,r.style.display="none",e._inputElement},e}();e.HTMLInput=r,__reflect(r.prototype,"egret.web.HTMLInput")}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=t.stage?t.stage.$hashCode:0,r=i[e],o=n[e],s=a[e];return o&&s&&(delete n[e],delete a[e]),r}function r(t,e,r,o){t._initStageDelegateDiv(r,o),i[e.$hashCode]=t,n[e.$hashCode]=o,a[e.$hashCode]=r}var i={},n={},a={};t.$getTextAdapter=e,t.$cacheTextAdapter=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t,e,r,a,o){n||i();var s="";return o&&(s+="italic "),a&&(s+="bold "),s+=(r||12)+"px ",s+=e||"Arial",n.font=s,n.measureText(t).width}function i(){n=t.sys.canvasHitTestBuffer.context,n.textAlign="left",n.textBaseline="middle"}var n=null;t.sys.measureText=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.encode=function(t){for(var e=new Uint8Array(t),r=e.length,i="",n=0;r>n;n+=3)i+=chars[e[n]>>2],i+=chars[(3&e[n])<<4|e[n+1]>>4],i+=chars[(15&e[n+1])<<2|e[n+2]>>6],i+=chars[63&e[n+2]];return r%3===2?i=i.substring(0,i.length-1)+"=":r%3===1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(t){var e=.75*t.length,r=t.length,i=0,n=0,a=0,o=0,s=0;"="===t[t.length-1]&&(e--,"="===t[t.length-2]&&e--);for(var h=new ArrayBuffer(e),l=new Uint8Array(h),c=0;r>c;c+=4)n=lookup[t.charCodeAt(c)],a=lookup[t.charCodeAt(c+1)],o=lookup[t.charCodeAt(c+2)],s=lookup[t.charCodeAt(c+3)],l[i++]=n<<2|a>>4,l[i++]=(15&a)<<4|o>>2,l[i++]=(3&o)<<6|63&s;return h},t}();t.Base64Util=e,__reflect(e.prototype,"egret.Base64Util")}(egret||(egret={}));for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var egret;!function(t){var e=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=e,__reflect(e.prototype,"egret.Endian");var r=function(){function r(t,r){void 0===r&&(r=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,0>r&&(r=0),this.bufferExtSize=r;var i,n=0;if(t){var a=void 0;if(t instanceof Uint8Array?(a=t,n=t.length):(n=t.byteLength,a=new Uint8Array(t)),0==r)i=new Uint8Array(n);else{var o=(n/r|0)+1;i=new Uint8Array(o*r)}i.set(a)}else i=new Uint8Array(r);this.write_position=n,this._position=0,this._bytes=i,this.data=new DataView(i.buffer),this.endian=e.BIG_ENDIAN}return Object.defineProperty(r.prototype,"endian",{get:function(){return 0==this.$endian?e.LITTLE_ENDIAN:e.BIG_ENDIAN},set:function(t){this.$endian=t==e.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),r.prototype.setArrayBuffer=function(t){},Object.defineProperty(r.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,r=t.byteLength,i=new Uint8Array(t),n=this.bufferExtSize;if(0==n)e=new Uint8Array(r);else{var a=(r/n|0)+1;e=new Uint8Array(a*n)}e.set(i),this.write_position=r,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),r.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,r=void 0;if(0==e)r=new Uint8Array(t);else{var i=((t/e>>0)+1)*e;r=new Uint8Array(i)}r.set(this._bytes),this._bytes=r,this.data=new DataView(r.buffer)}},Object.defineProperty(r.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),r.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},r.prototype.readBoolean=function(){return this.validate(1)?!!this._bytes[this.position++]:void 0},r.prototype.readByte=function(){return this.validate(1)?this.data.getInt8(this.position++):void 0},r.prototype.readBytes=function(e,r,i){if(void 0===r&&(r=0),void 0===i&&(i=0),e){var n=this._position,a=this.write_position-n;if(0>a)return void t.$error(1025);if(0==i)i=a;else if(i>a)return void t.$error(1025);e.validateBuffer(r+i),e._bytes.set(this._bytes.subarray(n,n+i),r),this.position+=i}},r.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},r.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},r.prototype.readUnsignedByte=function(){return this.validate(1)?this._bytes[this.position++]:void 0},r.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},r.prototype.readUTF=function(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""},r.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,r=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(r)}},r.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},r.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},r.prototype.writeBytes=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=0);var i;0>e||0>r||(i=0==r?t.length-e:Math.min(t.length-e,r),i>0&&(this.validateBuffer(i),this._bytes.set(t._bytes.subarray(e,e+i),this._position),this.position=this._position+i))},r.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},r.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},r.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},r.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),r=e.length;this.validateBuffer(2+r),this.data.setUint16(this._position,r,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},r.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},r.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},r.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0);var r=this._position,i=r+t.length;e&&this.validateBuffer(i),this.bytes.set(t,r),this.position=i},r.prototype.validate=function(e){var r=this._bytes.length;return r>0&&this._position+e<=r?!0:void t.$error(1025)},r.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},r.prototype.encodeUTF8=function(t){for(var e=0,r=this.stringToCodePoints(t),i=[];r.length>e;){var n=r[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))i.push(n);else{var a=void 0,o=void 0;for(this.inRange(n,128,2047)?(a=1,o=192):this.inRange(n,2048,65535)?(a=2,o=224):this.inRange(n,65536,1114111)&&(a=3,o=240),i.push(this.div(n,Math.pow(64,a))+o);a>0;){var s=this.div(n,Math.pow(64,a-1));i.push(128+s%64),a-=1}}}return new Uint8Array(i)},r.prototype.decodeUTF8=function(t){for(var e,r=!1,i=0,n="",a=0,o=0,s=0,h=0;t.length>i;){var l=t[i++];if(l==this.EOF_byte)e=0!=o?this.decoderError(r):this.EOF_code_point;else if(0==o)this.inRange(l,0,127)?e=l:(this.inRange(l,194,223)?(o=1,h=128,a=l-192):this.inRange(l,224,239)?(o=2,h=2048,a=l-224):this.inRange(l,240,244)?(o=3,h=65536,a=l-240):this.decoderError(r),a*=Math.pow(64,o),e=null);else if(this.inRange(l,128,191))if(s+=1,a+=(l-128)*Math.pow(64,o-s),s!==o)e=null;else{var c=a,u=h;a=0,o=0,s=0,h=0,e=this.inRange(c,u,1114111)&&!this.inRange(c,55296,57343)?c:this.decoderError(r,l)}else a=0,o=0,s=0,h=0,i--,e=this.decoderError(r,l);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},r.prototype.encoderError=function(e){t.$error(1026,e)},r.prototype.decoderError=function(e,r){return e&&t.$error(1027),r||65533},r.prototype.inRange=function(t,e,r){return t>=e&&r>=t},r.prototype.div=function(t,e){return Math.floor(t/e)},r.prototype.stringToCodePoints=function(t){for(var e=[],r=0,i=t.length;r<t.length;){var n=t.charCodeAt(r);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(r==i-1)e.push(65533);else{var a=t.charCodeAt(r+1);if(this.inRange(a,56320,57343)){var o=1023&n,s=1023&a;r+=1,e.push(65536+(o<<10)+s)}else e.push(65533)}else e.push(n);r+=1}return e},r}();t.ByteArray=r,__reflect(r.prototype,"egret.ByteArray")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n,a){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===a&&(a=0);var o=e.call(this,t,r,i)||this;return o.bytesLoaded=0,o.bytesTotal=0,o.bytesLoaded=n,o.bytesTotal=a,o}return __extends(r,e),r.dispatchProgressEvent=function(e,i,n,a){void 0===n&&(n=0),void 0===a&&(a=0);var o=t.Event.create(r,i);o.bytesLoaded=n,o.bytesTotal=a;var s=e.dispatchEvent(o);return t.Event.release(o),s},r.PROGRESS="progress",r.SOCKET_DATA="socketData",r}(t.Event);t.ProgressEvent=e,__reflect(e.prototype,"egret.ProgressEvent")}(egret||(egret={}));var egret;!function(t){function e(e,r){t.useFontMapping=!0,t.fontMapping[e]=r}t.fontMapping={},t.useFontMapping=!1,t.registerFontMapping=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),e.call(this,t,r,i)||this}return __extends(r,e),r.dispatchStageOrientationEvent=function(e,i){var n=t.Event.create(r,i),a=e.dispatchEvent(n);return t.Event.release(n),a},r.ORIENTATION_CHANGE="orientationChange",r}(t.Event);t.StageOrientationEvent=e,__reflect(e.prototype,"egret.StageOrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n="");var a=e.call(this,t,r,i)||this;return a.text=n,a}return __extends(r,e),r.dispatchTextEvent=function(e,i,n){var a=t.Event.create(r,i);a.text=n;var o=e.dispatchEvent(a);return t.Event.release(a),o},r.LINK="link",r}(t.Event);t.TextEvent=e,__reflect(e.prototype,"egret.TextEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return e.call(this,t,r,i)||this}return __extends(r,e),r.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},r.dispatchTimerEvent=function(e,i,n,a){var o=t.Event.create(r,i,n,a),s=e.dispatchEvent(o);
return t.Event.release(o),s},r.TIMER="timer",r.TIMER_COMPLETE="timerComplete",r}(t.Event);t.TimerEvent=e,__reflect(e.prototype,"egret.TimerEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){var r=Math.floor(e),i=r+1,n=t.sinInt(r);if(r==e)return n;var a=t.sinInt(i);return(e-r)*a+(i-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),egret_sin_map[t]},t.cos=function(e){var r=Math.floor(e),i=r+1,n=t.cosInt(r);if(r==e)return n;var a=t.cosInt(i);return(e-r)*a+(i-e)*n},t.cosInt=function(t){return t%=360,0>t&&(t+=360),egret_cos_map[t]},t}();t.NumberUtils=e,__reflect(e.prototype,"egret.NumberUtils")}(egret||(egret={}));for(var egret_sin_map={},egret_cos_map={},DEG_TO_RAD=Math.PI/180,NumberUtils_i=0;360>NumberUtils_i;NumberUtils_i++)egret_sin_map[NumberUtils_i]=Math.sin(NumberUtils_i*DEG_TO_RAD),egret_cos_map[NumberUtils_i]=Math.cos(NumberUtils_i*DEG_TO_RAD);egret_sin_map[90]=1,egret_cos_map[90]=0,egret_sin_map[180]=0,egret_cos_map[180]=-1,egret_sin_map[270]=-1,egret_cos_map[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&egret.$error(1029);var e=Array.prototype.slice.call(arguments,1),r=this,i=function(){},n=function(){return r.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,n.prototype=new i,n});var egret;!function(t){var e=function(e){function r(t,r){void 0===r&&(r=0);var i=e.call(this)||this;return i._delay=0,i._currentCount=0,i._running=!1,i.updateInterval=1e3,i.lastCount=1e3,i.lastTimeStamp=0,i.delay=t,i.repeatCount=0|+r,i}return __extends(r,e),Object.defineProperty(r.prototype,"delay",{get:function(){return this._delay},set:function(t){1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),r.prototype.reset=function(){this.stop(),this._currentCount=0},r.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=t.getTimer(),t.ticker.$startTick(this.$update,this),this._running=!0)},r.prototype.stop=function(){this._running&&(t.stopTick(this.$update,this),this._running=!1)},r.prototype.$update=function(e){var r=e-this.lastTimeStamp;if(r>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=e,this._currentCount++;var i=this.repeatCount>0&&this._currentCount>=this.repeatCount;return t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER),i&&(this.stop(),t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER_COMPLETE)),!1},r}(t.EventDispatcher);t.Timer=e,__reflect(e.prototype,"egret.Timer")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}var r=function(r){function i(){var e=r.call(this)||this;return e.lastX=0,e.lastY=0,e.fillPath=null,e.strokePath=null,e.topLeftStrokeWidth=0,e.bottomRightStrokeWidth=0,e.minX=1/0,e.minY=1/0,e.maxX=-(1/0),e.maxY=-(1/0),e.includeLastPosition=!0,e.$renderNode=new t.sys.GraphicsNode,e}return __extends(i,r),i.prototype.$setTarget=function(e){this.$targetDisplay&&(this.$targetDisplay.$renderNode=null),e.$renderNode=this.$renderNode,this.$targetDisplay=e,this.$targetIsSprite=e instanceof t.Sprite},i.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},i.prototype.beginFill=function(t,e){void 0===e&&(e=1),t=+t||0,e=+e||0,this.fillPath=this.$renderNode.beginFill(t,e,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},i.prototype.beginGradientFill=function(t,e,r,i,n){void 0===n&&(n=null),this.fillPath=this.$renderNode.beginGradientFill(t,e,r,i,n,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},i.prototype.endFill=function(){this.fillPath=null},i.prototype.lineStyle=function(t,e,r,i,n,a,o,s,h){void 0===t&&(t=0/0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=!1),void 0===n&&(n="normal"),void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=3),t=+t||0,0>=t?(this.strokePath=null,this.setStrokeWidth(0)):(e=+e||0,r=+r||0,s=+s||0,this.setStrokeWidth(t),this.strokePath=this.$renderNode.lineStyle(t,e,r,a,o,s),h&&this.strokePath.setLineDash(h),this.$renderNode.drawData.length>1&&this.strokePath.moveTo(this.lastX,this.lastY))},i.prototype.drawRect=function(t,e,r,i){t=+t||0,e=+e||0,r=+r||0,i=+i||0;var n=this.fillPath,a=this.strokePath;n&&n.drawRect(t,e,r,i),a&&a.drawRect(t,e,r,i),this.extendBoundsByPoint(t+r,e+i),this.updatePosition(t,e),this.dirty()},i.prototype.drawRoundRect=function(t,e,r,i,n,a){t=+t||0,e=+e||0,r=+r||0,i=+i||0,n=+n||0,a=+a||0;var o=this.fillPath,s=this.strokePath;o&&o.drawRoundRect(t,e,r,i,n,a),s&&s.drawRoundRect(t,e,r,i,n,a);var h=.5*n|0,l=a?.5*a|0:h,c=t+r,u=e+i,d=u-l;this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(c,u),this.updatePosition(c,d),this.dirty()},i.prototype.drawCircle=function(t,e,r){t=+t||0,e=+e||0,r=+r||0;var i=this.fillPath,n=this.strokePath;i&&i.drawCircle(t,e,r),n&&n.drawCircle(t,e,r),this.extendBoundsByPoint(t-r-1,e-r-1),this.extendBoundsByPoint(t+r+2,e+r+2),this.updatePosition(t+r,e),this.dirty()},i.prototype.drawEllipse=function(t,e,r,i){t=+t||0,e=+e||0,r=+r||0,i=+i||0;var n=this.fillPath,a=this.strokePath;n&&n.drawEllipse(t,e,r,i),a&&a.drawEllipse(t,e,r,i),this.extendBoundsByPoint(t-1,e-1),this.extendBoundsByPoint(t+r+2,e+i+2),this.updatePosition(t+r,e+.5*i),this.dirty()},i.prototype.moveTo=function(t,e){t=+t||0,e=+e||0;var r=this.fillPath,i=this.strokePath;r&&r.moveTo(t,e),i&&i.moveTo(t,e),this.includeLastPosition=!1,this.lastX=t,this.lastY=e,this.dirty()},i.prototype.lineTo=function(t,e){t=+t||0,e=+e||0;var r=this.fillPath,i=this.strokePath;r&&r.lineTo(t,e),i&&i.lineTo(t,e),this.updatePosition(t,e),this.dirty()},i.prototype.curveTo=function(t,e,r,i){t=+t||0,e=+e||0,r=+r||0,i=+i||0;var n=this.fillPath,a=this.strokePath;n&&n.curveTo(t,e,r,i),a&&a.curveTo(t,e,r,i),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(r,i),this.updatePosition(r,i),this.dirty()},i.prototype.cubicCurveTo=function(t,e,r,i,n,a){t=+t||0,e=+e||0,r=+r||0,i=+i||0,n=+n||0,a=+a||0;var o=this.fillPath,s=this.strokePath;o&&o.cubicCurveTo(t,e,r,i,n,a),s&&s.cubicCurveTo(t,e,r,i,n,a),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(r,i),this.extendBoundsByPoint(n,a),this.updatePosition(n,a),this.dirty()},i.prototype.drawArc=function(t,r,i,n,a,o){if(!(0>i||n===a)){t=+t||0,r=+r||0,i=+i||0,n=+n||0,a=+a||0,o=!!o,n=e(n),a=e(a);var s=this.fillPath,h=this.strokePath;s&&(s.$lastX=this.lastX,s.$lastY=this.lastY,s.drawArc(t,r,i,n,a,o)),h&&(h.$lastX=this.lastX,h.$lastY=this.lastY,h.drawArc(t,r,i,n,a,o)),o?this.arcBounds(t,r,i,a,n):this.arcBounds(t,r,i,n,a);var l=t+Math.cos(a)*i,c=r+Math.sin(a)*i;this.updatePosition(l,c),this.dirty()}},i.prototype.dirty=function(){var e=this;e.$renderNode.dirtyRender=!0,__global.nativeRender&&t.NativeDelegate.dirtyGraphics(e)},i.prototype.arcBounds=function(t,e,r,i,n){var a=Math.PI;if(Math.abs(i-n)<.01)return this.extendBoundsByPoint(t-r,e-r),void this.extendBoundsByPoint(t+r,e+r);i>n&&(n+=2*a);for(var o=Math.cos(i)*r,s=Math.cos(n)*r,h=Math.min(o,s),l=Math.max(o,s),c=Math.sin(i)*r,u=Math.sin(n)*r,d=Math.min(c,u),p=Math.max(c,u),f=i/(.5*a),g=n/(.5*a),v=Math.ceil(f);g>=v;v++)switch(v%4){case 0:l=r;break;case 1:p=r;break;case 2:h=-r;break;case 3:d=-r}h=Math.floor(h),d=Math.floor(d),l=Math.ceil(l),p=Math.ceil(p),this.extendBoundsByPoint(h+t,d+e),this.extendBoundsByPoint(l+t,p+e)},i.prototype.clear=function(){this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0),this.dirty()},i.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},i.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},i.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},i.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX,t.y=this.minY,t.width=Math.ceil(this.maxX-this.minX),t.height=Math.ceil(this.maxY-this.minY)},i.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e)},i.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},i.prototype.$hitTest=function(e,r){var i=this.$targetDisplay,n=i.$getInvertedConcatenatedMatrix(),a=n.a*e+n.c*r+n.tx,o=n.b*e+n.d*r+n.ty,s=t.sys.canvasHitTestBuffer;s.resize(3,3);var h=this.$renderNode,l=t.Matrix.create();l.identity(),l.translate(1-a,1-o),t.sys.canvasRenderer.drawNodeToBuffer(h,s,l,!0),t.Matrix.release(l);try{var c=s.getPixels(1,1);if(0===c[3])return null}catch(u){throw new Error(t.sys.tr(1039))}return i},i.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean(),__global.nativeRender&&t.NativeNode.disposeGraphicData(this)},i}(t.HashObject);t.Graphics=r,__reflect(r.prototype,"egret.Graphics")}(egret||(egret={}));var egret;!function(t){function e(e,r){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t.$callLaterFunctionList.push(e),t.$callLaterThisList.push(r),t.$callLaterArgsList.push(i)}function r(e,r){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t.$callAsyncFunctionList.push(e),t.$callAsyncThisList.push(r),t.$callAsyncArgsList.push(i)}t.$callLaterFunctionList=[],t.$callLaterThisList=[],t.$callLaterArgsList=[],t.callLater=e,t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[],t.$callAsync=r}(egret||(egret={}));var egret;!function(t){function e(t,e,r){for(var i=[],n=3;n<arguments.length;n++)i[n-3]=arguments[n];var a,o=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}}),a=t.__sets__;var s=a[r];if(s)return s.apply(e,i);var h=Object.getPrototypeOf(o);if(null!=h){for(;!h.hasOwnProperty(r);)if(h=Object.getPrototypeOf(h),null==h)return;s=Object.getOwnPropertyDescriptor(h,r).set,a[r]=s,s.apply(e,i)}}function r(t,e,r){var i,n=t.prototype;t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}}),i=t.__gets__;var a=i[r];if(a)return a.call(e);var o=Object.getPrototypeOf(n);if(null!=o){for(;!o.hasOwnProperty(r);)if(o=Object.getPrototypeOf(o),null==o)return;return a=Object.getOwnPropertyDescriptor(o,r).get,i[r]=a,a.call(e)}}t.superSetter=e,t.superGetter=r}(egret||(egret={}));var egret;!function(t){function e(t){if(!t)return null;var e=r[t];if(e)return e;var i=t.split("."),n=i.length;e=global;for(var a=0;n>a;a++){var o=i[a];if(e=e[o],!e)return null}return r[t]=e,e}var r={};t.getDefinitionByName=e}(egret||(egret={}));var egret;!function(t){var e=new t.Point,r=function(r){function i(t,e,i,n,a,o){var s=r.call(this,t,e,i)||this;return s.targetChanged=!0,s.touchDown=!1,s.$initTo(n,a,o),s}return __extends(i,r),i.prototype.$initTo=function(t,e,r){this.touchPointID=+r||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(i.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),i.prototype.getLocalXY=function(){this.targetChanged=!1;var t=this.$target.$getInvertedConcatenatedMatrix();t.transformPoint(this.$stageX,this.$stageY,e),this._localX=e.x,this._localY=e.y},i.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},i.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},i.dispatchTouchEvent=function(e,r,n,a,o,s,h,l){if(void 0===l&&(l=!1),!n&&!e.hasEventListener(r))return!0;var c=t.Event.create(i,r,n,a);c.$initTo(o,s,h),c.touchDown=l;var u=e.dispatchEvent(c);return t.Event.release(c),u},i.TOUCH_MOVE="touchMove",i.TOUCH_BEGIN="touchBegin",i.TOUCH_END="touchEnd",i.TOUCH_CANCEL="touchCancel",i.TOUCH_TAP="touchTap",i.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",i}(t.Event);t.TouchEvent=r,__reflect(r.prototype,"egret.TouchEvent")}(egret||(egret={}));var egret;!function(t){function e(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var r=t.prototype?t.prototype:Object.getPrototypeOf(t);if(r.hasOwnProperty("__class__"))return r.__class__;var i=r.constructor.toString().trim(),n=i.indexOf("("),a=i.substring(9,n);return Object.defineProperty(r,"__class__",{value:a,enumerable:!1,writable:!0}),a}t.getQualifiedClassName=e}(egret||(egret={}));var egret;!function(t){function e(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var r=e.prototype?e.prototype:Object.getPrototypeOf(e),i=Object.getPrototypeOf(r);if(!i)return null;var n=t.getQualifiedClassName(i.constructor);return n?n:null}t.getQualifiedSuperclassName=e}(egret||(egret={}));var egret;!function(t){function e(){return Date.now()-t.sys.$START_TIME}t.getTimer=e}(egret||(egret={}));var egret;!function(t){function e(e){var r=t.getDefinitionByName(e);return r?!0:!1}t.hasDefinition=e}(egret||(egret={}));var egret;!function(t){function e(t,e){if(!t||"object"!=typeof t)return!1;var r=Object.getPrototypeOf(t),i=r?r.__types__:null;return i?-1!==i.indexOf(e):!1}t.is=e}(egret||(egret={}));var egret;!function(t){function e(e,r){t.ticker.$startTick(e,r)}t.startTick=e}(egret||(egret={}));var egret;!function(t){function e(e,r){t.ticker.$stopTick(e,r)}t.stopTick=e}(egret||(egret={}));var egret;!function(t){function e(t){0>t&&(t=0),t>16777215&&(t=16777215);for(var e=t.toString(16).toUpperCase();e.length>6;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e}t.toColorString=e}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){t.onStart(l),h=t}function i(){if(c)for(var t=document.querySelectorAll(".egret-player"),e=t.length,r=0;e>r;r++){var i=t[r],n=i["egret-player"];n.updateScreenSize()}}function n(r){if(!c){c=!0,r||(r={});var i=navigator.userAgent.toLowerCase();if(i.indexOf("egretnative")>=0&&__global.nativeRender)t.NativeDelegate.addModuleCallback(function(){if(e.Html5Capatibility.$init(),"webgl"==r.renderMode){var i=r.antialias;e.WebGLRenderContext.antialias=!!i}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,a(r.renderMode),t.NativeDelegate.setRenderMode(t.Capabilities.$renderMode);var n;n=r.canvasScaleFactor?r.canvasScaleFactor:r.calculateCanvasScaleFactor?r.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context):window.devicePixelRatio,t.sys.DisplayList.$canvasScaleFactor=n;var h=t.ticker;o(h),r.screenAdapter?t.sys.screenAdapter=r.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var l=document.querySelectorAll(".egret-player"),c=l.length,d=0;c>d;d++){var p=l[d],f=new e.WebPlayer(p,r);p["egret-player"]=f}window.addEventListener("resize",function(){isNaN(u)&&(u=window.setTimeout(s,300))})},null),t.NativeDelegate.init();else{if(e.Html5Capatibility._audioType=r.audioType,e.Html5Capatibility.$init(),"webgl"==r.renderMode){var n=r.antialias;e.WebGLRenderContext.antialias=!!n}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,a(r.renderMode);var h=void 0;if(r.canvasScaleFactor)h=r.canvasScaleFactor;else if(r.calculateCanvasScaleFactor)h=r.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context);else{var l=t.sys.canvasHitTestBuffer.context,d=l.backingStorePixelRatio||l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1;h=(window.devicePixelRatio||1)/d}t.sys.DisplayList.$canvasScaleFactor=h;var p=t.ticker;o(p),r.screenAdapter?t.sys.screenAdapter=r.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var f=document.querySelectorAll(".egret-player"),g=f.length,v=0;g>v;v++){var y=f[v],$=new e.WebPlayer(y,r);y["egret-player"]=$}window.addEventListener("resize",function(){isNaN(u)&&(u=window.setTimeout(s,300))})}}}function a(r){"webgl"==r&&t.WebGLUtils.checkCanUseWebGL()?(t.sys.RenderBuffer=e.WebGLRenderBuffer,t.sys.systemRenderer=new e.WebGLRenderer,t.sys.canvasRenderer=new t.CanvasRenderer,t.sys.customHitTestBuffer=new e.WebGLRenderBuffer(3,3),t.sys.canvasHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.Capabilities.$renderMode="webgl"):(t.sys.RenderBuffer=e.CanvasRenderBuffer,t.sys.systemRenderer=new t.CanvasRenderer,t.sys.canvasRenderer=t.sys.systemRenderer,t.sys.customHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.sys.canvasHitTestBuffer=t.sys.customHitTestBuffer,t.Capabilities.$renderMode="canvas")}function o(t){function e(){h&&h.onRender(l),t.update(),r(e)}var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;r||(r=function(t){return window.setTimeout(t,1e3/60)}),r(e)}function s(){u=0/0,t.updateAllScreens(),h&&h.onResize(l)}var h,l={setAutoClear:function(t){e.WebGLRenderBuffer.autoClear=t},save:function(){},restore:function(){var t=e.WebGLRenderContext.getInstance(0,0),r=t.context;r.bindBuffer(r.ARRAY_BUFFER,t.vertexBuffer),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer),r.activeTexture(r.TEXTURE0),t.currentProgram=null,t.bindIndices=!1;var i=t.$bufferStack[1];t.activateBuffer(i),r.enable(r.BLEND),t.setBlendMode("source-over")}};t.setRendererContext=r;var c=!1;window.isNaN=function(t){return t=+t,t!==t},t.runEgret=n,t.updateAllScreens=i;var u=0/0}(e=t.web||(t.web={}))}(egret||(egret={}));var language,egret;!function(t){var e;!function(e){function r(t,e){var r="";if(null!=e)r=i(t,e);else{if(null==s){var n=document.createElement("div").style;s=i("transform",n)}r=s}return""==r?t:r+t.charAt(0).toUpperCase()+t.substring(1,t.length)}function i(t,e){if(t in e)return"";t=t.charAt(0).toUpperCase()+t.substring(1,t.length);for(var r=["webkit","ms","Moz","O"],i=0;i<r.length;i++){var n=r[i]+t;if(n in e)return r[i]}return""}var n=function(){function t(){}return t.WEB_AUDIO=2,t.HTML5_AUDIO=3,t}();e.AudioType=n,__reflect(n.prototype,"egret.web.AudioType");var a=function(){function t(){}return t.WPHONE=1,t.IOS=2,t.ADNROID=3,t}();e.SystemOSType=a,__reflect(a.prototype,"egret.web.SystemOSType");var o=function(r){function i(){return r.call(this)||this}return __extends(i,r),i.$init=function(){var r=navigator.userAgent.toLowerCase();i.ua=r,t.Capabilities.$isMobile=-1!=r.indexOf("mobile")||-1!=r.indexOf("android"),i._canUseBlob=!1;var o=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(o)try{e.WebAudioDecode.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}catch(s){o=!1}var h,l=i._audioType;l==n.WEB_AUDIO&&o||l==n.HTML5_AUDIO?(h=!1,i.setAudioType(l)):(h=!0,i.setAudioType(n.HTML5_AUDIO)),r.indexOf("windows phone")>=0?(i._System_OS=a.WPHONE,t.Capabilities.$os="Windows Phone"):r.indexOf("android")>=0?(t.Capabilities.$os="Android",i._System_OS=a.ADNROID,h&&o&&i.setAudioType(n.WEB_AUDIO)):r.indexOf("iphone")>=0||r.indexOf("ipad")>=0||r.indexOf("ipod")>=0?(t.Capabilities.$os="iOS",i._System_OS=a.IOS,i.getIOSVersion()>=7&&(i._canUseBlob=!0,h&&o&&i.setAudioType(n.WEB_AUDIO))):-1!=r.indexOf("windows nt")?t.Capabilities.$os="Windows PC":-1!=r.indexOf("mac os")&&(t.Capabilities.$os="Mac OS");var c=window.URL||window.webkitURL;c||(i._canUseBlob=!1),r.indexOf("egretnative")>=0&&(i.setAudioType(n.HTML5_AUDIO),i._canUseBlob=!0),t.Sound=i._AudioClass},i.setAudioType=function(e){switch(i._audioType=e,e){case n.WEB_AUDIO:i._AudioClass=t.web.WebAudioSound;break;case n.HTML5_AUDIO:i._AudioClass=t.web.HtmlSound}},i.getIOSVersion=function(){var t=i.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/)[0];return parseInt(t.match(/\d+(_\d)*/)[0])||0},i.checkHtml5Support=function(){var e=(navigator.language||navigator.browserLanguage).toLowerCase(),r=e.split("-");r.length>1&&(r[1]=r[1].toUpperCase()),t.Capabilities.$language=r.join("-")},i._canUseBlob=!1,i._audioType=0,i._System_OS=0,i.ua="",i}(t.HashObject);e.Html5Capatibility=o,__reflect(o.prototype,"egret.web.Html5Capatibility");var s=null;e.getPrefixStyleName=r,e.getPrefix=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r="egret.BitmapData";t.registerClass(HTMLImageElement,r),t.registerClass(HTMLCanvasElement,r),t.registerClass(HTMLVideoElement,r)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){function e(e){return e.hashCode=e.$hashCode=t.$hashCount++,e}t.$toBitmapData=e}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function e(){}return e.detect=function(){var r=t.Capabilities,i=navigator.userAgent.toLowerCase();r.$isMobile=-1!=i.indexOf("mobile")||-1!=i.indexOf("android"),r.$isMobile?i.indexOf("windows")<0&&(-1!=i.indexOf("iphone")||-1!=i.indexOf("ipad")||-1!=i.indexOf("ipod"))?r.$os="iOS":-1!=i.indexOf("android")&&-1!=i.indexOf("linux")?r.$os="Android":-1!=i.indexOf("windows")&&(r.$os="Windows Phone"):-1!=i.indexOf("windows nt")?r.$os="Windows PC":-1!=i.indexOf("mac os")&&(r.$os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase(),a=n.split("-");a.length>1&&(a[1]=a[1].toUpperCase()),r.$language=a.join("-"),e.injectUIntFixOnIE9()},e.injectUIntFixOnIE9=function(){if(/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var t="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n<!-- convertResponseBodyToText -->\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n</script>\r\n";document.write(t)}},e}();e.WebCapability=r,__reflect(r.prototype,"egret.web.WebCapability"),r.detect()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i,n,a,o){var s=e.call(this)||this;if(s.showPanle=!0,s.fpsHeight=0,s.WIDTH=101,s.HEIGHT=20,s.bgCanvasColor="#18304b",s.fpsFrontColor="#18fefe",s.WIDTH_COST=50,s.cost1Color="#18fefe",s.cost3Color="#ff0000",s.arrFps=[],s.arrCost=[],s.arrLog=[],i||n){"canvas"==t.Capabilities.renderMode?s.renderMode="Canvas":s.renderMode="WebGL",s.panelX=void 0===o.x?0:parseInt(o.x),s.panelY=void 0===o.y?0:parseInt(o.y),s.fontColor=void 0===o.textColor?"#ffffff":o.textColor.replace("0x","#"),s.fontSize=void 0===o.size?12:parseInt(o.size),t.Capabilities.isMobile&&(s.fontSize-=2);var h=document.createElement("div");h.style.position="absolute",h.style.background="rgba(0,0,0,"+o.bgAlpha+")",h.style.left=s.panelX+"px",h.style.top=s.panelY+"px",h.style.pointerEvents="none",document.body.appendChild(h);var l=document.createElement("div");l.style.color=s.fontColor,l.style.fontSize=s.fontSize+"px",l.style.lineHeight=s.fontSize+"px",l.style.margin="4px 4px 4px 4px",s.container=l,h.appendChild(l),i&&s.addFps(),n&&s.addLog()}return s}return __extends(r,e),r.prototype.addFps=function(){var t=document.createElement("div");t.style.display="inline-block",this.containerFps=t,this.container.appendChild(t);var e=document.createElement("div");e.style.paddingBottom="2px",this.fps=e,this.containerFps.appendChild(e),e.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var r=document.createElement("canvas");this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,this.canvasFps=r;var i=r.getContext("2d");this.contextFps=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);var a=document.createElement("div");a.style["float"]="left",a.innerHTML="Draw<br/>Cost",n.appendChild(a);var o=document.createElement("div");o.style.paddingLeft=a.offsetWidth+20+"px",n.appendChild(o);var s=document.createElement("div");this.divDraw=s,s.innerHTML="0<br/>",o.appendChild(s);var h=document.createElement("div");this.divCost=h,h.innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',o.appendChild(h),r=document.createElement("canvas"),this.canvasCost=r,this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,i=r.getContext("2d"),this.contextCost=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT),i.fillStyle="#000000",i.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},r.prototype.addLog=function(){var t=document.createElement("div");t.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",t.style.wordWrap="break-word",this.log=t,this.container.appendChild(t)},r.prototype.update=function(t,e){void 0===e&&(e=!1);var r,i,n;e?(r=this.arrFps[this.arrFps.length-1],i=this.arrCost[this.arrCost.length-1][0],n=this.arrCost[this.arrCost.length-1][1]):(r=t.fps,i=t.costTicker,n=t.costRender,this.lastNumDraw=t.draw,this.arrFps.push(r),this.arrCost.push([i,n]));var a=0,o=this.arrFps.length;o>101&&(o=101,this.arrFps.shift(),this.arrCost.shift());for(var s=this.arrFps[0],h=this.arrFps[0],l=0;o>l;l++){var c=this.arrFps[l];a+=c,s>c?s=c:c>h&&(h=c)}var u=this.WIDTH,d=this.HEIGHT,p=this.contextFps;p.drawImage(this.canvasFps,1,0,u-1,d,0,0,u-1,d),p.fillStyle=this.bgCanvasColor,p.fillRect(u-1,0,1,d);var f=Math.floor(r/60*20);1>f&&(f=1),p.fillStyle=this.fpsFrontColor,p.fillRect(u-1,20-f,1,f);var g=this.WIDTH_COST;p=this.contextCost,p.drawImage(this.canvasCost,1,0,g-1,d,0,0,g-1,d),p.drawImage(this.canvasCost,g+2,0,g-1,d,g+1,0,g-1,d);var v=Math.floor(i/2);1>v?v=1:v>20&&(v=20);var y=Math.floor(n/2);1>y?y=1:y>20&&(y=20),p.fillStyle=this.bgCanvasColor,p.fillRect(g-1,0,1,d),p.fillRect(2*g,0,1,d),p.fillRect(3*g+1,0,1,d),p.fillStyle=this.cost1Color,p.fillRect(g-1,20-v,1,v),p.fillStyle=this.cost3Color,p.fillRect(2*g,20-y,1,y);var $=Math.floor(a/o),b=r+" FPS "+this.renderMode;this.showPanle&&(b+="<br/>min"+s+" max"+h+" avg"+$,this.divDraw.innerHTML=this.lastNumDraw+"<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+i+'<font/> <font  style="color:#ff0000">'+n+"<font/>"),this.fps.innerHTML=b},r.prototype.updateInfo=function(t){for(this.arrLog.push(t),this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},r}(t.DisplayObject);e.WebFps=r,__reflect(r.prototype,"egret.web.WebFps",["egret.FPSDisplay","egret.DisplayObject"]),t.FPSDisplay=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){if(window.location){var e=location.search;if(""==e)return"";e=e.slice(1);for(var r=e.split("&"),i=r.length,n=0;i>n;n++){var a=r[n],o=a.split("=");if(o[0]==t)return o[1]}}return""}e.getOption=r,t.getOption=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.WebLifeCycleHandler=function(t){var e=function(){document[r]?t.pause():t.resume()};window.addEventListener("focus",t.resume,!1),window.addEventListener("blur",t.pause,!1);var r,i;"undefined"!=typeof document.hidden?(r="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(r="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(r="msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(r="webkitHidden",i="webkitvisibilitychange"):"undefined"!=typeof document.oHidden&&(r="oHidden",i="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",t.resume,!1),window.addEventListener("pagehide",t.pause,!1)),r&&i&&document.addEventListener(i,e,!1);var n=navigator.userAgent,a=/micromessenger/gi.test(n),o=/mqq/gi.test(n),s=/mobile.*qq/gi.test(n);if((s||a)&&(o=!1),o){var h=window.browser||{};h.execWebFn=h.execWebFn||{},h.execWebFn.postX5GamePlayerMessage=function(e){var r=e.type;"app_enter_background"==r?t.pause():"app_enter_foreground"==r&&t.resume()},window.browser=h}}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(t,e){var i=r.call(this)||this;return i.init(t,e),i.initOrientation(),i}return __extends(i,r),i.prototype.init=function(r,i){var n=this.readOption(r,i),a=new t.Stage;a.$screen=this,a.$scaleMode=n.scaleMode,a.$orientation=n.orientation,a.$maxTouches=n.maxTouches,a.frameRate=n.frameRate,a.textureScaleFactor=n.textureScaleFactor;var o=new t.sys.RenderBuffer(void 0,void 0,!0),s=o.surface;this.attachCanvas(r,s);var h=new e.WebTouchHandler(a,s),l=new t.sys.Player(o,a,n.entryClassName);t.lifecycle.stage=a,t.lifecycle.addLifecycleListener(e.WebLifeCycleHandler);var c=new e.HTMLInput;(n.showFPS||n.showLog)&&(__global.nativeRender||l.displayFPS(n.showFPS,n.showLog,n.logFilter,n.fpsStyles)),this.playerOption=n,this.container=r,this.canvas=s,this.stage=a,this.player=l,this.webTouchHandler=h,this.webInput=c,t.web.$cacheTextAdapter(c,a,r,s),this.updateScreenSize(),this.updateMaxTouches(),l.start()},i.prototype.initOrientation=function(){var e=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){t.StageOrientationEvent.dispatchStageOrientationEvent(e.stage,t.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},i.prototype.readOption=function(e,r){var i={};i.entryClassName=e.getAttribute("data-entry-class"),i.scaleMode=e.getAttribute("data-scale-mode")||t.StageScaleMode.NO_SCALE,i.frameRate=+e.getAttribute("data-frame-rate")||30,i.contentWidth=+e.getAttribute("data-content-width")||480,i.contentHeight=+e.getAttribute("data-content-height")||800,i.orientation=e.getAttribute("data-orientation")||t.OrientationMode.AUTO,i.maxTouches=+e.getAttribute("data-multi-fingered")||2,i.textureScaleFactor=+e.getAttribute("texture-scale-factor")||1,i.showFPS="true"==e.getAttribute("data-show-fps");for(var n=e.getAttribute("data-show-fps-style")||"",a=n.split(","),o={},s=0;s<a.length;s++){var h=a[s].split(":");o[h[0]]=h[1]}return i.fpsStyles=o,i.showLog="true"==e.getAttribute("data-show-log"),i.logFilter=e.getAttribute("data-log-filter"),i},i.prototype.attachCanvas=function(t,e){var r=e.style;r.cursor="inherit",r.position="absolute",r.top="0",r.bottom="0",r.left="0",r.right="0",t.appendChild(e),r=t.style,r.overflow="hidden",r.position="absolute"},i.prototype.updateScreenSize=function(){var e=this.canvas;if(!e.userTyping){var r=this.playerOption,i=this.container.getBoundingClientRect(),n=0,a=i.width,o=i.height;
i.top<0&&(o+=i.top,n=-i.top);var s=!1,h=this.stage.$orientation;h!=t.OrientationMode.AUTO&&(s=h!=t.OrientationMode.PORTRAIT&&o>a||h==t.OrientationMode.PORTRAIT&&a>o);var l=s?o:a,c=s?a:o;t.Capabilities.$boundingClientWidth=l,t.Capabilities.$boundingClientHeight=c;var u=t.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,l,c,r.contentWidth,r.contentHeight),d=u.stageWidth,p=u.stageHeight,f=u.displayWidth,g=u.displayHeight;e.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",e.width!=d&&(e.width=d),e.height!=p&&(e.height=p);var v=0;s?h==t.OrientationMode.LANDSCAPE?(v=90,e.style.top=n+(o-f)/2+"px",e.style.left=(a+g)/2+"px"):(v=-90,e.style.top=n+(o+f)/2+"px",e.style.left=(a-g)/2+"px"):(e.style.top=n+(o-g)/2+"px",e.style.left=(a-f)/2+"px");var y=f/d,$=g/p,b=y*t.sys.DisplayList.$canvasScaleFactor,m=$*t.sys.DisplayList.$canvasScaleFactor;"canvas"==t.Capabilities.$renderMode&&(b=Math.ceil(b),m=Math.ceil(m));var x=new t.Matrix;x.scale(y/b,$/m),x.rotate(v*Math.PI/180);var T="matrix("+x.a+","+x.b+","+x.c+","+x.d+","+x.tx+","+x.ty+")";e.style[t.web.getPrefixStyleName("transform")]=T,t.sys.DisplayList.$setCanvasScale(b,m),this.webTouchHandler.updateScaleMode(y,$,v),this.webInput.$updateSize(),this.player.updateStageSize(d,p),__global.nativeRender&&(e.width=d*b,e.height=p*m)}},i.prototype.setContentSize=function(t,e){var r=this.playerOption;r.contentWidth=t,r.contentHeight=e,this.updateScreenSize()},i.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},i}(t.HashObject);e.WebPlayer=r,__reflect(r.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(e,r){s||(s=document.createElement("canvas"),h=s.getContext("2d"));var i=e.$getTextureWidth(),n=e.$getTextureHeight();null==r&&(r=t.$TempRectangle,r.x=0,r.y=0,r.width=i,r.height=n),r.x=Math.min(r.x,i-1),r.y=Math.min(r.y,n-1),r.width=Math.min(r.width,i-r.x),r.height=Math.min(r.height,n-r.y);var a=r.width,o=r.height,l=s;if(l.style.width=a+"px",l.style.height=o+"px",s.width=a,s.height=o,"webgl"==t.Capabilities.$renderMode){var c=void 0;e.$renderBuffer?c=e:(c=new t.RenderTexture,c.drawToTexture(new t.Bitmap(e)));for(var u=c.$renderBuffer.getPixels(r.x,r.y,a,o),d=new ImageData(a,o),p=0;p<u.length;p++)d.data[p]=u[p];return h.putImageData(d,0,0),e.$renderBuffer||c.dispose(),l}var f=e,g=Math.round(f.$offsetX),v=Math.round(f.$offsetY),y=f.$bitmapWidth,$=f.$bitmapHeight;return h.drawImage(f.$bitmapData.source,f.$bitmapX+r.x/t.$TextureScaleFactor,f.$bitmapY+r.y/t.$TextureScaleFactor,y*r.width/i,$*r.height/n,g,v,r.width,r.height),l}function i(e,i,n){try{var a=r(this,i),o=a.toDataURL(e,n);return o}catch(s){t.$error(1033)}return null}function n(t,e,r,n){var a=i.call(this,t,r,n);if(null!=a){var o=a.replace(/^data:image[^;]*/,"data:image/octet-stream"),s=document.createElement("a");s.download=e,s.href=o;var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(h)}}function a(e,r){return t.$warn(1041,"getPixel32","getPixels"),this.getPixels(e,r)}function o(e,i,n,a){void 0===n&&(n=1),void 0===a&&(a=1);try{var o=(r(this),h.getImageData(e,i,n,a).data);return o}catch(s){t.$error(1039)}}var s,h;t.Texture.prototype.toDataURL=i,t.Texture.prototype.saveToFile=n,t.Texture.prototype.getPixel32=a,t.Texture.prototype.getPixels=o}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i){var n=e.call(this)||this;return n.onTouchBegin=function(t){var e=n.getLocation(t);n.touch.onTouchBegin(e.x,e.y,t.identifier)},n.onTouchMove=function(t){var e=n.getLocation(t);n.touch.onTouchMove(e.x,e.y,t.identifier)},n.onTouchEnd=function(t){var e=n.getLocation(t);n.touch.onTouchEnd(e.x,e.y,t.identifier)},n.scaleX=1,n.scaleY=1,n.rotation=0,n.canvas=i,n.touch=new t.sys.TouchHandler(r),n.addListeners(),n}return __extends(r,e),r.prototype.addListeners=function(){var e=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(t){t.identifier=t.pointerId,e.onTouchBegin(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerMove",function(t){t.identifier=t.pointerId,e.onTouchMove(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerUp",function(t){t.identifier=t.pointerId,e.onTouchEnd(t),e.prevent(t)},!1)):(t.Capabilities.$isMobile||this.addMouseListener(),this.addTouchListener())},r.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onTouchMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},r.prototype.addTouchListener=function(){var t=this;this.canvas.addEventListener("touchstart",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchBegin(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchmove",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchMove(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchend",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchEnd(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchcancel",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchEnd(e.changedTouches[i]);t.prevent(e)},!1)},r.prototype.prevent=function(t){t.stopPropagation(),1==t.isScroll||this.canvas.userTyping||t.preventDefault()},r.prototype.getLocation=function(e){e.identifier=+e.identifier||0;var r=document.documentElement,i=this.canvas.getBoundingClientRect(),n=i.left+window.pageXOffset-r.clientLeft,a=i.top+window.pageYOffset-r.clientTop,o=e.pageX-n,s=o,h=e.pageY-a,l=h;return 90==this.rotation?(s=h,l=i.width-o):-90==this.rotation&&(s=i.height-h,l=o),s/=this.scaleX,l/=this.scaleY,t.$TempPoint.setTo(Math.round(s),Math.round(l))},r.prototype.updateScaleMode=function(t,e,r){this.scaleX=t,this.scaleY=e,this.rotation=r},r.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},r}(t.HashObject);e.WebTouchHandler=r,__reflect(r.prototype,"egret.web.WebTouchHandler")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){for(var e=s.parseFromString(t,"text/xml"),r=e.childNodes.length,n=0;r>n;n++){var a=e.childNodes[n];if(1==a.nodeType)return i(a,null)}return null}function i(t,e){if("parsererror"==t.localName)throw new Error(t.textContent);for(var r=new a(t.localName,e,t.prefix,t.namespaceURI,t.nodeName),n=t.attributes,s=r.attributes,h=n.length,l=0;h>l;l++){var c=n[l],u=c.name;0!=u.indexOf("xmlns:")&&(s[u]=c.value,r["$"+u]=c.value)}var d=t.childNodes;h=d.length;for(var p=r.children,l=0;h>l;l++){var f=d[l],g=f.nodeType,v=null;if(1==g)v=i(f,r);else if(3==g){var y=f.textContent.trim();y&&(v=new o(y,r))}v&&p.push(v)}return r}var n=function(){function t(t,e){this.nodeType=t,this.parent=e}return t}();e.XMLNode=n,__reflect(n.prototype,"egret.web.XMLNode");var a=function(t){function e(e,r,i,n,a){var o=t.call(this,1,r)||this;return o.attributes={},o.children=[],o.localName=e,o.prefix=i,o.namespace=n,o.name=a,o}return __extends(e,t),e}(n);e.XML=a,__reflect(a.prototype,"egret.web.XML");var o=function(t){function e(e,r){var i=t.call(this,3,r)||this;return i.text=e,i}return __extends(e,t),e}(n);e.XMLText=o,__reflect(o.prototype,"egret.web.XMLText");var s=new DOMParser;t.XML={parse:r}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e){var r=document.createElement("canvas");isNaN(t)||isNaN(e)||(r.width=t,r.height=e);var i=r.getContext("2d");if(void 0===i.imageSmoothingEnabled){for(var n,a=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],o=a.length-1;o>=0&&(n=a[o],void 0===i[n]);o--);try{Object.defineProperty(i,"imageSmoothingEnabled",{get:function(){return this[n]},set:function(t){this[n]=t}})}catch(s){i.imageSmoothingEnabled=i[n]}}return r}var r=function(){function t(t,r,i){this.surface=e(t,r),this.context=this.surface.getContext("2d"),this.context&&(this.context.$offsetX=0,this.context.$offsetY=0)}return Object.defineProperty(t.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e,r){var i=this.surface;if(r){var n=!1;i.width<t&&(i.width=t,n=!0),i.height<e&&(i.height=e,n=!0),n||(this.context.globalCompositeOperation="source-over",this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1)}else i.width!=t&&(i.width=t),i.height!=e&&(i.height=e);this.clear()},t.prototype.getPixels=function(t,e,r,i){return void 0===r&&(r=1),void 0===i&&(i=1),this.context.getImageData(t,e,r,i).data},t.prototype.toDataURL=function(t,e){return this.surface.toDataURL(t,e)},t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},t.prototype.destroy=function(){this.surface.width=this.surface.height=0},t}();t.CanvasRenderBuffer=r,__reflect(r.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e;!function(t){t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.FLOAT=5126]="FLOAT",t[t.BYTE=65535]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT"}(e=t.WEBGL_ATTRIBUTE_TYPE||(t.WEBGL_ATTRIBUTE_TYPE={}));var r=function(){function t(t,e,r){this.gl=t,this.name=r.name,this.type=r.type,this.size=r.size,this.location=t.getAttribLocation(e,this.name),this.count=0,this.initCount(t),this.format=t.FLOAT,this.initFormat(t)}return t.prototype.initCount=function(t){var r=this.type;switch(r){case e.FLOAT:case e.BYTE:case e.UNSIGNED_BYTE:case e.UNSIGNED_SHORT:this.count=1;break;case e.FLOAT_VEC2:this.count=2;break;case e.FLOAT_VEC3:this.count=3;break;case e.FLOAT_VEC4:this.count=4}},t.prototype.initFormat=function(t){var r=this.type;switch(r){case e.FLOAT:case e.FLOAT_VEC2:case e.FLOAT_VEC3:case e.FLOAT_VEC4:this.format=t.FLOAT;break;case e.UNSIGNED_BYTE:this.format=t.UNSIGNED_BYTE;break;case e.UNSIGNED_SHORT:this.format=t.UNSIGNED_SHORT;break;case e.BYTE:this.format=t.BYTE}},t}();t.EgretWebGLAttribute=r,__reflect(r.prototype,"egret.web.EgretWebGLAttribute")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e,r){var i=t.createShader(e);t.shaderSource(i,r),t.compileShader(i);var n=t.getShaderParameter(i,t.COMPILE_STATUS);return n||(console.log("shader not compiled!"),console.log(t.getShaderInfoLog(i))),i}function r(t,e,r){var i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,r),t.linkProgram(i),i}function i(e,r){for(var i={},n=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES),a=0;n>a;a++){var o=e.getActiveAttrib(r,a),s=o.name,h=new t.EgretWebGLAttribute(e,r,o);i[s]=h}return i}function n(e,r){for(var i={},n=e.getProgramParameter(r,e.ACTIVE_UNIFORMS),a=0;n>a;a++){var o=e.getActiveUniform(r,a),s=o.name,h=new t.EgretWebGLUniform(e,r,o);i[s]=h}return i}var a=function(){function t(t,a,o){this.vshaderSource=a,this.fshaderSource=o,this.vertexShader=e(t,t.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=e(t,t.FRAGMENT_SHADER,this.fshaderSource),this.id=r(t,this.vertexShader,this.fragmentShader),this.uniforms=n(t,this.id),this.attributes=i(t,this.id)}return t.getProgram=function(e,r,i,n){return this.programCache[n]||(this.programCache[n]=new t(e,r,i)),this.programCache[n]},t.deleteProgram=function(t,e,r,i){},t.programCache={},t}();t.EgretWebGLProgram=a,__reflect(a.prototype,"egret.web.EgretWebGLProgram")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e;!function(t){t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.BYTE=65535]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT"}(e=t.WEBGL_UNIFORM_TYPE||(t.WEBGL_UNIFORM_TYPE={}));var r=function(){function t(t,e,r){this.gl=t,this.name=r.name,this.type=r.type,this.size=r.size,this.location=t.getUniformLocation(e,this.name),this.setDefaultValue(),this.generateSetValue(),this.generateUpload()}return t.prototype.setDefaultValue=function(){var t=this.type;switch(t){case e.FLOAT:case e.SAMPLER_2D:case e.SAMPLER_CUBE:case e.BOOL:case e.INT:this.value=0;break;case e.FLOAT_VEC2:case e.BOOL_VEC2:case e.INT_VEC2:this.value=[0,0];break;case e.FLOAT_VEC3:case e.BOOL_VEC3:case e.INT_VEC3:this.value=[0,0,0];break;case e.FLOAT_VEC4:case e.BOOL_VEC4:case e.INT_VEC4:this.value=[0,0,0,0];break;case e.FLOAT_MAT2:this.value=new Float32Array([1,0,0,1]);break;case e.FLOAT_MAT3:this.value=new Float32Array([1,0,0,0,1,0,0,0,1]);break;case e.FLOAT_MAT4:this.value=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},t.prototype.generateSetValue=function(){var t=this.type;switch(t){case e.FLOAT:case e.SAMPLER_2D:case e.SAMPLER_CUBE:case e.BOOL:case e.INT:this.setValue=function(t){var e=this.value!==t;this.value=t,e&&this.upload()};break;case e.FLOAT_VEC2:case e.BOOL_VEC2:case e.INT_VEC2:this.setValue=function(t){var e=this.value[0]!==t.x||this.value[1]!==t.y;this.value[0]=t.x,this.value[1]=t.y,e&&this.upload()};break;case e.FLOAT_VEC3:case e.BOOL_VEC3:case e.INT_VEC3:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.upload()};break;case e.FLOAT_VEC4:case e.BOOL_VEC4:case e.INT_VEC4:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.value[3]=t.w,this.upload()};break;case e.FLOAT_MAT2:case e.FLOAT_MAT3:case e.FLOAT_MAT4:this.setValue=function(t){this.value.set(t),this.upload()}}},t.prototype.generateUpload=function(){var t=this.gl,r=this.type,i=this.location;switch(r){case e.FLOAT:this.upload=function(){var e=this.value;t.uniform1f(i,e)};break;case e.FLOAT_VEC2:this.upload=function(){var e=this.value;t.uniform2f(i,e[0],e[1])};break;case e.FLOAT_VEC3:this.upload=function(){var e=this.value;t.uniform3f(i,e[0],e[1],e[2])};break;case e.FLOAT_VEC4:this.upload=function(){var e=this.value;t.uniform4f(i,e[0],e[1],e[2],e[3])};break;case e.SAMPLER_2D:case e.SAMPLER_CUBE:case e.BOOL:case e.INT:this.upload=function(){var e=this.value;t.uniform1i(i,e)};break;case e.BOOL_VEC2:case e.INT_VEC2:this.upload=function(){var e=this.value;t.uniform2i(i,e[0],e[1])};break;case e.BOOL_VEC3:case e.INT_VEC3:this.upload=function(){var e=this.value;t.uniform3i(i,e[0],e[1],e[2])};break;case e.BOOL_VEC4:case e.INT_VEC4:this.upload=function(){var e=this.value;t.uniform4i(i,e[0],e[1],e[2],e[3])};break;case e.FLOAT_MAT2:this.upload=function(){var e=this.value;t.uniformMatrix2fv(i,!1,e)};break;case e.FLOAT_MAT3:this.upload=function(){var e=this.value;t.uniformMatrix3fv(i,!1,e)};break;case e.FLOAT_MAT4:this.upload=function(){var e=this.value;t.uniformMatrix4fv(i,!1,e)}}},t}();t.EgretWebGLUniform=r,__reflect(r.prototype,"egret.web.EgretWebGLUniform")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.drawData=[],this.drawDataLen=0}return t.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var t=this.drawData[this.drawDataLen]||{};t.type=1,t.count=0,this.drawData[this.drawDataLen]=t,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},t.prototype.pushDrawTexture=function(t,e,r,i,n){if(void 0===e&&(e=2),r){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=t,a.filter=r,a.count=e,a.textureWidth=i,a.textureHeight=n,this.drawData[this.drawDataLen]=a,this.drawDataLen++}else{if(0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||t!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=t,a.count=0,this.drawData[this.drawDataLen]=a,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=e}},t.prototype.pushChangeSmoothing=function(t,e){t.smoothing=e;var r=this.drawData[this.drawDataLen]||{};r.type=10,r.texture=t,r.smoothing=e,this.drawData[this.drawDataLen]=r,this.drawDataLen++},t.prototype.pushPushMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=2,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushPopMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=3,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushSetBlend=function(t){for(var e=this.drawDataLen,r=!1,i=e-1;i>=0;i--){var n=this.drawData[i];if(n){if((0==n.type||1==n.type)&&(r=!0),!r&&4==n.type){this.drawData.splice(i,1),this.drawDataLen--;continue}if(4==n.type){if(n.value==t)return;break}}}var a=this.drawData[this.drawDataLen]||{};a.type=4,a.value=t,this.drawData[this.drawDataLen]=a,this.drawDataLen++},t.prototype.pushResize=function(t,e,r){var i=this.drawData[this.drawDataLen]||{};i.type=5,i.buffer=t,i.width=e,i.height=r,this.drawData[this.drawDataLen]=i,this.drawDataLen++},t.prototype.pushClearColor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=6,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.pushActivateBuffer=function(t){for(var e=this.drawDataLen,r=!1,i=e-1;i>=0;i--){var n=this.drawData[i];!n||(4!=n.type&&7!=n.type&&(r=!0),r||7!=n.type)||(this.drawData.splice(i,1),this.drawDataLen--)}var a=this.drawData[this.drawDataLen]||{};a.type=7,a.buffer=t,a.width=t.rootRenderTarget.width,a.height=t.rootRenderTarget.height,this.drawData[this.drawDataLen]=a,this.drawDataLen++},t.prototype.pushEnableScissor=function(t,e,r,i){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=t,n.y=e,n.width=r,n.height=i,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushDisableScissor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=9,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.clear=function(){for(var t=0;t<this.drawDataLen;t++){var e=this.drawData[t];e.type=0,e.count=0,e.texture=null,e.filter=null,e.uv=null,e.value="",e.buffer=null,e.width=0,e.height=0}this.drawDataLen=0},t}();t.WebGLDrawCmdManager=e,__reflect(e.prototype,"egret.web.WebGLDrawCmdManager")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function n(i,n,a){var o=r.call(this)||this;if(o.globalAlpha=1,o.stencilState=!1,o.$stencilList=[],o.stencilHandleCount=0,o.$scissorState=!1,o.scissorRect=new t.Rectangle,o.$hasScissor=!1,o.$drawCalls=0,o.$computeDrawCall=!1,o.globalMatrix=new t.Matrix,o.savedGlobalMatrix=new t.Matrix,o.$offsetX=0,o.$offsetY=0,o.context=e.WebGLRenderContext.getInstance(i,n),__global.nativeRender)return o.$width=i,o.$height=n,o.surface=o.context.surface,o.rootRenderTarget=null,a?o.bufferIdForWasm=0:o.bufferIdForWasm=t.NativeNode.setValuesToRenderBuffer(o),o;if(o.rootRenderTarget=new e.WebGLRenderTarget(o.context.context,3,3),i&&n&&o.resize(i,n),o.root=a,o.root)o.context.pushBuffer(o),o.surface=o.context.surface,o.$computeDrawCall=!0;else{var s=o.context.activatedBuffer;s&&s.rootRenderTarget.activate(),o.rootRenderTarget.initFrameBuffer(),o.surface=o.rootRenderTarget}return o}return __extends(n,r),n.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},n.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},n.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},n.prototype.enableScissor=function(t,e,r,i){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(t,e,r,i),this.context.enableScissorTest(this.scissorRect))},n.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},n.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(n.prototype,"width",{get:function(){return __global.nativeRender?this.$width:this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return __global.nativeRender?this.$height:this.rootRenderTarget.height},enumerable:!0,configurable:!0}),n.prototype.resize=function(t,e,r){return t=t||1,e=e||1,__global.nativeRender?(this.$width=t,void(this.$height=e)):(this.context.pushBuffer(this),(t!=this.rootRenderTarget.width||e!=this.rootRenderTarget.height)&&(this.context.drawCmdManager.pushResize(this,t,e),this.rootRenderTarget.width=t,this.rootRenderTarget.height=e),this.root&&this.context.resize(t,e,r),this.context.clear(),void this.context.popBuffer())},n.prototype.getPixels=function(t,e,r,i){void 0===r&&(r=1),void 0===i&&(i=1);var n=new Uint8Array(4*r*i),a=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(t,e,r,i,n),this.rootRenderTarget.useFrameBuffer=a,this.rootRenderTarget.activate();for(var o=new Uint8Array(4*r*i),s=0;i>s;s++)for(var h=0;r>h;h++)o[4*(r*(i-s-1)+h)]=n[4*(r*s+h)],o[4*(r*(i-s-1)+h)+1]=n[4*(r*s+h)+1],o[4*(r*(i-s-1)+h)+2]=n[4*(r*s+h)+2],o[4*(r*(i-s-1)+h)+3]=n[4*(r*s+h)+3];return o},n.prototype.toDataURL=function(t,e){return this.context.surface.toDataURL(t,e)},n.prototype.destroy=function(){this.context.destroy()},n.prototype.onRenderFinish=function(){this.$drawCalls=0},n.prototype.drawFrameBufferToSurface=function(t,e,r,i,n,a,o,s,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,t,e,r,i,n,a,o,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.drawSurfaceToFrameBuffer=function(t,e,r,i,n,a,o,s,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.context.surface,t,e,r,i,n,a,o,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.clear=function(){this.context.pushBuffer(this),this.context.clear(),this.context.popBuffer()},n.prototype.setTransform=function(t,e,r,i,n,a){var o=this.globalMatrix;o.a=t,o.b=e,o.c=r,o.d=i,o.tx=n,o.ty=a},n.prototype.transform=function(t,e,r,i,n,a){var o=this.globalMatrix,s=o.a,h=o.b,l=o.c,c=o.d;(1!=t||0!=e||0!=r||1!=i)&&(o.a=t*s+e*l,o.b=t*h+e*c,o.c=r*s+i*l,o.d=r*h+i*c),o.tx=n*s+a*l+o.tx,o.ty=n*h+a*c+o.ty},n.prototype.translate=function(t,e){var r=this.globalMatrix;r.tx+=t,r.ty+=e},n.prototype.useOffset=function(){var t=this;(0!=t.$offsetX||0!=t.$offsetY)&&(t.globalMatrix.append(1,0,0,1,t.$offsetX,t.$offsetY),t.$offsetX=t.$offsetY=0)},n.prototype.saveTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},n.prototype.restoreTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},n.create=function(t,e){var r=i.pop();if(r){r.resize(t,e);var a=r.globalMatrix;a.a=1,a.b=0,a.c=0,a.d=1,a.tx=0,a.ty=0,r.globalAlpha=1,r.$offsetX=0,r.$offsetY=0}else r=new n(t,e),r.$computeDrawCall=!1;return r},n.release=function(t){i.push(t)},n.autoClear=!0,n}(t.HashObject);e.WebGLRenderBuffer=r,__reflect(r.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var i=[]}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t,e){var r=document.createElement("canvas");return isNaN(t)||isNaN(e)||(r.width=t,r.height=e),r}var i=function(){function i(t,i){if(this.glID=null,this.projectionX=0/0,this.projectionY=0/0,this.contextLost=!1,this.$scissorState=!1,this.vertSize=5,this.surface=r(t,i),!__global.nativeRender){this.initWebGL(),this.$bufferStack=[];var n=this.context;this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new e.WebGLDrawCmdManager,this.vao=new e.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}}return i.getInstance=function(t,e){return this.instance?this.instance:(this.instance=new i(t,e),this.instance)},i.prototype.pushBuffer=function(t){this.$bufferStack.push(t),t!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(t)),this.currentBuffer=t},i.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var t=this.$bufferStack.pop(),e=this.$bufferStack[this.$bufferStack.length-1];t!=e&&this.drawCmdManager.pushActivateBuffer(e),this.currentBuffer=e}},i.prototype.activateBuffer=function(t){t.rootRenderTarget.activate(),this.bindIndices||this.uploadIndicesArray(this.vao.getIndices()),t.restoreStencil(),t.restoreScissor(),this.onResize(t.width,t.height)},i.prototype.uploadVerticesArray=function(t){var e=this.context;e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW)},i.prototype.uploadIndicesArray=function(t){var e=this.context;e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this.bindIndices=!0},i.prototype.destroy=function(){this.surface.width=this.surface.height=0},i.prototype.onResize=function(t,e){t=t||this.surface.width,e=e||this.surface.height,this.projectionX=t/2,this.projectionY=-e/2,this.context&&this.context.viewport(0,0,t,e)},i.prototype.resize=function(t,e,r){var i=this.surface;r?(i.width<t&&(i.width=t),i.height<e&&(i.height=e)):(i.width!=t&&(i.width=t),i.height!=e&&(i.height=e)),this.onResize()},i.prototype.initWebGL=function(){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),this.getWebGLContext();var t=this.context;this.$maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)},i.prototype.handleContextLost=function(){this.contextLost=!0},i.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},i.prototype.getWebGLContext=function(){for(var e,r={antialias:i.antialias,stencil:!0},n=["webgl","experimental-webgl"],a=0;a<n.length;a++){try{e=this.surface.getContext(n[a],r)}catch(o){}if(e)break}e||t.$error(1021),this.setContext(e)},i.prototype.setContext=function(t){this.context=t,t.id=i.glContextId++,this.glID=t.id,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,!0),t.activeTexture(t.TEXTURE0)},i.prototype.enableStencilTest=function(){var t=this.context;t.enable(t.STENCIL_TEST)},i.prototype.disableStencilTest=function(){var t=this.context;t.disable(t.STENCIL_TEST)},i.prototype.enableScissorTest=function(t){var e=this.context;e.enable(e.SCISSOR_TEST),e.scissor(t.x,t.y,t.width,t.height)},i.prototype.disableScissorTest=function(){var t=this.context;t.disable(t.SCISSOR_TEST)},i.prototype.getPixels=function(t,e,r,i,n){var a=this.context;a.readPixels(t,e,r,i,a.RGBA,a.UNSIGNED_BYTE,n)},i.prototype.createTexture=function(t){var e=this.context,r=e.createTexture();return r?(r.glContext=e,e.bindTexture(e.TEXTURE_2D,r),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r):void(this.contextLost=!0)},i.prototype.createTextureFromCompressedData=function(t,e,r,i,n){return null},i.prototype.updateTexture=function(t,e){var r=this.context;r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)},i.prototype.getWebGLTexture=function(t){return t.webGLTexture||("image"==t.format?t.webGLTexture=this.createTexture(t.source):"pvr"==t.format&&(t.webGLTexture=this.createTextureFromCompressedData(t.source.pvrtcData,t.width,t.height,t.source.mipmapsCount,t.source.format)),t.$deleteSource&&t.webGLTexture&&(t.source=null),t.webGLTexture.smoothing=!0),t.webGLTexture},i.prototype.clearRect=function(t,e,r,i){if(0!=t||0!=e||r!=this.surface.width||i!=this.surface.height){var n=this.currentBuffer;if(n.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,r,i),this.setGlobalCompositeOperation("source-over");else{var a=n.globalMatrix;0==a.b&&0==a.c?(t=t*a.a+a.tx,e=e*a.d+a.ty,r*=a.a,i*=a.d,this.enableScissor(t,-e-i+n.height,r,i),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,r,i),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},i.prototype.setGlobalCompositeOperation=function(t){this.drawCmdManager.pushSetBlend(t)},i.prototype.drawImage=function(t,e,r,i,n,a,o,s,h,l,c,u,d){var p=this.currentBuffer;if(!this.contextLost&&t&&p){var f,g,v;if(t.texture||t.source&&t.source.texture)f=t.texture||t.source.texture,p.saveTransform(),g=p.$offsetX,v=p.$offsetY,p.useOffset(),p.transform(1,0,0,-1,0,h+2*o);else{if(!t.source&&!t.webGLTexture)return;f=this.getWebGLTexture(t)}f&&(this.drawTexture(f,e,r,i,n,a,o,s,h,l,c,void 0,void 0,void 0,void 0,u,d),t.source&&t.source.texture&&(p.$offsetX=g,p.$offsetY=v,p.restoreTransform()))}},i.prototype.drawMesh=function(t,e,r,i,n,a,o,s,h,l,c,u,d,p,f,g,v){var y=this.currentBuffer;if(!this.contextLost&&t&&y){var $,b,m;if(t.texture||t.source&&t.source.texture)$=t.texture||t.source.texture,y.saveTransform(),b=y.$offsetX,m=y.$offsetY,y.useOffset(),y.transform(1,0,0,-1,0,h+2*o);else{if(!t.source&&!t.webGLTexture)return;$=this.getWebGLTexture(t)}$&&(this.drawTexture($,e,r,i,n,a,o,s,h,l,c,u,d,p,f,g,v),(t.texture||t.source&&t.source.texture)&&(y.$offsetX=b,y.$offsetY=m,y.restoreTransform()))}},i.prototype.drawTexture=function(t,e,r,i,n,a,o,s,h,l,c,u,d,p,f,g,v){var y=this.currentBuffer;if(!this.contextLost&&t&&y){d&&p?this.vao.reachMaxSize(d.length/2,p.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),void 0!=v&&t.smoothing!=v&&this.drawCmdManager.pushChangeSmoothing(t,v),u&&this.vao.changeToMeshIndices();var $=p?p.length/3:2;this.drawCmdManager.pushDrawTexture(t,$,this.$filter),this.vao.cacheArrays(y,e,r,i,n,a,o,s,h,l,c,u,d,p,g)}},i.prototype.drawRect=function(t,e,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),this.vao.cacheArrays(n,0,0,r,i,t,e,r,i,r,i))},i.prototype.pushMask=function(t,e,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(n.$stencilList.push({x:t,y:e,width:r,height:i}),this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPushMask(),this.vao.cacheArrays(n,0,0,r,i,t,e,r,i,r,i))},i.prototype.popMask=function(){var t=this.currentBuffer;if(!this.contextLost&&t){var e=t.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPopMask(),this.vao.cacheArrays(t,0,0,e.width,e.height,e.x,e.y,e.width,e.height,e.width,e.height)}},i.prototype.clear=function(){this.drawCmdManager.pushClearColor()
},i.prototype.enableScissor=function(t,e,r,i){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(t,e,r,i),n.$hasScissor=!0},i.prototype.disableScissor=function(){var t=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),t.$hasScissor=!1},i.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var t=this.drawCmdManager.drawDataLen,e=0,r=0;t>r;r++){var i=this.drawCmdManager.drawData[r];e=this.drawData(i,e),7==i.type&&(this.activatedBuffer=i.buffer),(0==i.type||1==i.type||2==i.type||3==i.type)&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},i.prototype.drawData=function(t,r){if(t){var i,n=this.context,a=t.filter;switch(t.type){case 0:a?"custom"===a.type?i=e.EgretWebGLProgram.getProgram(n,a.$vertexSrc,a.$fragmentSrc,a.$shaderKey):"colorTransform"===a.type?i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.colorTransform_frag,"colorTransform"):"blurX"===a.type?i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"blurY"===a.type?i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"glow"===a.type&&(i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.glow_frag,"glow")):i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.texture_frag,"texture"),this.activeProgram(n,i),this.syncUniforms(i,a,t.textureWidth,t.textureHeight),r+=this.drawTextureElements(t,r);break;case 1:i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,t.textureWidth,t.textureHeight),r+=this.drawRectElements(t,r);break;case 2:i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,t.textureWidth,t.textureHeight),r+=this.drawPushMaskElements(t,r);break;case 3:i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,t.textureWidth,t.textureHeight),r+=this.drawPopMaskElements(t,r);break;case 4:this.setBlendMode(t.value);break;case 5:t.buffer.rootRenderTarget.resize(t.width,t.height),this.onResize(t.width,t.height);break;case 6:if(this.activatedBuffer){var o=this.activatedBuffer.rootRenderTarget;(0!=o.width||0!=o.height)&&o.clear(!0)}break;case 7:this.activateBuffer(t.buffer);break;case 8:var s=this.activatedBuffer;s&&(s.rootRenderTarget&&s.rootRenderTarget.enabledStencil(),s.enableScissor(t.x,t.y,t.width,t.height));break;case 9:s=this.activatedBuffer,s&&s.disableScissor();break;case 10:n.bindTexture(n.TEXTURE_2D,t.texture),t.smoothing?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST))}return r}},i.prototype.activeProgram=function(t,e){if(e!=this.currentProgram){t.useProgram(e.id);var r=e.attributes;for(var i in r)"aVertexPosition"===i?(t.vertexAttribPointer(r.aVertexPosition.location,2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(r.aVertexPosition.location)):"aTextureCoord"===i?(t.vertexAttribPointer(r.aTextureCoord.location,2,t.FLOAT,!1,20,8),t.enableVertexAttribArray(r.aTextureCoord.location)):"aColor"===i&&(t.vertexAttribPointer(r.aColor.location,1,t.FLOAT,!1,20,16),t.enableVertexAttribArray(r.aColor.location));this.currentProgram=e}},i.prototype.syncUniforms=function(t,e,r,i){var n=t.uniforms;e&&"custom"===e.type;for(var a in n)if("projectionVector"===a)n[a].setValue({x:this.projectionX,y:this.projectionY});else if("uTextureSize"===a)n[a].setValue({x:r,y:i});else if("uSampler"===a);else{var o=e.$uniforms[a];void 0!==o&&n[a].setValue(o)}},i.prototype.drawTextureElements=function(t,e){var r=this.context;r.bindTexture(r.TEXTURE_2D,t.texture);var i=3*t.count;return r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),i},i.prototype.drawRectElements=function(t,e){var r=this.context,i=3*t.count;return r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),i},i.prototype.drawPushMaskElements=function(t,e){var r=this.context,i=3*t.count,n=this.activatedBuffer;if(n){n.rootRenderTarget&&n.rootRenderTarget.enabledStencil(),0==n.stencilHandleCount&&(n.enableStencil(),r.clear(r.STENCIL_BUFFER_BIT));var a=n.stencilHandleCount;n.stencilHandleCount++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,a,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),r.stencilFunc(r.EQUAL,a+1,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.drawPopMaskElements=function(t,e){var r=this.context,i=3*t.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var a=n.stencilHandleCount;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,a+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),r.stencilFunc(r.EQUAL,a,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.setBlendMode=function(t){var e=this.context,r=i.blendModesForGL[t];r&&e.blendFunc(r[0],r[1])},i.prototype.drawTargetWidthFilters=function(t,r){var i,n=r,a=t.length;if(a>1)for(var o=0;a-1>o;o++){var s=t[o],h=r.rootRenderTarget.width,l=r.rootRenderTarget.height;i=e.WebGLRenderBuffer.create(h,l),i.setTransform(1,0,0,1,0,0),i.globalAlpha=1,this.drawToRenderTarget(s,r,i),r!=n&&e.WebGLRenderBuffer.release(r),r=i}var c=t[a-1];this.drawToRenderTarget(c,r,this.currentBuffer),r!=n&&e.WebGLRenderBuffer.release(r)},i.prototype.drawToRenderTarget=function(t,r,i){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(i);var n,a=r,o=r.rootRenderTarget.width,s=r.rootRenderTarget.height;if("blur"==t.type){var h=t.blurXFilter,l=t.blurYFilter;0!=h.blurX&&0!=l.blurY?(n=e.WebGLRenderBuffer.create(o,s),n.setTransform(1,0,0,1,0,0),n.globalAlpha=1,this.drawToRenderTarget(t.blurXFilter,r,n),r!=a&&e.WebGLRenderBuffer.release(r),r=n,t=l):t=0===h.blurX?l:h}i.saveTransform(),i.transform(1,0,0,-1,0,s),this.vao.cacheArrays(i,0,0,o,s,0,0,o,s,o,s),i.restoreTransform(),this.drawCmdManager.pushDrawTexture(r.rootRenderTarget.texture,2,t,o,s),r!=a&&e.WebGLRenderBuffer.release(r),this.popBuffer()}},i.initBlendMode=function(){i.blendModesForGL={},i.blendModesForGL["source-over"]=[1,771],i.blendModesForGL.lighter=[1,1],i.blendModesForGL["lighter-in"]=[770,771],i.blendModesForGL["destination-out"]=[0,771],i.blendModesForGL["destination-in"]=[0,770]},i.glContextId=0,i.blendModesForGL=null,i}();e.WebGLRenderContext=i,__reflect(i.prototype,"egret.web.WebGLRenderContext"),i.initBlendMode()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(t,r,i){var n=e.call(this)||this;return n.clearColor=[0,0,0,0],n.useFrameBuffer=!0,n.gl=t,n.width=r||1,n.height=i||1,n}return __extends(r,e),r.prototype.resize=function(t,e){var r=this.gl;this.width=t,this.height=e,this.frameBuffer&&(r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,r.UNSIGNED_BYTE,null)),this.stencilBuffer&&(r.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=null)},r.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer())},r.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},r.prototype.initFrameBuffer=function(){if(!this.frameBuffer){var t=this.gl;this.texture=this.createTexture(),this.frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0)}},r.prototype.createTexture=function(){var t=this.gl,e=t.createTexture();return e.glContext=t,t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e},r.prototype.clear=function(t){var e=this.gl;t&&this.activate(),e.colorMask(!0,!0,!0,!0),e.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),e.clear(e.COLOR_BUFFER_BIT)},r.prototype.enabledStencil=function(){if(this.frameBuffer&&!this.stencilBuffer){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer)}},r.prototype.dispose=function(){t.WebGLUtils.deleteWebGLTexture(this.texture)},r}(t.HashObject);e.WebGLRenderTarget=r,__reflect(r.prototype,"egret.web.WebGLRenderTarget")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=["source-over","lighter","destination-out"],i="source-over",n=[],a=function(){function a(){this.nestLevel=0}return a.prototype.render=function(e,r,i,a){this.nestLevel++;var o=r,s=o.context;s.pushBuffer(o),o.transform(i.a,i.b,i.c,i.d,0,0),this.drawDisplayObject(e,o,i.tx,i.ty,!0),s.$drawWebGL();var h=o.$drawCalls;o.onRenderFinish(),s.popBuffer();var l=t.Matrix.create();if(i.$invertInto(l),o.transform(l.a,l.b,l.c,l.d,0,0),t.Matrix.release(l),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var c=n.length,u=0;c>u;u++)n[u].resize(0,0)}return h},a.prototype.drawDisplayObject=function(e,r,i,n,a){var o,s=0,h=e.$displayList;if(h&&!a?((e.$cacheDirty||e.$renderDirty||h.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||h.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=h.drawToSurface()),o=h.$renderNode):o=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,o){switch(s++,r.$offsetX=i,r.$offsetY=n,o.type){case 1:this.renderBitmap(o,r);break;case 2:this.renderText(o,r);break;case 3:this.renderGraphics(o,r);break;case 4:this.renderGroup(o,r);break;case 5:this.renderMesh(o,r);break;case 6:this.renderNormalBitmap(o,r)}r.$offsetX=0,r.$offsetY=0}if(h&&!a)return s;var l=e.$children;if(l)for(var c=l.length,u=0;c>u;u++){var d=l[u],p=void 0,f=void 0,g=void 0;1!=d.$alpha&&(g=r.globalAlpha,r.globalAlpha*=d.$alpha);var v=void 0;if(d.$useTranslate){var y=d.$getMatrix();p=i+d.$x,f=n+d.$y;var $=r.globalMatrix;v=t.Matrix.create(),v.a=$.a,v.b=$.b,v.c=$.c,v.d=$.d,v.tx=$.tx,v.ty=$.ty,r.transform(y.a,y.b,y.c,y.d,p,f),p=-d.$anchorOffsetX,f=-d.$anchorOffsetY}else p=i+d.$x-d.$anchorOffsetX,f=n+d.$y-d.$anchorOffsetY;switch(d.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(d,r,p,f);break;case 3:s+=this.drawWithClip(d,r,p,f);break;case 4:s+=this.drawWithScrollRect(d,r,p,f);break;default:s+=this.drawDisplayObject(d,r,p,f)}if(g&&(r.globalAlpha=g),v){var y=r.globalMatrix;y.a=v.a,y.b=v.b,y.c=v.c,y.d=v.d,y.tx=v.tx,y.ty=v.ty,t.Matrix.release(v)}}return s},a.prototype.drawWithFilter=function(t,e,a,o){var s=0;if(!t.$children||0!=t.$children.length||t.$renderNode&&0!=t.$renderNode.$getRenderCount()){var h,l=t.$filters,c=0!==t.$blendMode;c&&(h=r[t.$blendMode],h||(h=i));var u=t.$getOriginalBounds();if(u.width<=0||u.height<=0)return s;if(!t.mask&&1==l.length&&("colorTransform"==l[0].type||"custom"===l[0].type&&0===l[0].padding)){var d=this.getRenderCount(t);if(!t.$children||1==d)return c&&e.context.setGlobalCompositeOperation(h),e.context.$filter=l[0],s+=t.$mask?this.drawWithClip(t,e,a,o):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,e,a,o):this.drawDisplayObject(t,e,a,o),e.context.$filter=null,c&&e.context.setGlobalCompositeOperation(i),s}var p=this.createRenderBuffer(u.width,u.height);return p.context.pushBuffer(p),s+=t.$mask?this.drawWithClip(t,p,-u.x,-u.y):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,p,-u.x,-u.y):this.drawDisplayObject(t,p,-u.x,-u.y),p.context.popBuffer(),s>0&&(c&&e.context.setGlobalCompositeOperation(h),s++,e.$offsetX=a+u.x,e.$offsetY=o+u.y,e.context.drawTargetWidthFilters(l,p),c&&e.context.setGlobalCompositeOperation(i)),n.push(p),s}},a.prototype.getRenderCount=function(t){var e=0;if(t.$children)for(var r=0,i=t.$children;r<i.length;r++){var n=i[r],a=n.$getRenderNode();a&&(e+=a.$getRenderCount()),n.$children&&(e+=this.getRenderCount(n))}return e},a.prototype.drawWithClip=function(e,a,o,s){var h,l=0,c=0!==e.$blendMode;c&&(h=r[e.$blendMode],h||(h=i));var u=e.$scrollRect?e.$scrollRect:e.$maskRect,d=e.$mask;if(d){var p=d.$getMatrix();if(0==p.a&&0==p.b||0==p.c&&0==p.d)return l}if(d||e.$children&&0!=e.$children.length){var f=e.$getOriginalBounds(),g=this.createRenderBuffer(f.width,f.height);if(g.context.pushBuffer(g),l+=this.drawDisplayObject(e,g,-f.x,-f.y),d){var v=this.createRenderBuffer(f.width,f.height);v.context.pushBuffer(v);var y=t.Matrix.create();y.copyFrom(d.$getConcatenatedMatrix()),d.$getConcatenatedMatrixAt(e,y),v.setTransform(y.a,y.b,y.c,y.d,y.tx,y.ty),t.Matrix.release(y),l+=this.drawDisplayObject(d,v,-f.x,-f.y),v.context.popBuffer(),g.context.setGlobalCompositeOperation("destination-in"),g.setTransform(1,0,0,-1,0,v.height),g.globalAlpha=1;var $=v.rootRenderTarget.width,b=v.rootRenderTarget.height;g.context.drawTexture(v.rootRenderTarget.texture,0,0,$,b,0,0,$,b,$,b),g.setTransform(1,0,0,1,0,0),g.context.setGlobalCompositeOperation("source-over"),n.push(v)}if(g.context.setGlobalCompositeOperation(i),g.context.popBuffer(),l>0){l++,c&&a.context.setGlobalCompositeOperation(h),u&&a.context.pushMask(u.x+o,u.y+s,u.width,u.height),a.globalAlpha=1;var m=t.Matrix.create(),x=a.globalMatrix;m.a=x.a,m.b=x.b,m.c=x.c,m.d=x.d,m.tx=x.tx,m.ty=x.ty,x.append(1,0,0,-1,o+f.x,s+f.y+g.height);var T=g.rootRenderTarget.width,_=g.rootRenderTarget.height;a.context.drawTexture(g.rootRenderTarget.texture,0,0,T,_,0,0,T,_,T,_),u&&g.context.popMask(),c&&a.context.setGlobalCompositeOperation(i);var w=a.globalMatrix;w.a=m.a,w.b=m.b,w.c=m.c,w.d=m.d,w.tx=m.tx,w.ty=m.ty,t.Matrix.release(m)}return n.push(g),l}return u&&a.context.pushMask(u.x+o,u.y+s,u.width,u.height),c&&a.context.setGlobalCompositeOperation(h),l+=this.drawDisplayObject(e,a,o,s),c&&a.context.setGlobalCompositeOperation(i),u&&a.context.popMask(),l},a.prototype.drawWithScrollRect=function(t,e,r,i){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;if(a.isEmpty())return n;t.$scrollRect&&(r-=a.x,i-=a.y);var o=e.globalMatrix,s=e.context,h=!1;if(e.$hasScissor||0!=o.b||0!=o.c)e.context.pushMask(a.x+r,a.y+i,a.width,a.height);else{var l=o.a,c=o.d,u=o.tx,d=o.ty,p=a.x+r,f=a.y+i,g=p+a.width,v=f+a.height,y=void 0,$=void 0,b=void 0,m=void 0;if(1==l&&1==c)y=p+u,$=f+d,b=g+u,m=v+d;else{var x=l*p+u,T=c*f+d,_=l*g+u,w=c*f+d,E=l*g+u,S=c*v+d,C=l*p+u,D=c*v+d,R=0;x>_&&(R=x,x=_,_=R),E>C&&(R=E,E=C,C=R),y=E>x?x:E,b=_>C?_:C,T>w&&(R=T,T=w,w=R),S>D&&(R=S,S=D,D=R),$=S>T?T:S,m=w>D?w:D}s.enableScissor(y,-m+e.height,b-y,m-$),h=!0}return n+=this.drawDisplayObject(t,e,r,i),h?s.disableScissor():s.popMask(),n},a.prototype.drawNodeToBuffer=function(t,e,r,i){var n=e;n.context.pushBuffer(n),n.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(t,e,0,0,i),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},a.prototype.drawDisplayToBuffer=function(t,e,r){e.context.pushBuffer(e),r&&e.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty);var i;i=t.$renderDirty?t.$getRenderNode():t.$renderNode;var n=0;if(i)switch(n++,i.type){case 1:this.renderBitmap(i,e);break;case 2:this.renderText(i,e);break;case 3:this.renderGraphics(i,e);break;case 4:this.renderGroup(i,e);break;case 5:this.renderMesh(i,e);break;case 6:this.renderNormalBitmap(i,e)}var a=t.$children;if(a)for(var o=a.length,s=0;o>s;s++){var h=a[s];switch(h.$renderMode){case 1:break;case 2:n+=this.drawWithFilter(h,e,0,0);break;case 3:n+=this.drawWithClip(h,e,0,0);break;case 4:n+=this.drawWithScrollRect(h,e,0,0);break;default:n+=this.drawDisplayObject(h,e,0,0)}}return e.context.$drawWebGL(),e.onRenderFinish(),e.context.popBuffer(),n},a.prototype.renderNode=function(t,e,r,i,n){switch(e.$offsetX=r,e.$offsetY=i,t.type){case 1:this.renderBitmap(t,e);break;case 2:this.renderText(t,e);break;case 3:this.renderGraphics(t,e,n);break;case 4:this.renderGroup(t,e);break;case 5:this.renderMesh(t,e);break;case 6:this.renderNormalBitmap(t,e)}},a.prototype.renderNormalBitmap=function(t,e){var r=t.image;r&&e.context.drawImage(r,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX,t.drawY,t.drawW,t.drawH,t.imageWidth,t.imageHeight,t.rotated,t.smoothing)},a.prototype.renderBitmap=function(e,n){var a=e.image;if(a){var o,s,h,l=e.drawData,c=l.length,u=0,d=e.matrix,p=e.blendMode,f=e.alpha;if(d){o=t.Matrix.create();var g=n.globalMatrix;o.a=g.a,o.b=g.b,o.c=g.c,o.d=g.d,o.tx=g.tx,o.ty=g.ty,s=n.$offsetX,h=n.$offsetY,n.useOffset(),n.transform(d.a,d.b,d.c,d.d,d.tx,d.ty)}p&&n.context.setGlobalCompositeOperation(r[p]);var v;if(f==f&&(v=n.globalAlpha,n.globalAlpha*=f),e.filter){for(n.context.$filter=e.filter;c>u;)n.context.drawImage(a,l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);n.context.$filter=null}else for(;c>u;)n.context.drawImage(a,l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);if(p&&n.context.setGlobalCompositeOperation(i),f==f&&(n.globalAlpha=v),d){var y=n.globalMatrix;y.a=o.a,y.b=o.b,y.c=o.c,y.d=o.d,y.tx=o.tx,y.ty=o.ty,n.$offsetX=s,n.$offsetY=h,t.Matrix.release(o)}}},a.prototype.renderMesh=function(e,n){var a,o,s,h=e.image,l=e.drawData,c=l.length,u=0,d=e.matrix,p=e.blendMode,f=e.alpha;if(d){a=t.Matrix.create();var g=n.globalMatrix;a.a=g.a,a.b=g.b,a.c=g.c,a.d=g.d,a.tx=g.tx,a.ty=g.ty,o=n.$offsetX,s=n.$offsetY,n.useOffset(),n.transform(d.a,d.b,d.c,d.d,d.tx,d.ty)}p&&n.context.setGlobalCompositeOperation(r[p]);var v;if(f==f&&(v=n.globalAlpha,n.globalAlpha*=f),e.filter){for(n.context.$filter=e.filter;c>u;)n.context.drawMesh(h,l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);n.context.$filter=null}else for(;c>u;)n.context.drawMesh(h,l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],l[u++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);if(p&&n.context.setGlobalCompositeOperation(i),f==f&&(n.globalAlpha=v),d){var y=n.globalMatrix;y.a=a.a,y.b=a.b,y.c=a.c,y.d=a.d,y.tx=a.tx,y.ty=a.ty,n.$offsetX=o,n.$offsetY=s,t.Matrix.release(a)}},a.prototype.renderText=function(r,i){var n=r.width-r.x,a=r.height-r.y;if(!(0>=n||0>=a)&&n&&a&&0!=r.drawData.length){var o=t.sys.DisplayList.$canvasScaleX,s=t.sys.DisplayList.$canvasScaleY,h=i.context.$maxTextureSize;n*o>h&&(o*=h/(n*o)),a*s>h&&(s*=h/(a*s)),n*=o,a*=s;var l=r.x*o,c=r.y*s;if((r.$canvasScaleX!=o||r.$canvasScaleY!=s)&&(r.$canvasScaleX=o,r.$canvasScaleY=s,r.dirtyRender=!0),this.canvasRenderBuffer&&this.canvasRenderBuffer.context?r.dirtyRender&&this.canvasRenderBuffer.resize(n,a):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(n,a)),this.canvasRenderBuffer.context){if((1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),l||c?(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,-l,-c),i.transform(1,0,0,1,l/o,c/s)):(1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),r.dirtyRender){var u=this.canvasRenderBuffer.surface;this.canvasRenderer.renderText(r,this.canvasRenderBuffer.context);var d=r.$texture;d?i.context.updateTexture(d,u):(d=i.context.createTexture(u),r.$texture=d),r.$textureWidth=u.width,r.$textureHeight=u.height}var p=r.$textureWidth,f=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,p,f,0,0,p/o,f/s,p,f),(l||c)&&(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),i.transform(1,0,0,1,-l/o,-c/s)),r.dirtyRender=!1}}},a.prototype.renderGraphics=function(r,i,n){var a=r.width,o=r.height;if(!(0>=a||0>=o)&&a&&o&&0!=r.drawData.length){var s=t.sys.DisplayList.$canvasScaleX,h=t.sys.DisplayList.$canvasScaleY;(1>a*s||1>o*h)&&(s=h=1),(r.$canvasScaleX!=s||r.$canvasScaleY!=h)&&(r.$canvasScaleX=s,r.$canvasScaleY=h,r.dirtyRender=!0),a*=s,o*=h;var l=Math.ceil(a),c=Math.ceil(o);if(s*=l/a,h*=c/o,a=l,o=c,this.canvasRenderBuffer&&this.canvasRenderBuffer.context?(r.dirtyRender||n)&&this.canvasRenderBuffer.resize(a,o):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(a,o)),this.canvasRenderBuffer.context){(1!=s||1!=h)&&this.canvasRenderBuffer.context.setTransform(s,0,0,h,0,0),(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(-r.x,-r.y),i.transform(1,0,0,1,r.x,r.y));var u=this.canvasRenderBuffer.surface;if(n){this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context,!0),t.WebGLUtils.deleteWebGLTexture(u);var d=i.context.getWebGLTexture(u);i.context.drawTexture(d,0,0,a,o,0,0,a,o,u.width,u.height)}else{if(r.dirtyRender){this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context);var d=r.$texture;d?i.context.updateTexture(d,u):(d=i.context.createTexture(u),r.$texture=d),r.$textureWidth=u.width,r.$textureHeight=u.height}var p=r.$textureWidth,f=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,p,f,0,0,p/s,f/h,p,f)}(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(r.x,r.y),i.transform(1,0,0,1,-r.x,-r.y)),n||(r.dirtyRender=!1)}}},a.prototype.renderGroup=function(e,r){var i,n,a,o=e.matrix;if(o){i=t.Matrix.create();var s=r.globalMatrix;i.a=s.a,i.b=s.b,i.c=s.c,i.d=s.d,i.tx=s.tx,i.ty=s.ty,n=r.$offsetX,a=r.$offsetY,r.useOffset(),r.transform(o.a,o.b,o.c,o.d,o.tx,o.ty)}for(var h=e.drawData,l=h.length,c=0;l>c;c++){var u=h[c];this.renderNode(u,r,r.$offsetX,r.$offsetY)}if(o){var d=r.globalMatrix;d.a=i.a,d.b=i.b,d.c=i.c,d.d=i.d,d.tx=i.tx,d.ty=i.ty,r.$offsetX=n,r.$offsetY=a,t.Matrix.release(i)}},a.prototype.createRenderBuffer=function(t,r){var i=n.pop();return i?i.resize(t,r):(i=new e.WebGLRenderBuffer(t,r),i.$computeDrawCall=!1),i},a}();e.WebGLRenderer=a,__reflect(a.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.compileProgram=function(r,i,n){var a=e.compileFragmentShader(r,n),o=e.compileVertexShader(r,i),s=r.createProgram();return r.attachShader(s,o),r.attachShader(s,a),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||t.$warn(1020),s},e.compileFragmentShader=function(t,r){return e._compileShader(t,r,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,r){return e._compileShader(t,r,t.VERTEX_SHADER)},e._compileShader=function(t,e,r){var i=t.createShader(r);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(r){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(t){if(t){var e=t.glContext;e&&e.deleteTexture(t)}},e}();t.WebGLUtils=e,__reflect(e.prototype,"egret.WebGLUtils")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.size=2e3,this.vertexMaxSize=4*this.size,this.indicesMaxSize=6*this.size,this.vertSize=5,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1;var t=this.vertexMaxSize*this.vertSize,e=this.indicesMaxSize;this.vertices=new Float32Array(t),this.indices=new Uint16Array(e),this.indicesForMesh=new Uint16Array(e);for(var r=0,i=0;e>r;r+=6,i+=4)this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3}return t.prototype.reachMaxSize=function(t,e){return void 0===t&&(t=4),void 0===e&&(e=6),this.vertexIndex>this.vertexMaxSize-t||this.indexIndex>this.indicesMaxSize-e},t.prototype.getVertices=function(){var t=this.vertices.subarray(0,this.vertexIndex*this.vertSize);return t},t.prototype.getIndices=function(){return this.indices},t.prototype.getMeshIndices=function(){return this.indicesForMesh},t.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var t=0,e=this.indexIndex;e>t;++t)this.indicesForMesh[t]=this.indices[t];this.hasMesh=!0}},t.prototype.isMesh=function(){return this.hasMesh},t.prototype.cacheArrays=function(t,e,r,i,n,a,o,s,h,l,c,u,d,p,f){var g=t.globalAlpha,v=t.globalMatrix,y=v.a,$=v.b,b=v.c,m=v.d,x=v.tx,T=v.ty,_=t.$offsetX,w=t.$offsetY;if((0!=_||0!=w)&&(x=_*y+w*b+x,T=_*$+w*m+T),!d){(0!=a||0!=o)&&(x=a*y+o*b+x,T=a*$+o*m+T);var E=s/i;1!=E&&(y=E*y,$=E*$);var S=h/n;1!=S&&(b=S*b,m=S*m)}if(d){var C=this.vertices,D=this.vertexIndex*this.vertSize,R=0,O=0,L=0,A=0,M=0,B=0,F=0;for(R=0,L=u.length;L>R;R+=2)O=5*R/2,B=d[R],F=d[R+1],A=u[R],M=u[R+1],C[D+O+0]=y*B+b*F+x,C[D+O+1]=$*B+m*F+T,C[D+O+2]=(e+A*i)/l,C[D+O+3]=(r+M*n)/c,C[D+O+4]=g;if(this.hasMesh)for(var P=0,N=p.length;N>P;++P)this.indicesForMesh[this.indexIndex+P]=p[P]+this.vertexIndex;this.vertexIndex+=u.length/2,this.indexIndex+=p.length}else{var I=l,k=c,H=i,W=n;e/=I,r/=k;var C=this.vertices,D=this.vertexIndex*this.vertSize;if(f){var U=i;i=n/I,n=U/k,C[D++]=x,C[D++]=T,C[D++]=i+e,C[D++]=r,C[D++]=g,C[D++]=y*H+x,C[D++]=$*H+T,C[D++]=i+e,C[D++]=n+r,C[D++]=g,C[D++]=y*H+b*W+x,C[D++]=m*W+$*H+T,C[D++]=e,C[D++]=n+r,C[D++]=g,C[D++]=b*W+x,C[D++]=m*W+T,C[D++]=e,C[D++]=r,C[D++]=g}else i/=I,n/=k,C[D++]=x,C[D++]=T,C[D++]=e,C[D++]=r,C[D++]=g,C[D++]=y*H+x,C[D++]=$*H+T,C[D++]=i+e,C[D++]=r,C[D++]=g,C[D++]=y*H+b*W+x,C[D++]=m*W+$*H+T,C[D++]=i+e,C[D++]=n+r,C[D++]=g,C[D++]=b*W+x,C[D++]=m*W+T,C[D++]=e,C[D++]=n+r,C[D++]=g;if(this.hasMesh){var X=this.indicesForMesh;X[this.indexIndex+0]=0+this.vertexIndex,X[this.indexIndex+1]=1+this.vertexIndex,X[this.indexIndex+2]=2+this.vertexIndex,X[this.indexIndex+3]=0+this.vertexIndex,X[this.indexIndex+4]=2+this.vertexIndex,X[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},t.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},t}();t.WebGLVertexArrayObject=e,__reflect(e.prototype,"egret.web.WebGLVertexArrayObject")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.image=null,e.smoothing=!0,e.rotated=!1,e.type=6,e}return __extends(e,t),e.prototype.drawImage=function(t,e,r,i,n,a,o,s){var h=this;h.sourceX=t,h.sourceY=e,h.sourceW=r,h.sourceH=i,h.drawX=n,h.drawY=a,h.drawW=o,h.drawH=s,h.renderCount=1},e.prototype.cleanBeforeRender=function(){t.prototype.cleanBeforeRender.call(this),this.image=null},e}(t.RenderNode);t.NormalBitmapNode=e,__reflect(e.prototype,"egret.sys.NormalBitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));
=======
var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r};if("undefined"==typeof global)var global=window;if("undefined"==typeof __global)var __global=global;var __define=this&&this.__define||function(t,e,r,i){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:r,set:i})},egret;!function(t){t.$hashCount=1;var e=function(){function e(){this.$hashCode=t.$hashCount++}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),e}();t.HashObject=e,__reflect(e.prototype,"egret.HashObject",["egret.IHashObject"])}(egret||(egret={}));var egret;!function(t){var e=[],r=function(r){function i(t){void 0===t&&(t=null);var e=r.call(this)||this;return e.$EventDispatcher={0:t?t:e,1:{},2:{},3:0},e}return __extends(i,r),i.prototype.$getEventMap=function(t){var e=this.$EventDispatcher,r=t?e[2]:e[1];return r},i.prototype.addEventListener=function(t,e,r,i,n){this.$addListener(t,e,r,i,n)},i.prototype.once=function(t,e,r,i,n){this.$addListener(t,e,r,i,n,!0)},i.prototype.$addListener=function(t,e,r,i,n,a){var o=this.$EventDispatcher,s=i?o[2]:o[1],h=s[t];h?0!==o[3]&&(s[t]=h=h.concat()):h=s[t]=[],this.$insertEventBin(h,t,e,r,i,n,a)},i.prototype.$insertEventBin=function(t,e,r,i,n,a,o){a=0|+a;for(var s=-1,h=t.length,c=0;h>c;c++){var l=t[c];if(l.listener==r&&l.thisObject==i&&l.target==this)return!1;-1==s&&l.priority<a&&(s=c)}var u={type:e,listener:r,thisObject:i,priority:a,target:this,useCapture:n,dispatchOnce:!!o};return-1!==s?t.splice(s,0,u):t.push(u),!0},i.prototype.removeEventListener=function(t,e,r,i){var n=this.$EventDispatcher,a=i?n[2]:n[1],o=a[t];o&&(0!==n[3]&&(a[t]=o=o.concat()),this.$removeEventBin(o,e,r),0==o.length&&(a[t]=null))},i.prototype.$removeEventBin=function(t,e,r){for(var i=t.length,n=0;i>n;n++){var a=t[n];if(a.listener==e&&a.thisObject==r&&a.target==this)return t.splice(n,1),!0}return!1},i.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},i.prototype.willTrigger=function(t){return this.hasEventListener(t)},i.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},i.prototype.$notifyListener=function(t,r){var i=this.$EventDispatcher,n=r?i[2]:i[1],a=n[t.$type];if(!a)return!0;var o=a.length;if(0==o)return!0;var s=e;i[3]++;for(var h=0;o>h;h++){var c=a[h];if(c.listener.call(c.thisObject,t),c.dispatchOnce&&s.push(c),t.$isPropagationImmediateStopped)break}for(i[3]--;s.length;){var c=s.pop();c.target.removeEventListener(c.type,c.listener,c.thisObject,c.useCapture)}return!t.$isDefaultPrevented},i.prototype.dispatchEventWith=function(e,r,i,n){if(r||this.hasEventListener(e)){var a=t.Event.create(t.Event,e,r,n);a.data=i;var o=this.dispatchEvent(a);return t.Event.release(a),o}return!0},i}(t.HashObject);t.EventDispatcher=r,__reflect(r.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(egret||(egret={}));var egret;!function(t){function e(t){return t%=360,t>180?t-=360:-180>t&&(t+=360),t}var r=function(r){function i(){var e=r.call(this)||this;return e.$children=null,e.$name="",e.$parent=null,e.$stage=null,e.$nestLevel=0,e.$useTranslate=!1,e.$matrix=new t.Matrix,e.$matrixDirty=!1,e.$x=0,e.$y=0,e.$scaleX=1,e.$scaleY=1,e.$rotation=0,e.$skewX=0,e.$skewXdeg=0,e.$skewY=0,e.$skewYdeg=0,e.$explicitWidth=0/0,e.$explicitHeight=0/0,e.$anchorOffsetX=0,e.$anchorOffsetY=0,e.$visible=!0,e.$displayList=null,e.$cacheAsBitmap=!1,e.$cacheDirty=!1,e.$alpha=1,e.$touchEnabled=i.defaultTouchEnabled,e.$scrollRect=null,e.$blendMode=0,e.$maskedObject=null,e.$mask=null,e.$maskRect=null,e.$parentDisplayList=null,e.$renderNode=null,e.$renderDirty=!1,e.$renderMode=null,t.nativeRender&&e.createNativeNode(),e}return __extends(i,r),i.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(0)},Object.defineProperty(i.prototype,"name",{get:function(){return this.$name},set:function(t){this.$name=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),i.prototype.$setParent=function(t){this.$parent=t},i.prototype.$onAddToStage=function(e,r){var i=this;i.$stage=e,i.$nestLevel=r,i.$hasAddToStage=!0,t.Sprite.$EVENT_ADD_TO_STAGE_LIST.push(i)},i.prototype.$onRemoveFromStage=function(){var e=this;e.$nestLevel=0,t.Sprite.$EVENT_REMOVE_FROM_STAGE_LIST.push(e)},i.prototype.$updateUseTransform=function(){var t=this;1==t.$scaleX&&1==t.scaleY&&0==t.$skewX&&0==t.$skewY?t.$useTranslate=!1:t.$useTranslate=!0},Object.defineProperty(i.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),i.prototype.$getMatrix=function(){var t=this;return t.$matrixDirty&&(t.$matrixDirty=!1,t.$matrix.$updateScaleAndRotation(t.$scaleX,t.$scaleY,t.$skewX,t.$skewY)),t.$matrix.tx=t.$x,t.$matrix.ty=t.$y,t.$matrix},i.prototype.$setMatrix=function(r,i){void 0===i&&(i=!0);var n=this,a=n.$matrix;a.a=r.a,a.b=r.b,a.c=r.c,a.d=r.d,n.$x=r.tx,n.$y=r.ty,n.$matrixDirty=!1,1==a.a&&0==a.b&&0==a.c&&1==a.d?n.$useTranslate=!1:n.$useTranslate=!0,i&&(n.$scaleX=a.$getScaleX(),n.$scaleY=a.$getScaleY(),n.$skewX=r.$getSkewX(),n.$skewY=r.$getSkewY(),n.$skewXdeg=e(180*n.$skewX/Math.PI),n.$skewYdeg=e(180*n.$skewY/Math.PI),n.$rotation=e(180*n.$skewY/Math.PI)),t.nativeRender&&n.$nativeNode.setMatrix(r.a,r.b,r.c,r.d,r.tx,r.ty)},i.prototype.$getConcatenatedMatrix=function(){var e=this,r=e.$concatenatedMatrix;r||(r=e.$concatenatedMatrix=new t.Matrix),e.$parent?e.$parent.$getConcatenatedMatrix().$preMultiplyInto(e.$getMatrix(),r):r.copyFrom(e.$getMatrix());var i=e.$anchorOffsetX,n=e.$anchorOffsetY,a=e.$scrollRect;return a?r.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-a.x-i,-a.y-n),r):(0!=i||0!=n)&&r.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-i,-n),r),e.$concatenatedMatrix},i.prototype.$getInvertedConcatenatedMatrix=function(){var e=this;return e.$invertedConcatenatedMatrix||(e.$invertedConcatenatedMatrix=new t.Matrix),e.$getConcatenatedMatrix().$invertInto(e.$invertedConcatenatedMatrix),e.$invertedConcatenatedMatrix},Object.defineProperty(i.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),i.prototype.$getX=function(){return this.$x},i.prototype.$setX=function(e){var r=this;if(r.$x==e)return!1;if(r.$x=e,t.nativeRender)r.$nativeNode.setX(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),i.prototype.$getY=function(){return this.$y},i.prototype.$setY=function(e){var r=this;if(r.$y==e)return!1;if(r.$y=e,t.nativeRender)r.$nativeNode.setY(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),i.prototype.$getScaleX=function(){return this.$scaleX},i.prototype.$setScaleX=function(e){var r=this;if(r.$scaleX=e,r.$matrixDirty=!0,t.nativeRender)r.$nativeNode.setScaleX(e);else{r.$updateUseTransform();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),i.prototype.$getScaleY=function(){return this.$scaleY},i.prototype.$setScaleY=function(e){var r=this;if(r.$scaleY=e,r.$matrixDirty=!0,t.nativeRender)r.$nativeNode.setScaleY(e);else{r.$updateUseTransform();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),i.prototype.$getRotation=function(){return this.$rotation},i.prototype.$setRotation=function(r){r=e(r);var i=this;if(r!=i.$rotation){var n=r-i.$rotation,a=n/180*Math.PI;if(i.$skewX+=a,i.$skewY+=a,i.$rotation=r,i.$matrixDirty=!0,t.nativeRender)i.$nativeNode.setRotation(r);else{i.$updateUseTransform();var o=i.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var s=i.$maskedObject;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp())}}},Object.defineProperty(i.prototype,"skewX",{get:function(){return this.$skewXdeg},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),i.prototype.$setSkewX=function(r){var i=this;if(r!=i.$skewXdeg)if(i.$skewXdeg=r,r=e(r),r=r/180*Math.PI,i.$skewX=r,i.$matrixDirty=!0,t.nativeRender)i.$nativeNode.setSkewX(i.$skewXdeg);else{i.$updateUseTransform();var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"skewY",{get:function(){return this.$skewYdeg},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),i.prototype.$setSkewY=function(r){var i=this;if(r!=i.$skewYdeg)if(i.$skewYdeg=r,r=e(r),r=r/180*Math.PI,i.$skewY=r,i.$matrixDirty=!0,t.nativeRender)i.$nativeNode.setSkewY(i.$skewYdeg);else{i.$updateUseTransform();var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),i.prototype.$getWidth=function(){var t=this;return isNaN(t.$explicitWidth)?t.$getOriginalBounds().width:t.$explicitWidth},i.prototype.$setWidth=function(t){this.$explicitWidth=isNaN(t)?0/0:t},Object.defineProperty(i.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),i.prototype.$getHeight=function(){var t=this;return isNaN(t.$explicitHeight)?t.$getOriginalBounds().height:t.$explicitHeight},i.prototype.$setHeight=function(t){this.$explicitHeight=isNaN(t)?0/0:t},Object.defineProperty(i.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"anchorOffsetX",{get:function(){return this.$anchorOffsetX},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),i.prototype.$setAnchorOffsetX=function(e){var r=this;r.$anchorOffsetX=e,t.nativeRender&&r.$nativeNode.setAnchorOffsetX(e)},Object.defineProperty(i.prototype,"anchorOffsetY",{get:function(){return this.$anchorOffsetY},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),i.prototype.$setAnchorOffsetY=function(e){var r=this;r.$anchorOffsetY=e,t.nativeRender&&r.$nativeNode.setAnchorOffsetY(e)},Object.defineProperty(i.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),i.prototype.$setVisible=function(e){var r=this;if(r.$visible=e,t.nativeRender)r.$nativeNode.setVisible(e);else{r.updateRenderMode();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"cacheAsBitmap",{get:function(){return this.$cacheAsBitmap},set:function(e){var r=this;r.$cacheAsBitmap=e,t.nativeRender?r.$nativeNode.setCacheAsBitmap(e):r.$setHasDisplayList(e)},enumerable:!0,configurable:!0}),i.prototype.$setHasDisplayList=function(e){var r=this,i=!!r.$displayList;if(i!=e)if(e){var n=t.sys.DisplayList.create(r);n&&(r.$displayList=n,r.$cacheDirty=!0)}else r.$displayList=null},i.prototype.$cacheDirtyUp=function(){var t=this.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())},Object.defineProperty(i.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),i.prototype.$setAlpha=function(e){var r=this;if(r.$alpha=e,t.nativeRender)r.$nativeNode.setAlpha(e);else{r.updateRenderMode();var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchEnabled=function(){return this.$touchEnabled},i.prototype.$setTouchEnabled=function(t){this.$touchEnabled=t},Object.defineProperty(i.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),i.prototype.$setScrollRect=function(e){var r=this;return e||r.$scrollRect?(e?(r.$scrollRect||(r.$scrollRect=new t.Rectangle),r.$scrollRect.copyFrom(e),t.nativeRender&&r.$nativeNode.setScrollRect(e.x,e.y,e.width,e.height)):(r.$scrollRect=null,t.nativeRender&&r.$nativeNode.setScrollRect(0,0,0,0)),void(t.nativeRender||r.updateRenderMode())):void r.updateRenderMode()},Object.defineProperty(i.prototype,"blendMode",{get:function(){return t.sys.numberToBlendMode(this.$blendMode)},set:function(e){var r=this,i=t.sys.blendModeToNumber(e);if(r.$blendMode=i,t.nativeRender)r.$nativeNode.setBlendMode(i);else{r.updateRenderMode();var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mask",{get:function(){var t=this;return t.$mask?t.$mask:t.$maskRect},set:function(e){var r=this;if(e!==r){if(e)if(e instanceof i){if(e==r.$mask)return;e.$maskedObject&&(e.$maskedObject.mask=null),e.$maskedObject=r,r.$mask=e,t.nativeRender||e.updateRenderMode(),r.$maskRect&&(t.nativeRender&&r.$nativeNode.setMaskRect(0,0,0,0),r.$maskRect=null),t.nativeRender&&r.$nativeNode.setMask(e.$nativeNode.id)}else r.$maskRect||(r.$maskRect=new t.Rectangle),r.$maskRect.copyFrom(e),t.nativeRender&&r.$nativeNode.setMaskRect(e.x,e.y,e.width,e.height),r.$mask&&(r.$mask.$maskedObject=null,t.nativeRender||r.$mask.updateRenderMode()),r.mask&&(t.nativeRender&&r.$nativeNode.setMask(-1),r.$mask=null);else r.$mask&&(r.$mask.$maskedObject=null,t.nativeRender||r.$mask.updateRenderMode()),r.mask&&(t.nativeRender&&r.$nativeNode.setMask(-1),r.$mask=null),r.$maskRect&&(t.nativeRender&&r.$nativeNode.setMaskRect(0,0,0,0),r.$maskRect=null);t.nativeRender||r.updateRenderMode()}},enumerable:!0,configurable:!0}),i.prototype.$setMaskRect=function(e){var r=this;(e||r.$maskRect)&&(e?(r.$maskRect||(r.$maskRect=new t.Rectangle),r.$maskRect.copyFrom(e)):r.$maskRect=null)},Object.defineProperty(i.prototype,"filters",{get:function(){return this.$filters},set:function(e){var r=this,i=r.$filters;return i||e?(e&&e.length?(e=e.concat(),r.$filters=e,t.nativeRender&&r.$nativeNode.setFilters(e)):(r.$filters=null,t.nativeRender&&r.$nativeNode.setFilters(null)),void(t.nativeRender||r.updateRenderMode())):(r.$filters=null,void(t.nativeRender?r.$nativeNode.setFilters(null):r.updateRenderMode()))},enumerable:!0,configurable:!0}),i.prototype.getTransformedBounds=function(t,e){return t=t||this,this.$getTransformedBounds(t,e)},i.prototype.getBounds=function(t,e){void 0===e&&(e=!0);var r=this;return t=r.$getTransformedBounds(r,t),e&&(0!=r.$anchorOffsetX&&(t.x-=r.$anchorOffsetX),0!=r.$anchorOffsetY&&(t.y-=r.$anchorOffsetY)),t},i.prototype.$getTransformedBounds=function(e,r){var i=this,n=i.$getOriginalBounds();if(r||(r=new t.Rectangle),r.copyFrom(n),e==i)return r;var a;if(e){a=t.$TempMatrix;var o=e.$getInvertedConcatenatedMatrix();o.$preMultiplyInto(i.$getConcatenatedMatrix(),a)}else a=i.$getConcatenatedMatrix();return a.$transformBounds(r),r},i.prototype.globalToLocal=function(e,r,i){if(void 0===e&&(e=0),void 0===r&&(r=0),t.nativeRender){t.NativeDelegate.update();var n=t.NativeDelegate.globalToLocal(this.$nativeNode.id,e,r),a=n.split(","),o=parseFloat(a[0]),s=parseFloat(a[1]);return i?i.setTo(o,s):i=new t.Point(o,s),i}var h=this.$getInvertedConcatenatedMatrix();return h.transformPoint(e,r,i)},i.prototype.localToGlobal=function(e,r,i){if(void 0===e&&(e=0),void 0===r&&(r=0),t.nativeRender){t.NativeDelegate.update();var n=t.NativeDelegate.localToGlobal(this.$nativeNode.id,e,r),a=n.split(","),o=parseFloat(a[0]),s=parseFloat(a[1]);return i?i.setTo(o,s):i=new t.Point(o,s),i}var h=this.$getConcatenatedMatrix();return h.transformPoint(e,r,i)},i.prototype.$getOriginalBounds=function(){var t=this,e=t.$getContentBounds();t.$measureChildBounds(e);var r=t.$measureFiltersOffset(!1);return r&&(e.x+=r.minX,e.y+=r.minY,e.width+=-r.minX+r.maxX,e.height+=-r.minY+r.maxY),e},i.prototype.$measureChildBounds=function(t){},i.prototype.$getContentBounds=function(){var e=t.$TempRectangle;return e.setEmpty(),this.$measureContentBounds(e),e},i.prototype.$measureContentBounds=function(t){},i.prototype.$getRenderNode=function(){var t=this,e=t.$renderNode;return e?(t.$renderDirty&&(e.cleanBeforeRender(),t.$updateRenderNode(),t.$renderDirty=!1,e=t.$renderNode),e):null},i.prototype.updateRenderMode=function(){var t=this;!t.$visible||t.$alpha<=0||t.$maskedObject?t.$renderMode=1:t.filters&&t.filters.length>0?t.$renderMode=2:0!==t.$blendMode||t.$mask?t.$renderMode=3:t.$scrollRect||t.$maskRect?t.$renderMode=4:t.$renderMode=null},i.prototype.$measureFiltersOffset=function(e){for(var r=this,i=0,n=0,a=0,o=0;r;){var s=r.$filters;if(s&&s.length)for(var h=s.length,c=0;h>c;c++){var l=s[c];if("blur"==l.type){var u=l.blurX,d=l.blurY;i-=u,n-=d,a+=u,o+=d}else if("glow"==l.type){var u=l.blurX,d=l.blurY;i-=u,n-=d,a+=u,o+=d;var p=l.distance||0,f=l.angle||0,g=0,v=0;0!=p&&(g=p*t.NumberUtils.cos(f),g=g>0?Math.ceil(g):Math.floor(g),v=p*t.NumberUtils.sin(f),v=v>0?Math.ceil(v):Math.floor(v),i+=g,a+=g,n+=v,o+=v)}else if("custom"==l.type){var y=l.padding;i-=y,n-=y,a+=y,o+=y}}r=e?r.$parent:null}return i=Math.min(i,0),n=Math.min(n,0),a=Math.max(a,0),o=Math.max(o,0),{minX:i,minY:n,maxX:a,maxY:o}},i.prototype.$getConcatenatedMatrixAt=function(e,r){var i=e.$getInvertedConcatenatedMatrix();if(0===i.a||0===i.d){var n=this,a=e.$nestLevel;for(r.identity();n.$nestLevel>a;){var o=n.$scrollRect;o&&r.concat(t.$TempMatrix.setTo(1,0,0,1,-o.x,-o.y)),r.concat(n.$getMatrix()),n=n.$parent}}else i.$preMultiplyInto(r,r)},i.prototype.$updateRenderNode=function(){},i.prototype.$hitTest=function(t,e){var r=this;if(!r.$renderNode||!r.$visible||0==r.$scaleX||0==r.$scaleY)return null;var i=r.$getInvertedConcatenatedMatrix();if(0==i.a&&0==i.b&&0==i.c&&0==i.d)return null;var n=r.$getContentBounds(),a=i.a*t+i.c*e+i.tx,o=i.b*t+i.d*e+i.ty;if(n.contains(a,o)){if(!r.$children){var s=r.$scrollRect?r.$scrollRect:r.$maskRect;if(s&&!s.contains(a,o))return null;if(r.$mask&&!r.$mask.$hitTest(t,e))return null}return r}return null},i.prototype.hitTestPoint=function(e,r,i){var n=this;if(i){var a=n.$getInvertedConcatenatedMatrix(),o=a.a*e+a.c*r+a.tx,s=a.b*e+a.d*r+a.ty,h=void 0;if(t.nativeRender){var c=t.sys.customHitTestBuffer;c.resize(3,3),t.NativeDelegate.forHitTest=!0;var l=t.NativeDelegate.getCurrentBuffer();t.NativeDelegate.activateBuffer(c),t.NativeDelegate.update(),t.NativeDelegate.renderDisplayObjectWithOffset(n.$nativeNode.id,1-o,1-s);try{h=t.NativeDelegate.getPixels(1,1)}catch(u){throw new Error(t.sys.tr(1039))}return t.NativeDelegate.activateBuffer(l),t.NativeDelegate.forHitTest=!1,0===h[3]?!1:!0}var d=n.$displayList;if(d){var c=d.renderBuffer;try{h=c.getPixels(o-d.offsetX,s-d.offsetY)}catch(u){throw new Error(t.sys.tr(1039))}}else{var c=t.sys.customHitTestBuffer;c.resize(3,3);var p=t.Matrix.create();p.identity(),p.translate(1-o,1-s),t.sys.systemRenderer.render(this,c,p,!0),t.Matrix.release(p);try{h=c.getPixels(1,1)}catch(u){throw new Error(t.sys.tr(1039))}}return 0===h[3]?!1:!0}if(0==n.$scaleX||0==n.$scaleY)return!1;var a=n.$getInvertedConcatenatedMatrix(),f=n.getBounds(null,!1),o=a.a*e+a.c*r+a.tx,s=a.b*e+a.d*r+a.ty;if(f.contains(o,s)){var g=n.$scrollRect?n.$scrollRect:n.$maskRect;return g&&!g.contains(o,s)?!1:!0}return!1},i.prototype.$addListener=function(e,n,a,o,s,h){r.prototype.$addListener.call(this,e,n,a,o,s,h);var c=e==t.Event.ENTER_FRAME;if(c||e==t.Event.RENDER){var l=c?i.$enterFrameCallBackList:i.$renderCallBackList;-1==l.indexOf(this)&&l.push(this)}},i.prototype.removeEventListener=function(e,n,a,o){r.prototype.removeEventListener.call(this,e,n,a,o);var s=e==t.Event.ENTER_FRAME;if((s||e==t.Event.RENDER)&&!this.hasEventListener(e)){var h=s?i.$enterFrameCallBackList:i.$renderCallBackList,c=h.indexOf(this);-1!==c&&h.splice(c,1)}},i.prototype.dispatchEvent=function(t){if(!t.$bubbles)return r.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),i=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,i),!t.$isDefaultPrevented},i.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var r=e.concat();return r.reverse(),e=r.concat(e)},i.prototype.$dispatchPropagationEvent=function(t,e,r){for(var i=e.length,n=r-1,a=0;i>a;a++){var o=e[a];if(t.$currentTarget=o,n>a?t.$eventPhase=1:a==r||a==n?t.$eventPhase=2:t.$eventPhase=3,o.$notifyListener(t,r>a),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},i.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},i.defaultTouchEnabled=!1,i.$enterFrameCallBackList=[],i.$renderCallBackList=[],i}(t.EventDispatcher);t.DisplayObject=r,__reflect(r.prototype,"egret.DisplayObject")}(egret||(egret={}));var egret;!function(t){function e(){return""}function r(t){throw new Error("#"+t)}function i(){}function n(){}t.getString=e,t.$error=r,t.$warn=i,t.$markCannotUse=n}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.$touchChildren=!0,t.$children=[],t}return __extends(r,e),Object.defineProperty(r.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),r.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},r.prototype.addChildAt=function(t,e){return e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},r.prototype.$doAddChild=function(e,i,n){void 0===n&&(n=!0);var a=this,o=e.$parent;if(o==a)return a.doSetChildIndex(e,i),e;o&&o.removeChild(e),a.$children.splice(i,0,e),e.$setParent(a);var s=a.$stage;if(s&&e.$onAddToStage(s,a.$nestLevel+1),n&&e.dispatchEventWith(t.Event.ADDED,!0),s)for(var h=r.$EVENT_ADD_TO_STAGE_LIST;h.length;){var c=h.shift();c.$stage&&n&&c.dispatchEventWith(t.Event.ADDED_TO_STAGE)}if(t.nativeRender)a.$nativeNode.addChildAt(e.$nativeNode.id,i);else if(!a.$cacheDirty){a.$cacheDirty=!0;var l=a.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var u=a.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return this.$childAdded(e,i),e},r.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},r.prototype.getChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$children[t]:null},r.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},r.prototype.getChildByName=function(t){for(var e,r=this.$children,i=r.length,n=0;i>n;n++)if(e=r[n],e.name==t)return e;return null},r.prototype.removeChild=function(t){var e=this.$children.indexOf(t);return e>=0?this.$doRemoveChild(e):null},r.prototype.removeChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$doRemoveChild(t):null},r.prototype.$doRemoveChild=function(e,i){void 0===i&&(i=!0),e=0|+e;var n=this,a=this.$children,o=a[e];if(this.$childRemoved(o,e),i&&o.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){o.$onRemoveFromStage();for(var s=r.$EVENT_REMOVE_FROM_STAGE_LIST;s.length>0;){var h=s.shift();i&&h.$hasAddToStage&&(h.$hasAddToStage=!1,h.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),h.$hasAddToStage=!1,h.$stage=null}}this.$displayList||this.$parentDisplayList;o.$setParent(null);var c=a.indexOf(o);if(-1!=c&&a.splice(c,1),t.nativeRender)n.$nativeNode.removeChild(o.$nativeNode.id);else if(!n.$cacheDirty){n.$cacheDirty=!0;var l=n.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var u=n.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return o},r.prototype.setChildIndex=function(t,e){e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},r.prototype.doSetChildIndex=function(e,r){var i=this,n=this.$children.indexOf(e);if(n!=r)if(this.$childRemoved(e,n),this.$children.splice(n,1),this.$children.splice(r,0,e),this.$childAdded(e,r),t.nativeRender)this.$nativeNode.removeChild(e.$nativeNode.id),this.$nativeNode.addChildAt(e.$nativeNode.id,r);else if(!i.$cacheDirty){i.$cacheDirty=!0;var a=i.$parent;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp());var o=i.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}},r.prototype.swapChildrenAt=function(t,e){t=0|+t,e=0|+e,t>=0&&t<this.$children.length&&e>=0&&e<this.$children.length&&this.doSwapChildrenAt(t,e)},r.prototype.swapChildren=function(t,e){var r=this.$children.indexOf(t),i=this.$children.indexOf(e);-1==r||-1==i||this.doSwapChildrenAt(r,i)},r.prototype.doSwapChildrenAt=function(e,r){var i=this;if(e>r){var n=r;r=e,e=n}else if(e==r)return;var a=this.$children,o=a[e],s=a[r];if(this.$childRemoved(o,e),this.$childRemoved(s,r),a[e]=s,a[r]=o,this.$childAdded(s,e),this.$childAdded(o,r),t.nativeRender)this.$nativeNode.swapChild(e,r);else if(!i.$cacheDirty){i.$cacheDirty=!0;var h=i.$parent;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp());var c=i.$maskedObject;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp())}},r.prototype.removeChildren=function(){for(var t=this.$children,e=t.length-1;e>=0;e--)this.$doRemoveChild(e)},r.prototype.$childAdded=function(t,e){},r.prototype.$childRemoved=function(t,e){},r.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r);var i=this.$children,n=i.length;r++;for(var a=0;n>a;a++){var o=this.$children[a];o.$onAddToStage(t,r)}},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,r=t.length,i=0;r>i;i++){var n=t[i];n.$onRemoveFromStage()}},r.prototype.$measureChildBounds=function(e){var r=this.$children,i=r.length;if(0!=i){for(var n=0,a=0,o=0,s=0,h=!1,c=-1;i>c;c++){var l=-1==c?e:r[c].$getTransformedBounds(this,t.$TempRectangle);l.isEmpty()||(h?(n=Math.min(n,l.x),a=Math.max(a,l.x+l.width),o=Math.min(o,l.y),s=Math.max(s,l.y+l.height)):(h=!0,n=l.x,a=n+l.width,o=l.y,s=o+l.height))}e.setTo(n,o,a-n,s-o)}},Object.defineProperty(r.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),r.prototype.$getTouchChildren=function(){return this.$touchChildren},r.prototype.$setTouchChildren=function(t){return this.$touchChildren==t?!1:(this.$touchChildren=t,!0)},r.prototype.$hitTest=function(t,r){if(!this.$visible)return null;var i=this.$getInvertedConcatenatedMatrix(),n=i.a*t+i.c*r+i.tx,a=i.b*t+i.d*r+i.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(t,r))return null;for(var s=this.$children,h=!1,c=null,l=s.length-1;l>=0;l--){var u=s[l];if(!u.$maskedObject&&(c=u.$hitTest(t,r))){if(h=!0,c.$touchEnabled)break;c=null}}return c?this.$touchChildren?c:this:h?this:e.prototype.$hitTest.call(this,t,r)},r.$EVENT_ADD_TO_STAGE_LIST=[],r.$EVENT_REMOVE_FROM_STAGE_LIST=[],r}(t.DisplayObject);t.DisplayObjectContainer=e,__reflect(e.prototype,"egret.DisplayObjectContainer")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i,n){var a=t.call(this)||this;return a.$eventPhase=2,a.$currentTarget=null,a.$target=null,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$type=e,a.$bubbles=!!r,a.$cancelable=!!i,a.data=n,a}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),e.prototype.$setTarget=function(t){return this.$target=t,!0},e.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},e.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},e.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},e.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},e.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},e.dispatchEvent=function(t,r,i,n){void 0===i&&(i=!1);var a=e.create(e,r,i),o=e._getPropertyData(e);void 0!=n&&(o.data=n);var s=t.dispatchEvent(a);return e.release(a),s},e._getPropertyData=function(t){var e=t._props;return e||(e=t._props={}),e},e.create=function(t,e,r,i){var n=t.eventPool;if(n||(n=t.eventPool=[]),n.length){var a=n.pop();return a.$type=e,a.$bubbles=!!r,a.$cancelable=!!i,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$eventPhase=2,a}return new t(e,r,i)},e.release=function(t){t.clean();var e=Object.getPrototypeOf(t).constructor;e.eventPool.push(t)},e.ADDED_TO_STAGE="addedToStage",e.REMOVED_FROM_STAGE="removedFromStage",e.ADDED="added",e.REMOVED="removed",e.ENTER_FRAME="enterFrame",e.RENDER="render",e.RESIZE="resize",e.CHANGE="change",e.CHANGING="changing",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e.ENDED="ended",e.ACTIVATE="activate",e.DEACTIVATE="deactivate",e.CLOSE="close",e.CONNECT="connect",e.LEAVE_STAGE="leaveStage",e.SOUND_COMPLETE="soundComplete",e}(t.HashObject);t.Event=e,__reflect(e.prototype,"egret.Event")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.type=null,r.$id=null,r.paddingTop=0,r.paddingBottom=0,r.paddingLeft=0,r.paddingRight=0,r.$uniforms={},t.nativeRender&&t.NativeNode.createFilter(r),r}return __extends(r,e),r.prototype.$toJson=function(){return""},r.prototype.updatePadding=function(){},r.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),t.nativeRender&&(t.NativeNode.setFilterPadding(e.$id,e.paddingTop,e.paddingBottom,e.paddingLeft,e.paddingRight),t.NativeNode.setDataToFilter(e.$id))},r}(t.HashObject);t.Filter=e,__reflect(e.prototype,"egret.Filter")}(egret||(egret={}));var egret;!function(t){function e(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t}t.createMap=e}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.PERMISSION_DENIED="permissionDenied",e.UNAVAILABLE="unavailable",e
}(t.Event);t.GeolocationEvent=e,__reflect(e.prototype,"egret.GeolocationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),e.call(this,t,r,i)||this}return __extends(r,e),r.dispatchIOErrorEvent=function(e){var i=t.Event.create(r,r.IO_ERROR),n=e.dispatchEvent(i);return t.Event.release(i),n},r.IO_ERROR="ioError",r}(t.Event);t.IOErrorEvent=e,__reflect(e.prototype,"egret.IOErrorEvent")}(egret||(egret={}));var egret;!function(t){var e=[],r=Math.PI/180,i=function(i){function n(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var r=i.call(this)||this;return r.x=t,r.y=e,r}return __extends(n,i),n.release=function(t){t&&e.push(t)},n.create=function(t,r){var i=e.pop();return i||(i=new n),i.setTo(t,r)},Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),n.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},n.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},n.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.interpolate=function(t,e,r){var i=1-r;return new n(t.x*r+e.x*i,t.y*r+e.y*i)},n.prototype.normalize=function(t){if(0!=this.x||0!=this.y){var e=t/this.length;this.x*=e,this.y*=e}},n.prototype.offset=function(t,e){this.x+=t,this.y+=e},n.polar=function(e,i){return new n(e*t.NumberUtils.cos(i/r),e*t.NumberUtils.sin(i/r))},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},n}(t.HashObject);t.Point=i,__reflect(i.prototype,"egret.Point"),t.$TempPoint=new i}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this)||this;return i._bitmapX=0,i._bitmapY=0,i._textureMap=t.createMap(),i.$texture=r,i._bitmapX=r.$bitmapX-r.$offsetX,i._bitmapY=r.$bitmapY-r.$offsetY,i}return __extends(r,e),r.prototype.getTexture=function(t){return this._textureMap[t]},r.prototype.createTexture=function(e,r,i,n,a,o,s,h,c){void 0===o&&(o=0),void 0===s&&(s=0),void 0===h&&(h=o+n),void 0===c&&(c=s+a);var l=new t.Texture;return l.disposeBitmapData=!1,l.$bitmapData=this.$texture.$bitmapData,l.$initData(this._bitmapX+r,this._bitmapY+i,n,a,o,s,h,c,this.$texture.$sourceWidth,this.$texture.$sourceHeight),this._textureMap[e]=l,l},r.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},r}(t.HashObject);t.SpriteSheet=e,__reflect(e.prototype,"egret.SpriteSheet")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i,n,a,o,s,h){void 0===e&&(e=16711680),void 0===r&&(r=1),void 0===i&&(i=6),void 0===n&&(n=6),void 0===a&&(a=2),void 0===o&&(o=1),void 0===s&&(s=!1),void 0===h&&(h=!1);var c=t.call(this)||this,l=c;return l.type="glow",l.$color=e,l.$blue=255&e,l.$green=(65280&e)>>8,l.$red=e>>16,l.$alpha=r,l.$blurX=i,l.$blurY=n,l.$strength=a,l.$quality=o,l.$inner=s,l.$knockout=h,l.$uniforms.color={x:c.$red/255,y:c.$green/255,z:c.$blue/255,w:1},l.$uniforms.alpha=r,l.$uniforms.blurX=i,l.$uniforms.blurY=n,l.$uniforms.strength=a,l.$uniforms.inner=s?1:0,l.$uniforms.knockout=h?0:1,l.$uniforms.dist=0,l.$uniforms.angle=0,l.$uniforms.hideObject=0,l.onPropertyChange(),c}return __extends(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.$uniforms.color.x=this.$red/255,this.$uniforms.color.y=this.$green/255,this.$uniforms.color.z=this.$blue/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.$uniforms.alpha=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.$uniforms.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.$uniforms.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.$uniforms.strength=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.$uniforms.inner=t?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.$uniforms.knockout=t?0:1)},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},e.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},e}(t.Filter);t.GlowFilter=e,__reflect(e.prototype,"egret.GlowFilter")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(egret||(egret={})),function(t){var e;!function(e){function r(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var n=t.$locale_strings[t.$language][e];if(!n)return"{"+e+"}";for(var a=r.length,o=0;a>o;o++)n=n.replace("{"+o+"}",r[o]);return n}e.tr=r}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){t.$TextureScaleFactor=1;var e=function(e){function r(){var t=e.call(this)||this;return t.disposeBitmapData=!0,t.$bitmapX=0,t.$bitmapY=0,t.$bitmapWidth=0,t.$bitmapHeight=0,t.$offsetX=0,t.$offsetY=0,t.$textureWidth=0,t.$textureHeight=0,t.$sourceWidth=0,t.$sourceHeight=0,t.$bitmapData=null,t.$rotated=!1,t}return __extends(r,e),Object.defineProperty(r.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),r.prototype.$getTextureWidth=function(){return this.$textureWidth},Object.defineProperty(r.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),r.prototype.$getTextureHeight=function(){return this.$textureHeight},r.prototype.$getScaleBitmapWidth=function(){return this.$bitmapWidth*t.$TextureScaleFactor},r.prototype.$getScaleBitmapHeight=function(){return this.$bitmapHeight*t.$TextureScaleFactor},Object.defineProperty(r.prototype,"bitmapData",{get:function(){return this.$bitmapData},set:function(t){this._setBitmapData(t)},enumerable:!0,configurable:!0}),r.prototype._setBitmapData=function(e){this.$bitmapData=e;var r=t.$TextureScaleFactor,i=e.width*r,n=e.height*r;this.$initData(0,0,i,n,0,0,i,n,e.width,e.height)},r.prototype.$initData=function(e,r,i,n,a,o,s,h,c,l,u){void 0===u&&(u=!1);var d=t.$TextureScaleFactor;this.$bitmapX=e/d,this.$bitmapY=r/d,this.$bitmapWidth=i/d,this.$bitmapHeight=n/d,this.$offsetX=a,this.$offsetY=o,this.$textureWidth=s,this.$textureHeight=h,this.$sourceWidth=c,this.$sourceHeight=l,this.$rotated=u,t.BitmapData.$invalidate(this.$bitmapData)},r.prototype.getPixel32=function(t,e){throw new Error},r.prototype.getPixels=function(t,e,r,i){throw void 0===r&&(r=1),void 0===i&&(i=1),new Error},r.prototype.toDataURL=function(t,e,r){throw new Error},r.prototype.saveToFile=function(t,e,r){throw new Error},r.prototype.dispose=function(){this.$bitmapData&&(this.disposeBitmapData&&this.$bitmapData.$dispose(),this.$bitmapData=null),t.nativeRender&&t.NativeNode.disposeTexture(this)},r}(t.HashObject);t.Texture=e,__reflect(e.prototype,"egret.Texture")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(i){var n=e.call(this)||this;return n.$texture=null,n.$bitmapData=null,n.$bitmapX=0,n.$bitmapY=0,n.$bitmapWidth=0,n.$bitmapHeight=0,n.$offsetX=0,n.$offsetY=0,n.$textureWidth=0,n.$textureHeight=0,n.$sourceWidth=0,n.$sourceHeight=0,n.$smoothing=r.defaultSmoothing,n.$explicitBitmapWidth=0/0,n.$explicitBitmapHeight=0/0,n.$scale9Grid=null,n.$fillMode="scale",n._pixelHitTest=!1,n.$renderNode=new t.sys.NormalBitmapNode,n.$setTexture(i),i&&(n.$renderNode.rotated=i.$rotated),n}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(1)},r.prototype.$onAddToStage=function(r,i){e.prototype.$onAddToStage.call(this,r,i);var n=this.$texture;n&&t.BitmapData.$addDisplayObject(this,n.$bitmapData)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var r=this.$texture;r&&t.BitmapData.$removeDisplayObject(this,r.$bitmapData)},Object.defineProperty(r.prototype,"texture",{get:function(){return this.$texture},set:function(t){var e=this;e.$setTexture(t),t&&e.$renderNode&&(e.$renderNode.rotated=t.$rotated)},enumerable:!0,configurable:!0}),r.prototype.$setTexture=function(e){var r=this,i=r.$texture;if(e==i)return!1;if(r.$texture=e,!e){i&&t.BitmapData.$removeDisplayObject(r,i.$bitmapData),r.setImageData(null,0,0,0,0,0,0,0,0,0,0),r.$renderDirty=!0;var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;return a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp()),t.nativeRender&&this.setBitmapDataToWasm(null),!0}if(r.$refreshImageData(),r.$stage){if(i){var o=i.$bitmapData.hashCode,s=e.$bitmapData.hashCode;if(o==s){r.$renderDirty=!0;var h=r.$parent;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp());var c=r.$maskedObject;return c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp()),!0}t.BitmapData.$removeDisplayObject(r,i.$bitmapData)}t.BitmapData.$addDisplayObject(r,e.$bitmapData)}r.$renderDirty=!0;var l=r.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var u=r.$maskedObject;return u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp()),!0},r.prototype.$setBitmapData=function(t){this.$setTexture(t)},r.prototype.setBitmapDataToWasm=function(t){this.$nativeNode.setBitmapData(t)},r.prototype.$refreshImageData=function(){var e=this.$texture;e?(t.nativeRender&&this.setBitmapDataToWasm(e),this.setImageData(e.$bitmapData,e.$bitmapX,e.$bitmapY,e.$bitmapWidth,e.$bitmapHeight,e.$offsetX,e.$offsetY,e.$getTextureWidth(),e.$getTextureHeight(),e.$sourceWidth,e.$sourceHeight)):t.nativeRender&&this.setBitmapDataToWasm(null)},r.prototype.setImageData=function(t,e,r,i,n,a,o,s,h,c,l){this.$bitmapData=t,this.$bitmapX=e,this.$bitmapY=r,this.$bitmapWidth=i,this.$bitmapHeight=n,this.$offsetX=a,this.$offsetY=o,this.$textureWidth=s,this.$textureHeight=h,this.$sourceWidth=c,this.$sourceHeight=l},Object.defineProperty(r.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t)},enumerable:!0,configurable:!0}),r.prototype.$setScale9Grid=function(e){var r=this;if(r.$scale9Grid=e,r.$renderDirty=!0,t.nativeRender)e?r.$nativeNode.setScale9Grid(e.x,e.y,e.width,e.height):r.$nativeNode.setScale9Grid(0,0,-1,-1);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),r.prototype.$setFillMode=function(t){return t==this.$fillMode?!1:(this.$fillMode=t,!0)},Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t,this.$renderNode.smoothing=t)},enumerable:!0,configurable:!0}),r.prototype.$setWidth=function(e){var r=this;if(0>e||e==r.$explicitBitmapWidth)return!1;if(r.$explicitBitmapWidth=e,r.$renderDirty=!0,t.nativeRender)r.$nativeNode.setWidth(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},r.prototype.$setHeight=function(e){var r=this;if(0>e||e==r.$explicitBitmapHeight)return!1;if(r.$explicitBitmapHeight=e,r.$renderDirty=!0,t.nativeRender)r.$nativeNode.setHeight(e);else{var i=r.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=r.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},r.prototype.$getWidth=function(){return isNaN(this.$explicitBitmapWidth)?this.$getContentBounds().width:this.$explicitBitmapWidth},r.prototype.$getHeight=function(){return isNaN(this.$explicitBitmapHeight)?this.$getContentBounds().height:this.$explicitBitmapHeight},r.prototype.$measureContentBounds=function(t){if(this.$bitmapData){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight;t.setTo(0,0,e,r)}else{var e=isNaN(this.$explicitBitmapWidth)?0:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?0:this.$explicitBitmapHeight;t.setTo(0,0,e,r)}},r.prototype.$updateRenderNode=function(){if(this.$texture){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,i=this.scale9Grid||this.$texture.scale9Grid;i?(this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureDataWithScale9Grid(this.$renderNode,this.$bitmapData,i,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,r,this.$sourceWidth,this.$sourceHeight,this.$smoothing)):(this.fillMode==t.BitmapFillMode.REPEAT&&this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureData(this.$renderNode,this.$bitmapData,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,r,this.$sourceWidth,this.$sourceHeight,this.$fillMode,this.$smoothing))}},Object.defineProperty(r.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),r.prototype.$hitTest=function(t,r){var i=e.prototype.$hitTest.call(this,t,r);if(i&&this._pixelHitTest){var n=this.hitTestPoint(t,r,!0);n||(i=null)}return i},r.defaultSmoothing=!0,r}(t.DisplayObject);t.Bitmap=e,__reflect(e.prototype,"egret.Bitmap")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.drawData=[],this.renderCount=0}return t.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},t.prototype.$getRenderCount=function(){return this.renderCount},t}();t.RenderNode=e,__reflect(e.prototype,"egret.sys.RenderNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}return t.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var r=this.dataPosition;this.$data[r++]=t,this.$data[r++]=e,this.dataPosition=r},t.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var r=this.dataPosition;this.$data[r++]=t,this.$data[r++]=e,this.dataPosition=r},t.prototype.curveTo=function(t,e,r,i){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=r,this.$data[n++]=i,this.dataPosition=n},t.prototype.cubicCurveTo=function(t,e,r,i,n,a){this.$commands[this.commandPosition++]=4;var o=this.dataPosition;this.$data[o++]=t,this.$data[o++]=e,this.$data[o++]=r,this.$data[o++]=i,this.$data[o++]=n,this.$data[o++]=a,this.dataPosition=o},t.prototype.drawRect=function(t,e,r,i){var n=t+r,a=e+i;this.moveTo(t,e),this.lineTo(n,e),this.lineTo(n,a),this.lineTo(t,a),this.lineTo(t,e)},t.prototype.drawRoundRect=function(t,e,r,i,n,a){var o=.5*n|0,s=a?.5*a|0:o;if(!o||!s)return void this.drawRect(t,e,r,i);var h=.5*r,c=.5*i;if(o>h&&(o=h),s>c&&(s=c),h===o&&c===s)return void(o===s?this.drawCircle(t+o,e+s,o):this.drawEllipse(t,e,2*o,2*s));var l=t+r,u=e+i,d=t+o,p=l-o,f=e+s,g=u-s;this.moveTo(l,g),this.curveTo(l,u,p,u),this.lineTo(d,u),this.curveTo(t,u,t,g),this.lineTo(t,f),this.curveTo(t,e,d,e),this.lineTo(p,e),this.curveTo(l,e,l,f),this.lineTo(l,g)},t.prototype.drawCircle=function(t,e,r){this.arcToBezier(t,e,r,r,0,2*Math.PI)},t.prototype.drawEllipse=function(t,e,r,i){var n=.5*r,a=.5*i;t+=n,e+=a,this.arcToBezier(t,e,n,a,0,2*Math.PI)},t.prototype.drawArc=function(t,e,r,i,n,a){a?n>=i&&(n-=2*Math.PI):i>=n&&(n+=2*Math.PI),this.arcToBezier(t,e,r,r,i,n,a)},t.prototype.arcToBezier=function(t,e,r,i,n,a,o){var s=.5*Math.PI,h=n,c=h;o?(c+=-s-h%s,a>c&&(c=a)):(c+=s-h%s,c>a&&(c=a));var l=t+Math.cos(h)*r,u=e+Math.sin(h)*i;(this.$lastX!=l||this.$lastY!=u)&&this.moveTo(l,u);for(var d=Math.cos(h),p=Math.sin(h),f=0;4>f;f++){var g=c-h,v=4*Math.tan(g/4)/3,y=l-p*v*r,$=u+d*v*i;d=Math.cos(c),p=Math.sin(c),l=t+d*r,u=e+p*i;var m=l+p*v*r,b=u-d*v*i;if(this.cubicCurveTo(y,$,m,b,l,u),c===a)break;h=c,o?(c=h-s,a>c&&(c=a)):(c=h+s,c>a&&(c=a))}},t}();t.Path2D=e,__reflect(e.prototype,"egret.sys.Path2D")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.DeviceOrientation=null}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.WEB="web",t.NATIVE="native"}(e=t.RuntimeType||(t.RuntimeType={}));var r=function(){function t(){}return Object.defineProperty(t,"language",{get:function(){return t.$language},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMobile",{get:function(){return t.$isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"os",{get:function(){return t.$os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"runtimeType",{get:function(){return t.$runtimeType},enumerable:!0,configurable:!0}),Object.defineProperty(t,"supportVersion",{get:function(){return t.$supportVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"engineVersion",{get:function(){return"5.1.1"},enumerable:!0,configurable:!0}),t.$setNativeCapabilities=function(e){var r=e.split("-");if(r.length<=4){var i=r[0];switch(i){case"android":i="Android";break;case"ios":i="iOS"}t.$os=i;var n=r[2].substring(1,r[2].length);t.$supportVersion=n}},Object.defineProperty(t,"renderMode",{get:function(){return t.$renderMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"boundingClientWidth",{get:function(){return t.$boundingClientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"boundingClientHeight",{get:function(){return t.$boundingClientHeight},enumerable:!0,configurable:!0}),t.$language="zh-CN",t.$os="Unknown",t.$runtimeType="Unknown",t.$supportVersion="Unknown",t.$renderMode="Unknown",t.$boundingClientWidth=0,t.$boundingClientHeight=0,t}();t.Capabilities=r,__reflect(r.prototype,"egret.Capabilities")}(egret||(egret={})),egret.Capabilities.$isMobile=function(){if(!global.navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")}(),egret.Capabilities.$runtimeType=function(){return global.navigator?!0:!1}()?egret.RuntimeType.WEB:egret.RuntimeType.NATIVE;var egret;!function(t){t.nativeRender=__global.nativeRender}(egret||(egret={})),function(t){var e;!function(e){var r,i,n,a,o,s,h,c,l,u,d,p,f,g,v;e.forHitTest=!1;var y=[],$=[],m=!1;e.addModuleCallback=function(t,e){y.push(t),$.push(e)},e.init=function(e){function v(){Module.__bitmapDataMap=R,Module.__textFieldDataMap=O,Module.__customFilterDataMap=L,f=Module.getPixels,Module.customInit(),Module.downloadBuffers(function(e,f,v,m){if(r=e,i=f,n=v,t.NativeNode.init(m,__global.nativeRender,R,M,L),a=Module.update,o=Module.render,s=Module.resize,h=Module.setRenderMode,c=Module.updateCallbackList,l=Module.renderDisplayObject,u=Module.renderDisplayObject2,d=Module.localToGlobal,p=Module.globalToLocal,g=Module.activateBuffer,b=t.getTimer(),y.length>0)for(var x=y,T=$,w=0;w<x.length;w++){var _=x[w];null!=_&&_.apply(T[w])}t.startTick(E.updatePreCallback,E)})}if(void 0===e&&(e=134217728),m){if(y.length>0)for(var x=y,T=$,w=0;w<x.length;w++){var _=x[w];null!=_&&_.apply(T[w])}}else{m=!0;var E=this;v()}},e.setRootBuffer=function(t){v=t},e.setRenderMode=function(t){h(2)},e.renderDisplayObject=function(t,e,r,i,n,a,o){l(t,e,r,i,n,a,o)},e.renderDisplayObjectWithOffset=function(t,r,i){u(t,r,i,e.forHitTest)},e.localToGlobal=function(t,e,r){return d(t,e,r)},e.globalToLocal=function(t,e,r){return p(t,e,r)},e.resize=function(t,e){s(t,e)},e.setCanvasScaleFactor=function(t,e,r){Module.setCanvasScaleFactor(t,e,r)},e.update=function(){x(),T(),t.NativeNode.update(),a&&a()},e.dirtyTextField=function(t){B.push(t),C[t.$nativeNode.id]=t},e.dirtyGraphics=function(t){F.push(t),D[t.$targetDisplay.$nativeNode.id]=t};var b,x=function(){var t=B.length;if(t>0){var e=B;B=[];for(var r=0;t>r;r++){var i=e[r];i.$getRenderNode();var n=i.$renderNode,a=n.width-n.x,o=n.height-n.y;if(0==n.drawData.length){var s=i.$graphicsNode;s?i.$nativeNode.setTextRect(s.x,s.y,s.width,s.height):i.$nativeNode.setTextRect(0,0,0,0)}else i.$nativeNode.setTextRect(n.x,n.y,a,o);E(i.$nativeNode.id)}}},T=function(){var t=F.length;if(t>0){var e=F;F=[];for(var r=0;t>r;r++){var i=e[r],n=i.$renderNode,a=n.width,o=n.height;0>=a||0>=o||!a||!o||0==n.drawData.length?i.$targetDisplay.$nativeNode.setGraphicsRect(0,0,0,0,i.$targetIsSprite):i.$targetDisplay.$nativeNode.setGraphicsRect(n.x,n.y,n.width,n.height,i.$targetIsSprite),S(i.$targetDisplay.$nativeNode.id,n)}}};e.updatePreCallback=function(t){var e=t-b;return b=t,c&&c(e),!1};e.render=function(){o&&o()};var w=function(t,e){if(-1==t.indexOf("r"))t=t.replace(/#/,""),e.color=parseInt(t,16);else{t=t.replace(/rgba\(/,""),t=t.replace(/\)/,"");var r=t.split(",");e.color=Number(r[0])<<16|Number(r[1])<<8|Number(r[2]),e.alpha=Number(r[3])}},_=function(t,e){e.push(1023);for(var r=t.$data,i=t.$commands,n=i.length,a=0,o=0;n>o;o++){var s=i[o];switch(s){case 4:e.push(1024),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]);break;case 3:e.push(1025),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]),e.push(r[a++]);break;case 2:e.push(1026),e.push(r[a++]),e.push(r[a++]);break;case 1:e.push(1027),e.push(r[a++]),e.push(r[a++])}}},E=function(e){var r=C[e],i=r.$renderNode,n=i.width-i.x,a=i.height-i.y;if(!(0>=n||0>=a)&&n&&a){var o=t.sys.DisplayList.$canvasScaleX,s=t.sys.DisplayList.$canvasScaleY,h=4096;n*o>h&&(o*=h/(n*o)),a*s>h&&(s*=h/(a*s)),n*=o,a*=s;var c=i.x*o,l=i.y*s;if(!O[e]){var u={x:i.x,y:i.y,width:i.width,height:i.height,renderCmds:[],renderParms:""};O[e]=u}var d=(-i.x,-i.y,O[e]),p=d.renderCmds;if(i.dirtyRender){p.length=0,d.renderParms="",p.push(1010),p.push(1),d.x=i.x,d.y=i.y,d.width=i.width,d.height=i.height,p.push(1011),p.push(n),p.push(a),p.push(i.x),p.push(i.y),(1!=o||1!=s)&&(p.push(1019),p.push(o),p.push(0),p.push(0),p.push(s),p.push(0),p.push(0),p.push(0)),(c||l)&&(p.push(1019),p.push(o),p.push(0),p.push(0),p.push(s),p.push(-c),p.push(-l),p.push(1)),r.$graphicsNode&&(p.push(1020),p.push(-i.x),p.push(-i.y),p.push(0),p.push(1015),S(e,r.$graphicsNode,p),p.push(1016),p.push(1020),p.push(i.x),p.push(i.y),p.push(0));for(var f=i.drawData,g=f.length,v=0;g>v;){var y=f[v++],$=f[v++],m=f[v++],b=f[v++],x=null==b.textColor?i.textColor:b.textColor,T=null==b.strokeColor?i.strokeColor:b.strokeColor,w=null==b.stroke?i.stroke:b.stroke;p.push(1012);var _=t.getFontString(i,b),E="",D=-1,R=_.split(",");if(R.length>0){for(var L=R[0].split(" "),A=0;A<L.length;A++)if(-1!=L[A].indexOf("px")){D=Number(L[A].replace(/px/,"")),E=_.substring(_.indexOf(L[A])+L[A].length+1);break}p.push(D),d.renderParms+=E,-1==_.indexOf("bold")?p.push(0):p.push(1),-1==_.indexOf("italic")?p.push(0):p.push(1),d.renderParms+=";";var M=0,B=void 0,F=void 0,P=t.toColorString(x);if(-1==P.indexOf("r"))P=P.replace(/#/,""),M=parseInt(P,16);else{P=P.replace(/rgba\(/,""),P=P.replace(/\)/,"");var N=P.split(",");B=Number(N[0])<<16|Number(N[1])<<8|Number(N[2]),F=Number(L[3])}p.push(M);var I=t.toColorString(T),k=0,H=void 0;if(-1==I.indexOf("r"))I=I.replace(/#/,""),k=parseInt(I,16);else{I=I.replace(/rgba\(/,""),I=I.replace(/\)/,"");var W=I.split(",");k=Number(W[0])<<16|Number(W[1])<<8|Number(W[2]),H=Number(L[3])}p.push(k),d.renderParms+=m,d.renderParms+=";",w&&(p.push(1013),p.push(2*w)),p.push(1014),p.push(y),p.push($)}}(c||l)&&(p.push(1019),p.push(o),p.push(0),p.push(0),p.push(s),p.push(0),p.push(0),p.push(-1)),r.$nativeNode.setDataToTextField(e,p),i.dirtyRender=!1}}},S=function(r,i,n){void 0===n&&(n=null);var a=i.width,o=i.height,s=!1;if(null===n){if(!A[r]){var h={x:i.x,y:i.y,width:i.width,height:i.height,renderCmds:[]};A[r]=h}var c=A[r];c.x=i.x,c.y=i.y,c.width=i.width,c.height=i.height,c.renderCmds.length=0,n=c.renderCmds,s=!0}var l=t.sys.DisplayList.$canvasScaleX,u=t.sys.DisplayList.$canvasScaleY;if((1>a*l||1>o*u)&&(l=u=1),(i.$canvasScaleX!=l||i.$canvasScaleY!=u)&&(i.$canvasScaleX=l,i.$canvasScaleY=u,i.dirtyRender=!0),a*=l,o*=u,i.dirtyRender||e.forHitTest){n.push(1010),n.push(1),n.push(1011),n.push(a),n.push(o),n.push(i.x),n.push(i.y),(1!=l||1!=u)&&(n.push(1019),n.push(l),n.push(0),n.push(0),n.push(u),n.push(0),n.push(0),n.push(0)),(i.x||i.y)&&(n.push(1020),n.push(-i.x),n.push(-i.y),n.push(1));for(var d=i.drawData,p=d.length,f={color:0,alpha:1},g=0;p>g;g++){var v=d[g];switch(f.color=0,f.alpha=1,v.type){case 1:var y=v;w(e.forHitTest?t.BLACK_COLOR:t.getRGBAString(y.fillColor,y.fillAlpha),f),n.push(1021),n.push(f.color),n.push(f.alpha),_(v,n),n.push(1028);break;case 2:break;case 3:var $=v,m=$.lineWidth;w(e.forHitTest?t.BLACK_COLOR:t.getRGBAString($.lineColor,$.lineAlpha),f),n.push(1022),n.push(f.color),n.push(f.alpha),n.push(m);var b=1===m||3===m;b&&(n.push(1020),n.push(.5),n.push(.5),n.push(0)),_(v,n),n.push(1029),b&&(n.push(1020),n.push(-.5),n.push(-.5),n.push(0))}}(i.x||i.y)&&(n.push(1020),n.push(i.x),n.push(i.y),n.push(-1)),s&&D[r].$targetDisplay.$nativeNode.setGraphicsRenderData(n),e.forHitTest||(i.dirtyRender=!1)}};e.activateWebGLBuffer=function(t){t||(t=v),g(t.bufferIdForWasm,t.width,t.height)},e.getCurrentBuffer=function(){return e.currentWebGLBuffer},e.getPixels=function(t,e,r,i){void 0===r&&(r=1),void 0===i&&(i=1);var n=new Uint8Array(4*r*i);return f(t,e,r,i,n),n},e.activateBuffer=function(t){e.activateWebGLBuffer(t)};var C=t.createMap(),D=t.createMap(),R={},O={},L={},A={},M=t.createMap(),B=[],F=[]}(e=t.NativeDelegate||(t.NativeDelegate={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(t,e,r){var i=t.prototype;i.__class__=e;var n=[e];r&&(n=n.concat(r));var a=i.__types__;if(i.__types__)for(var o=a.length,s=0;o>s;s++){var h=a[s];-1==n.indexOf(h)&&n.push(h)}i.__types__=n}t.registerClass=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$graphics=new t.Graphics,r.$graphics.$setTarget(r),r}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(9)},Object.defineProperty(r.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),r.prototype.$hitTest=function(e,r){if(!this.$visible)return null;var i=this.$getInvertedConcatenatedMatrix(),n=i.a*e+i.c*r+i.tx,a=i.b*e+i.d*r+i.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(e,r))return null;for(var s=this.$children,h=!1,c=null,l=s.length-1;l>=0;l--){var u=s[l];if(!u.$maskedObject&&(c=u.$hitTest(e,r))){if(h=!0,c.$touchEnabled)break;c=null}}return c?this.$touchChildren?c:this:h?this:(c=t.DisplayObject.prototype.$hitTest.call(this,e,r),c&&(c=this.$graphics.$hitTest(e,r)),c)},r.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},r}(t.DisplayObjectContainer);t.Sprite=e,__reflect(e.prototype,"egret.Sprite")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"logLevel",{set:function(t){},enumerable:!0,configurable:!0}),t.ALL="all",t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error",t.OFF="off",t}();t.Logger=e,__reflect(e.prototype,"egret.Logger")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function t(){}return t.call=function(t,e){},t.addCallback=function(t,e){},t}();e.WebExternalInterface=r,__reflect(r.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]);var i=navigator.userAgent.toLowerCase();i.indexOf("egretnative")<0&&(t.ExternalInterface=r)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){function r(e){var r=JSON.parse(e),n=r.functionName,a=i[n];if(a){var o=r.value;a.call(null,o)}else t.$warn(1050,n)}var i={},n=function(){function t(){}return t.call=function(t,e){var r={};r.functionName=t,r.value=e,egret_native.sendInfoToPlugin(JSON.stringify(r))},t.addCallback=function(t,e){i[t]=e},t}();e.NativeExternalInterface=n,__reflect(n.prototype,"egret.web.NativeExternalInterface",["egret.ExternalInterface"]);var a=navigator.userAgent.toLowerCase();a.indexOf("egretnative")>=0&&(t.ExternalInterface=n,egret_native.receivedPluginInfo=r)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var r={},i=function(){function e(){}return e.call=function(t,e){__global.ExternalInterface.call(t,e)},e.addCallback=function(t,e){r[t]=e},e.invokeCallback=function(e,i){var n=r[e];n?n.call(null,i):t.$warn(1050,e)},e}();e.WebViewExternalInterface=i,__reflect(i.prototype,"egret.web.WebViewExternalInterface",["egret.ExternalInterface"]);var n=navigator.userAgent.toLowerCase();n.indexOf("egretwebview")>=0&&(t.ExternalInterface=i)}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(t,n,a){void 0===t&&(t=4),void 0===n&&(n=4),void 0===a&&(a=1);var o=e.call(this)||this,s=o;return s.type="blur",s.$blurX=t,s.$blurY=n,s.$quality=a,s.blurXFilter=new r(t),s.blurYFilter=new i(n),s.onPropertyChange(),o}return __extends(n,e),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.blurXFilter.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.blurYFilter.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),n.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},n.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},n.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),t.nativeRender&&(t.NativeNode.setFilterPadding(e.blurXFilter.$id,0,0,e.paddingLeft,e.paddingRight),t.NativeNode.setFilterPadding(e.blurYFilter.$id,e.paddingTop,e.paddingBottom,0,0),t.NativeNode.setDataToFilter(e.$id))},n}(t.Filter);
t.BlurFilter=e,__reflect(e.prototype,"egret.BlurFilter");var r=function(e){function r(r){void 0===r&&(r=4);var i=e.call(this)||this;return t.nativeRender?i.type="blur":i.type="blurX",i.$uniforms.blur={x:r,y:0},i.onPropertyChange(),i}return __extends(r,e),Object.defineProperty(r.prototype,"blurX",{get:function(){return this.$uniforms.blur.x},set:function(t){this.$uniforms.blur.x=t},enumerable:!0,configurable:!0}),r}(t.Filter);__reflect(r.prototype,"BlurXFilter",["egret.IBlurXFilter"]);var i=function(e){function r(r){void 0===r&&(r=4);var i=e.call(this)||this;return t.nativeRender?i.type="blur":i.type="blurY",i.$uniforms.blur={x:0,y:r},i.onPropertyChange(),i}return __extends(r,e),Object.defineProperty(r.prototype,"blurY",{get:function(){return this.$uniforms.blur.y},set:function(t){this.$uniforms.blur.y=t},enumerable:!0,configurable:!0}),r}(t.Filter);__reflect(i.prototype,"BlurYFilter",["egret.IBlurYFilter"])}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.$matrix=[],r.matrix2=[],r.type="colorTransform",r.$uniforms.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.$uniforms.colorAdd={x:0,y:0,z:0,w:0},r.setMatrix(e),r.onPropertyChange(),r}return __extends(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){for(var t=0;20>t;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t)},enumerable:!0,configurable:!0}),e.prototype.setMatrix=function(t){if(t)for(var e=0;20>e;e++)this.$matrix[e]=t[e];else for(var e=0;20>e;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0;for(var r=this.$matrix,i=this.$uniforms.matrix,n=this.$uniforms.colorAdd,e=0,a=0;e<r.length;e++)4===e?n.x=r[e]/255:9===e?n.y=r[e]/255:14===e?n.z=r[e]/255:19===e?n.w=r[e]/255:(i[a]=r[e],a++)},e.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},e}(t.Filter);t.ColorMatrixFilter=e,__reflect(e.prototype,"egret.ColorMatrixFilter")}(egret||(egret={}));var egret;!function(t){var e,r={},i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),a=0,o=function(){for(var t=0;36>t;t++)8===t||13===t||18===t||23===t?n[t]="-":14===t?n[t]="4":(2>=a&&(a=33554432+16777216*Math.random()|0),e=15&a,a>>=4,n[t]=i[19===t?3&e|8:e]);return n.join("")},s=function(e){function i(t,i,n){void 0===n&&(n={});var a=e.call(this)||this;a.$padding=0,a.$vertexSrc=t,a.$fragmentSrc=i;var s=t+i;return r[s]||(r[s]=o()),a.$shaderKey=r[s],a.$uniforms=n,a.type="custom",a}return __extends(i,e),Object.defineProperty(i.prototype,"padding",{get:function(){return this.$padding},set:function(t){var e=this;e.$padding!=t&&(e.$padding=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"uniforms",{get:function(){return this.$uniforms},enumerable:!0,configurable:!0}),i.prototype.onPropertyChange=function(){if(t.nativeRender){var e=this;t.NativeNode.setFilterPadding(e.$id,e.$padding,e.$padding,e.$padding,e.$padding),t.NativeNode.setDataToFilter(e.$id)}},i}(t.Filter);t.CustomFilter=s,__reflect(s.prototype,"egret.CustomFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n,a,o,s,h,c,l,u){void 0===t&&(t=4),void 0===r&&(r=45),void 0===i&&(i=0),void 0===n&&(n=1),void 0===a&&(a=4),void 0===o&&(o=4),void 0===s&&(s=1),void 0===h&&(h=1),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===u&&(u=!1);var d=e.call(this,i,n,a,o,s,h,c,l)||this,p=d;return p.$distance=t,p.$angle=r,p.$hideObject=u,p.$uniforms.dist=t,p.$uniforms.angle=r/180*Math.PI,p.$uniforms.hideObject=u?1:0,p.onPropertyChange(),d}return __extends(r,e),Object.defineProperty(r.prototype,"distance",{get:function(){return this.$distance},set:function(t){var e=this;e.$distance!=t&&(e.$distance=t,e.$uniforms.dist=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"angle",{get:function(){return this.$angle},set:function(t){var e=this;e.$angle!=t&&(e.$angle=t,e.$uniforms.angle=t/180*Math.PI,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.$uniforms.hideObject=t?1:0)},enumerable:!0,configurable:!0}),r.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},r.prototype.updatePadding=function(){var e=this;e.paddingLeft=e.blurX,e.paddingRight=e.blurX,e.paddingTop=e.blurY,e.paddingBottom=e.blurY;var r=e.distance||0,i=e.angle||0,n=0,a=0;0!=r&&(n=r*t.NumberUtils.cos(i),n=n>0?Math.ceil(n):Math.floor(n),a=r*t.NumberUtils.sin(i),a=a>0?Math.ceil(a):Math.floor(a),e.paddingLeft+=n,e.paddingRight+=n,e.paddingTop+=a,e.paddingBottom+=a)},r}(t.GlowFilter);t.DropShadowFilter=e,__reflect(e.prototype,"egret.DropShadowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this,r)||this;return i._verticesDirty=!0,i._bounds=new t.Rectangle,i.$renderNode=new t.sys.MeshNode,i}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(12)},r.prototype.setBitmapDataToWasm=function(t){this.$nativeNode.setBitmapDataToMesh(t)},r.prototype.$updateRenderNode=function(){var e=this.$bitmapData;if(e){var r=(t.$TextureScaleFactor,this.$renderNode);r.smoothing=this.$smoothing,r.image=e,r.imageWidth=this.$sourceWidth,r.imageHeight=this.$sourceHeight;var i=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,n=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,a=i/this.$textureWidth,o=n/this.$textureHeight,s=this.$bitmapWidth,h=this.$bitmapHeight;r.drawMesh(this.$bitmapX,this.$bitmapY,s,h,this.$offsetX*a,this.$offsetY*o,a*s,o*h)}},r.prototype.$updateVertices=function(){var e=this;if(e._verticesDirty=!0,e.$renderDirty=!0,t.nativeRender){var r=this.$renderNode;this.$nativeNode.setDataToMesh(r.vertices,r.indices,r.uvs)}else{var i=e.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var n=e.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},r.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,r=e.vertices;if(r.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var i=0,n=r.length;n>i;i+=2){var a=r[i],o=r[i+1];this._bounds.x>a&&(this._bounds.x=a),this._bounds.width<a&&(this._bounds.width=a),this._bounds.y>o&&(this._bounds.y=o),this._bounds.height<o&&(this._bounds.height=o)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},r}(t.Bitmap);t.Mesh=e,__reflect(e.prototype,"egret.Mesh")}(egret||(egret={}));var egret;!function(t){t.OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"}}(egret||(egret={}));var egret;!function(t){var e=Math.PI,r=2*e,i=e/180,n=[],a=function(a){function o(t,e,r,i,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=0);var s=a.call(this)||this;return s.a=t,s.b=e,s.c=r,s.d=i,s.tx=n,s.ty=o,s}return __extends(o,a),o.release=function(t){t&&n.push(t)},o.create=function(){var t=n.pop();return t||(t=new o),t},o.prototype.clone=function(){return new o(this.a,this.b,this.c,this.d,this.tx,this.ty)},o.prototype.concat=function(t){var e=this.a*t.a,r=0,i=0,n=this.d*t.d,a=this.tx*t.a+t.tx,o=this.ty*t.d+t.ty;(0!==this.b||0!==this.c||0!==t.b||0!==t.c)&&(e+=this.b*t.c,n+=this.c*t.b,r+=this.a*t.b+this.b*t.d,i+=this.c*t.a+this.d*t.c,a+=this.ty*t.c,o+=this.tx*t.b),this.a=e,this.b=r,this.c=i,this.d=n,this.tx=a,this.ty=o},o.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},o.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},o.prototype.invert=function(){this.$invertInto(this)},o.prototype.$invertInto=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,a=this.tx,o=this.ty;if(0==r&&0==i)return t.b=t.c=0,void(0==e||0==n?t.a=t.d=t.tx=t.ty=0:(e=t.a=1/e,n=t.d=1/n,t.tx=-e*a,t.ty=-n*o));var s=e*n-r*i;if(0==s)return void t.identity();s=1/s;var h=t.a=n*s;r=t.b=-r*s,i=t.c=-i*s,n=t.d=e*s,t.tx=-(h*a+i*o),t.ty=-(r*a+n*o)},o.prototype.rotate=function(e){if(e=+e,0!==e){e/=i;var r=t.NumberUtils.cos(e),n=t.NumberUtils.sin(e),a=this.a,o=this.b,s=this.c,h=this.d,c=this.tx,l=this.ty;this.a=a*r-o*n,this.b=a*n+o*r,this.c=s*r-h*n,this.d=s*n+h*r,this.tx=c*r-l*n,this.ty=c*n+l*r}},o.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},o.prototype.setTo=function(t,e,r,i,n,a){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=a,this},o.prototype.transformPoint=function(e,r,i){var n=this.a*e+this.c*r+this.tx,a=this.b*e+this.d*r+this.ty;return i?(i.setTo(n,a),i):new t.Point(n,a)},o.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},o.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},o.prototype.prepend=function(t,e,r,i,n,a){var o=this.tx;if(1!=t||0!=e||0!=r||1!=i){var s=this.a,h=this.c;this.a=s*t+this.b*r,this.b=s*e+this.b*i,this.c=h*t+this.d*r,this.d=h*e+this.d*i}return this.tx=o*t+this.ty*r+n,this.ty=o*e+this.ty*i+a,this},o.prototype.append=function(t,e,r,i,n,a){var o=this.a,s=this.b,h=this.c,c=this.d;return(1!=t||0!=e||0!=r||1!=i)&&(this.a=t*o+e*h,this.b=t*s+e*c,this.c=r*o+i*h,this.d=r*s+i*c),this.tx=n*o+a*h+this.tx,this.ty=n*s+a*c+this.ty,this},o.prototype.deltaTransformPoint=function(e){var r=this,i=r.a*e.x+r.c*e.y,n=r.b*e.x+r.d*e.y;return new t.Point(i,n)},o.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},o.prototype.createBox=function(e,r,n,a,o){void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=0);var s=this;if(0!==n){n/=i;var h=t.NumberUtils.cos(n),c=t.NumberUtils.sin(n);s.a=h*e,s.b=c*r,s.c=-c*e,s.d=h*r}else s.a=e,s.b=0,s.c=0,s.d=r;s.tx=a,s.ty=o},o.prototype.createGradientBox=function(t,e,r,i,n){void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=0),this.createBox(t/1638.4,e/1638.4,r,i+t/2,n+e/2)},o.prototype.$transformBounds=function(t){var e=this.a,r=this.b,i=this.c,n=this.d,a=this.tx,o=this.ty,s=t.x,h=t.y,c=s+t.width,l=h+t.height,u=e*s+i*h+a,d=r*s+n*h+o,p=e*c+i*h+a,f=r*c+n*h+o,g=e*c+i*l+a,v=r*c+n*l+o,y=e*s+i*l+a,$=r*s+n*l+o,m=0;u>p&&(m=u,u=p,p=m),g>y&&(m=g,g=y,y=m),t.x=Math.floor(g>u?u:g),t.width=Math.ceil((p>y?p:y)-t.x),d>f&&(m=d,d=f,f=m),v>$&&(m=v,v=$,$=m),t.y=Math.floor(v>d?d:v),t.height=Math.ceil((f>$?f:$)-t.y)},o.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},o.prototype.$getScaleX=function(){var t=this;if(1==t.a&&0==t.b)return 1;var e=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-e:e},o.prototype.$getScaleY=function(){var t=this;if(0==t.c&&1==t.d)return 1;var e=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-e:e},o.prototype.$getSkewX=function(){return Math.atan2(this.d,this.c)-e/2},o.prototype.$getSkewY=function(){return Math.atan2(this.b,this.a)},o.prototype.$updateScaleAndRotation=function(e,n,a,o){if(!(0!=a&&a!=r||0!=o&&o!=r))return this.a=e,this.b=this.c=0,void(this.d=n);a/=i,o/=i;var s=t.NumberUtils.cos(a),h=t.NumberUtils.sin(a);a==o?(this.a=s*e,this.b=h*e):(this.a=t.NumberUtils.cos(o)*e,this.b=t.NumberUtils.sin(o)*e),this.c=-h*n,this.d=s*n},o.prototype.$preMultiplyInto=function(t,e){var r=t.a*this.a,i=0,n=0,a=t.d*this.d,o=t.tx*this.a+this.tx,s=t.ty*this.d+this.ty;(0!==t.b||0!==t.c||0!==this.b||0!==this.c)&&(r+=t.b*this.c,a+=t.c*this.b,i+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,o+=t.ty*this.c,s+=t.tx*this.b),e.a=r,e.b=i,e.c=n,e.d=a,e.tx=o,e.ty=s},o}(t.HashObject);t.Matrix=a,__reflect(a.prototype,"egret.Matrix"),t.$TempMatrix=new a}(egret||(egret={}));var egret;!function(t){var e=[],r=function(r){function i(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var a=r.call(this)||this;return a.x=t,a.y=e,a.width=i,a.height=n,a}return __extends(i,r),i.release=function(t){t&&e.push(t)},i.create=function(){var t=e.pop();return t||(t=new i),t},Object.defineProperty(i.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),i.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},i.prototype.setTo=function(t,e,r,i){return this.x=t,this.y=e,this.width=r,this.height=i,this},i.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},i.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},i.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},i.prototype.$intersectInPlace=function(t){var e=this.x,r=this.y,i=t.x,n=t.y,a=Math.max(e,i),o=Math.min(e+this.width,i+t.width);if(o>=a){var s=Math.max(r,n),h=Math.min(r+this.height,n+t.height);if(h>=s)return this.setTo(a,s,o-a,h-s),this}return this.setEmpty(),this},i.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},i.prototype.isEmpty=function(){return this.width<=0||this.height<=0},i.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>t.x&&this.y<=t.y&&this.y+this.height>t.y?!0:!1},i.prototype.containsRect=function(t){var e=t.x+t.width,r=t.y+t.height,i=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<i&&t.y>=this.y&&t.y<n&&e>this.x&&i>=e&&r>this.y&&n>=r},i.prototype.equals=function(t){return this===t?!0:this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},i.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},i.prototype.offset=function(t,e){this.x+=t,this.y+=e},i.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},i.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},i.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var r=Math.min(e.x,t.x),i=Math.min(e.y,t.y);return e.setTo(r,i,Math.max(e.right,t.right)-r,Math.max(e.bottom,t.bottom)-i),e},i.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t));return e*this.width+r*this.height},i.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t));return r*this.width+e*this.height},i}(t.HashObject);t.Rectangle=r,__reflect(r.prototype,"egret.Rectangle"),t.$TempRectangle=new r}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[1001]="Could not find Egret entry class: {0}。",e[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",e[1003]="Parameter {0} must be non-null.",e[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",e[1005]="An object cannot be added as a child of itself.",e[1006]="The supplied DisplayObject must be a child of the caller.",e[1007]="An index specified for a parameter was out of range.",e[1008]="Instantiate singleton error，singleton class {0} can not create multiple instances.",e[1009]='the Class {0} cannot use the property "{1}"',e[1010]='the property "{1}" of the Class "{0}" is readonly',e[1011]="Stream Error. URL: {0}",e[1012]="The type of parameter {0} must be Class.",e[1013]="Variable assignment is NaN, please see the code!",e[1014]='the constant "{1}" of the Class "{0}" is read-only',e[1015]="xml not found!",e[1016]="{0}has been obsoleted",e[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",e[1018]="the scale9Grid is not correct",e[1019]="Network ab:{0}",e[1020]="Cannot initialize Shader",e[1021]="Current browser does not support webgl",e[1022]="{0} ArgumentError",e[1023]="This method is not available in the ScrollView!",e[1025]="end of the file",e[1026]="! EncodingError The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="Photos can not be used across domains toDataURL to convert base64",e[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',e[1035]="Native does not support this feature!",e[1036]="Sound has stopped, please recall Sound.play () to play the sound!",e[1037]="Non-load the correct blob!",e[1038]="XML format error!",e[1039]="Cross domains pictures can not get pixel information!",e[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",e[1041]="{0} is deprecated, please use {1} replace",e[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",e[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[1044]="The current version of the Runtime does not support video playback, please use the latest version",e[1045]="The resource url is not found",e[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",e[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",e[1048]="Video loading failed",e[1049]="In the absence of sound is not allowed to play after loading",e[1050]="ExternalInterface calls the method without js registration: {0}",e[3e3]="Theme configuration file failed to load: {0}",e[3001]="Cannot find the skin name which is configured in Theme: {0}",e[3002]='Index:"{0}" is out of the collection element index range',e[3003]="Cannot be available in this component. If this component is container, please continue to use",e[3004]="addChild(){0}addElement() replace",e[3005]="addChildAt(){0}addElementAt() replace",e[3006]="removeChild(){0}removeElement() replace",e[3007]="removeChildAt(){0}removeElementAt() replace",e[3008]="setChildIndex(){0}setElementIndex() replace",e[3009]="swapChildren(){0}swapElements() replace",e[3010]="swapChildrenAt(){0}swapElementsAt() replace",e[3011]='Index:"{0}" is out of the visual element index range',e[3012]="This method is not available in Scroller component!",e[3013]="UIStage is GUI root container, and only one such instant is in the display list！",e[3014]="set fullscreen error",e[3100]="Current browser does not support WebSocket",e[3101]="Please connect Socket firstly",e[3102]="Please set the type of binary type",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;r.$renderBuffer=new t.sys.RenderBuffer;var i=new t.BitmapData(r.$renderBuffer.surface);return i.$deleteSource=!1,r._setBitmapData(i),r}return __extends(r,e),r.prototype.drawToTexture=function(e,r,i){if(void 0===i&&(i=1),r&&(0==r.width||0==r.height))return!1;var n=r||e.$getOriginalBounds();if(0==n.width||0==n.height)return!1;i/=t.$TextureScaleFactor;var a=(n.x+n.width)*i,o=(n.y+n.height)*i;r&&(a=n.width*i,o=n.height*i);var s=this.$renderBuffer;if(!s)return!1;if(s.resize(a,o),this.$bitmapData.width=a,this.$bitmapData.height=o,t.nativeRender){var h=t.NativeDelegate.getCurrentBuffer();t.NativeDelegate.activateBuffer(this.$renderBuffer);var c=!1,l=0,u=0,d=0,p=0;r&&(c=!0,l=r.x,u=r.y,d=r.width,p=r.height),t.NativeDelegate.update(),t.NativeDelegate.renderDisplayObject(e.$nativeNode.id,i,c,l,u,d,p),t.NativeDelegate.activateBuffer(h)}else{var f=t.Matrix.create();f.identity(),r&&f.translate(-r.x,-r.y),f.scale(i,i),t.sys.systemRenderer.render(e,s,f,!0),t.Matrix.release(f)}return this.$initData(0,0,a,o,0,0,a,o,a,o),!0},r.prototype.getPixel32=function(e,r){var i;if(this.$renderBuffer){var n=t.$TextureScaleFactor;e=Math.round(e/n),r=Math.round(r/n),i=this.$renderBuffer.getPixels(e,r,1,1)}return i},r.prototype.dispose=function(){e.prototype.dispose.call(this),this.$renderBuffer=null},r}(t.Texture);t.RenderTexture=e,__reflect(e.prototype,"egret.RenderTexture")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};var e=t.$locale_strings.zh_CN;e[1001]="找不到Egret入口类: {0}。",e[1002]="Egret入口类 {0} 必须继承自egret.DisplayObject。",e[1003]="参数 {0} 不能为 null。",e[1004]="无法将对象添加为它的一个子对象（或子对象的子对象等）的子对象。",e[1005]="不能将对象添加为其自身的子对象。",e[1006]="提供的 DisplayObject 必须是调用者的子级。",e[1007]="为参数指定的索引不在范围内。",e[1008]="实例化单例出错，不允许实例化多个 {0} 对象。",e[1009]="类 {0} 不可以使用属性 {1}",e[1010]="类 {0} 属性 {1} 是只读的",e[1011]="流错误。URL: {0}",e[1012]="参数 {0} 的类型必须为 Class。",e[1013]="变量赋值为NaN，请查看代码！",e[1014]="类 {0} 常量 {1} 是只读的",e[1015]="xml not found!",e[1016]="{0}已经废弃",e[1017]="JSON文件格式不正确: {0}\ndata: {1}",e[1018]="9宫格设置错误",e[1019]="网络异常:{0}",e[1020]="无法初始化着色器",e[1021]="当前浏览器不支持webgl",e[1022]="{0} ArgumentError",e[1023]="此方法在ScrollView内不可用!",e[1025]="遇到文件尾",e[1026]="EncodingError! The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]="调用了未配置的注入规则:{0}。 请先在项目初始化里配置指定的注入规则，再调用对应单例。",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="跨域图片不可以使用toDataURL来转换成base64",e[1034]='音乐文件解码失败："{0}"，请使用标准的转换工具重新转换下mp3。',e[1035]="Native 下暂未实现此功能！",e[1036]="声音已停止，请重新调用 Sound.play() 来播放声音！",e[1037]="非正确的blob加载！",e[1038]="XML 格式错误!",e[1039]="跨域图片不能获取像素信息!",e[1040]="hitTestPoint 不能对跨域图片进行检测! 请检查该显示对象内是否含有跨域元素",e[1041]="{0} 已废弃,请使用 {1} 代替",e[1042]="drawToTexture方法传入的区域各个参数需要为整数,否则某些浏览器绘制会出现异常",e[1043]="{0} 中存在编译错误，属性名 : {1}，属性值 : {2}",e[1044]="当前的 runtime 版本不支持视频播放,请使用最新的版本",e[1045]="没有设置要加载的资源地址",e[1046]="BitmapText 找不到对应字符:{0}，请检查配置文件",e[1047]="egret.localStorage.setItem保存失败,key={0}&value={1}",e[1048]="视频加载失败",e[1049]="声音在没有加载完之前不允许播放",e[1050]="ExternalInterface调用了js没有注册的方法: {0}",e[3e3]="主题配置文件加载失败: {0}",e[3001]="找不到主题中所配置的皮肤类名: {0}",e[3002]='索引:"{0}"超出集合元素索引范围',e[3003]="在此组件中不可用，若此组件为容器类，请使用",e[3004]="addChild(){0}addElement()代替",e[3005]="addChildAt(){0}addElementAt()代替",e[3006]="removeChild(){0}removeElement()代替",e[3007]="removeChildAt(){0}removeElementAt()代替",e[3008]="setChildIndex(){0}setElementIndex()代替",e[3009]="swapChildren(){0}swapElements()代替",e[3010]="swapChildrenAt(){0}swapElementsAt()代替",e[3011]='索引:"{0}"超出可视元素索引范围',e[3012]="此方法在Scroller组件内不可用!",e[3013]="UIStage是GUI根容器，只能有一个此实例在显示列表中！",e[3014]="设置全屏模式失败",e[3100]="当前浏览器不支持WebSocket",e[3101]="请先连接WebSocket",e[3102]="请先设置type为二进制类型",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$graphics=new t.Graphics,r.$graphics.$setTarget(r),r}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(8)},Object.defineProperty(r.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),r.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},r.prototype.$hitTest=function(t,r){var i=e.prototype.$hitTest.call(this,t,r);return i==this&&(i=this.$graphics.$hitTest(t,r)),i},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},r}(t.DisplayObject);t.Shape=e,__reflect(e.prototype,"egret.Shape")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r;!function(r){function i(t){return window.localStorage.getItem(t)}function n(e,r){try{return window.localStorage.setItem(e,r),!0}catch(i){return t.$warn(1047,e,r),!1}}function a(t){window.localStorage.removeItem(t)}function o(){window.localStorage.clear()}e.getItem=i,e.setItem=n,e.removeItem=a,e.clear=o}(r=e.web||(e.web={}))}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t){i.indexOf(t)<0&&i.push(t)}function r(t){var e=i.indexOf(t);return e>=0?(i.splice(e,1),!0):!1}var i=[];t.$pushSoundChannel=e,t.$popSoundChannel=r}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){}(egret||(egret={}));var egret;!function(t){t.BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"}}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t.loaded=!1,t}return __extends(i,r),Object.defineProperty(i.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),i.prototype.load=function(e){function r(){a(),h.indexOf("firefox")>=0&&(s.pause(),s.muted=!1),o.loaded=!0,o.dispatchEventWith(t.Event.COMPLETE)}function n(){a(),o.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}function a(){s.removeEventListener("canplaythrough",r),s.removeEventListener("error",n)}var o=this;this.url=e;var s=new Audio(e);s.addEventListener("canplaythrough",r),s.addEventListener("error",n);var h=navigator.userAgent.toLowerCase();h.indexOf("firefox")>=0&&(s.autoplay=!0,s.muted=!0),s.load(),this.originAudio=s,i.clearAudios[this.url]&&delete i.clearAudios[this.url],i.$recycle(this.url,s)},i.prototype.play=function(r,n){r=+r||0,n=+n||0;var a=i.$pop(this.url);null==a&&(a=this.originAudio.cloneNode()),a.autoplay=!0;var o=new e.HtmlSoundChannel(a);return o.$url=this.url,o.$loops=n,o.$startTime=r,o.$play(),t.sys.$pushSoundChannel(o),o},i.prototype.close=function(){0==this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),i.$clear(this.url)},i.$clear=function(t){i.clearAudios[t]=!0;var e=i.audios[t];e&&(e.length=0)},i.$pop=function(t){var e=i.audios[t];return e&&e.length>0?e.pop():null},i.$recycle=function(t,e){if(!i.clearAudios[t]){var r=i.audios[t];null==i.audios[t]&&(r=i.audios[t]=[]),r.push(e)}},i.MUSIC="music",i.EFFECT="effect",i.audios={},i.clearAudios={},i}(t.EventDispatcher);e.HtmlSound=r,__reflect(r.prototype,"egret.web.HtmlSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(e){var i=r.call(this)||this;return i.$startTime=0,i.audio=null,i.isStopped=!1,i.canPlay=function(){i.audio.removeEventListener("canplay",i.canPlay);try{i.audio.currentTime=i.$startTime}catch(t){}finally{i.audio.play()}},i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(t.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._volume=1,e.addEventListener("ended",i.onPlayEnd),i.audio=e,i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(e){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()},i.prototype.stop=function(){if(this.audio){this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0;var r=this.audio;r.removeEventListener("ended",this.onPlayEnd),r.volume=0,this._volume=0,this.audio=null;var i=this.$url;window.setTimeout(function(){r.pause(),e.HtmlSound.$recycle(i,r)},200)}},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.audio&&(this.audio.volume=e)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.HtmlSoundChannel=r,__reflect(r.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function t(){}return t.decodeAudios=function(){if(!(t.decodeArr.length<=0||t.isDecoding)){t.isDecoding=!0;var e=t.decodeArr.shift();t.ctx.decodeAudioData(e.buffer,function(r){e.self.audioBuffer=r,e.success&&e.success(),t.isDecoding=!1,t.decodeAudios()},function(){alert("sound decode error: "+e.url+"！\nsee http://edn.egret.com/cn/docs/page/156"),e.fail&&e.fail(),t.isDecoding=!1,t.decodeAudios()})}},t.decodeArr=[],t.isDecoding=!1,t}();e.WebAudioDecode=r,__reflect(r.prototype,"egret.web.WebAudioDecode");var i=function(i){function n(){var t=i.call(this)||this;return t.loaded=!1,t}return __extends(n,i),Object.defineProperty(n.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(e){function i(){a.loaded=!0,a.dispatchEventWith(t.Event.COMPLETE)}function n(){a.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}var a=this;this.url=e;var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.onreadystatechange=function(){if(4==o.readyState){var e=o.status>=400||0==o.status;e?a.dispatchEventWith(t.IOErrorEvent.IO_ERROR):(r.decodeArr.push({buffer:o.response,success:i,fail:n,self:a,url:a.url}),r.decodeAudios())}},o.send()},n.prototype.play=function(r,i){r=+r||0,i=+i||0;var n=new e.WebAudioSoundChannel;return n.$url=this.url,n.$loops=i,n.$audioBuffer=this.audioBuffer,n.$startTime=r,n.$play(),t.sys.$pushSoundChannel(n),n},n.prototype.close=function(){},n.MUSIC="music",n.EFFECT="effect",n}(t.EventDispatcher);e.WebAudioSound=i,__reflect(i.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var i=r.call(this)||this;return i.$startTime=0,i.bufferSource=null,i.context=e.WebAudioDecode.ctx,i.isStopped=!1,i._currentTime=0,i._volume=1,i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(t.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._startTime=0,i.context.createGain?i.gain=i.context.createGain():i.gain=i.context.createGainNode(),i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var e=this.context,r=this.gain,i=e.createBufferSource();this.bufferSource=i,i.buffer=this.$audioBuffer,i.connect(r),r.connect(e.destination),i.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,i.start(0,this.$startTime),this._currentTime=0},i.prototype.stop=function(){if(this.bufferSource){var e=this.bufferSource;
e.stop?e.stop(0):e.noteOff(0),e.onended=null,e.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.gain.gain.value=e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.WebAudioSoundChannel=r,__reflect(r.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i){void 0===i&&(i=!0);var n=e.call(this)||this;return n.loaded=!1,n.closed=!1,n.heightSet=0/0,n.widthSet=0/0,n.waiting=!1,n.userPause=!1,n.userPlay=!1,n.isPlayed=!1,n.screenChanged=function(e){var r=document.fullscreenEnabled||document.webkitIsFullScreen;r||(n.checkFullScreen(!1),t.Capabilities.isMobile||(n._fullscreen=r))},n._fullscreen=!0,n.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var e=n.video;n.loaded=!0,n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),e.width=e.videoWidth,e.height=e.videoHeight,window.setTimeout(function(){n.dispatchEventWith(t.Event.COMPLETE)},200)},n.$renderNode=new t.sys.BitmapNode,n.src=r,n.once(t.Event.ADDED_TO_STAGE,n.loadPoster,n),r&&n.load(),n}return __extends(r,e),r.prototype.load=function(e,r){var i=this;if(void 0===r&&(r=!0),e=e||this.src,this.src=e,!this.video||this.video.src!=e){var n;!this.video||t.Capabilities.isMobile?(n=document.createElement("video"),this.video=n,n.controls=null):n=this.video,n.src=e,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.addEventListener("canplay",this.onVideoLoaded),n.addEventListener("error",function(){return i.onVideoError()}),n.addEventListener("ended",function(){return i.onVideoEnded()});var a=!1;n.addEventListener("canplay",function(){i.waiting=!1,a?i.userPause?i.pause():i.userPlay&&i.play():(a=!0,n.pause())}),n.addEventListener("waiting",function(){i.waiting=!0}),n.load(),this.videoPlay(),n.style.position="absolute",n.style.top="0px",n.style.zIndex="-88888",n.style.left="0px",n.height=1,n.width=1}},r.prototype.play=function(e,r){var i=this;if(void 0===r&&(r=!1),0==this.loaded)return this.load(this.src),void this.once(t.Event.COMPLETE,function(t){return i.play(e,r)},this);this.isPlayed=!0;var n=this.video;void 0!=e&&(n.currentTime=+e||0),n.loop=!!r,t.Capabilities.isMobile?n.style.zIndex="-88888":n.style.zIndex="9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=t.Capabilities.os&&"Mac OS"!=t.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.checkFullScreen(this._fullscreen)},r.prototype.videoPlay=function(){return this.userPause=!1,this.waiting?void(this.userPlay=!0):(this.userPlay=!1,void this.video.play())},r.prototype.checkFullScreen=function(e){var r=this.video;if(e)null==r.parentElement&&(r.removeAttribute("webkit-playsinline"),document.body.appendChild(r)),t.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=r.parentElement&&r.parentElement.removeChild(r),r.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),t.startTick(this.markDirty,this),t.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();this.videoPlay()},r.prototype.goFullscreen=function(){var e,r=this.video;return e=t.web.getPrefixStyleName("requestFullscreen",r),r[e]||(e=t.web.getPrefixStyleName("requestFullScreen",r),r[e])?(r.removeAttribute("webkit-playsinline"),r[e](),this.setFullScreenMonitor(!0),!0):!0},r.prototype.setFullScreenMonitor=function(t){var e=this.video;t?(e.addEventListener("mozfullscreenchange",this.screenChanged),e.addEventListener("webkitfullscreenchange",this.screenChanged),e.addEventListener("mozfullscreenerror",this.screenError),e.addEventListener("webkitfullscreenerror",this.screenError)):(e.removeEventListener("mozfullscreenchange",this.screenChanged),e.removeEventListener("webkitfullscreenchange",this.screenChanged),e.removeEventListener("mozfullscreenerror",this.screenError),e.removeEventListener("webkitfullscreenerror",this.screenError))},r.prototype.screenError=function(){t.$error(3014)},r.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},r.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.dispatchEventWith(t.Event.ENDED)},r.prototype.onVideoError=function(){this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},r.prototype.close=function(){var t=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return t.onVideoError()}),this.video.removeEventListener("ended",function(){return t.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},r.prototype.pause=function(){return this.userPlay=!1,this.waiting?void(this.userPause=!0):(this.userPause=!1,void t.stopTick(this.markDirty,this))},Object.defineProperty(r.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video&&(this.video.currentTime=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(e){t.Capabilities.isMobile||(this._fullscreen=!!e,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new t.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),r.prototype.loadPoster=function(){var e=this,r=this.poster;if(r){var i=new t.ImageLoader;i.once(t.Event.COMPLETE,function(t){i.data;e.posterData=i.data,e.$renderDirty=!0,e.posterData.width=e.getPlayWidth(),e.posterData.height=e.getPlayHeight()},this),i.load(r)}},r.prototype.$measureContentBounds=function(t){var e=this.bitmapData,r=this.posterData;e?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):r?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},r.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},r.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},r.prototype.$updateRenderNode=function(){var e=this.$renderNode,r=this.bitmapData,i=this.posterData,n=this.getPlayWidth(),a=this.getPlayHeight();this.isPlayed&&!t.Capabilities.isMobile||!i?this.isPlayed&&r&&(e.image=r,e.imageWidth=r.width,e.imageHeight=r.height,t.WebGLUtils.deleteWebGLTexture(r.webGLTexture),r.webGLTexture=null,e.drawImage(0,0,r.width,r.height,0,0,n,a)):(e.image=i,e.imageWidth=n,e.imageHeight=a,e.drawImage(0,0,i.width,i.height,0,0,n,a))},r.prototype.markDirty=function(){return this.$renderDirty=!0,!0},r.prototype.$setHeight=function(t){this.heightSet=t,e.prototype.$setHeight.call(this,t)},r.prototype.$setWidth=function(t){this.widthSet=t,e.prototype.$setWidth.call(this,t)},Object.defineProperty(r.prototype,"paused",{get:function(){return this.video?this.video.paused:!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),r}(t.DisplayObject);e.WebVideo=r,__reflect(r.prototype,"egret.web.WebVideo",["egret.Video","egret.DisplayObject"]),t.Video=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.GET="GET",t.POST="POST",t}();t.HttpMethod=e,__reflect(e.prototype,"egret.HttpMethod")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.ARRAY_BUFFER="arraybuffer",t}();t.HttpResponseType=e,__reflect(e.prototype,"egret.HttpResponseType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NORMAL="normal",t.ADD="add",t.ERASE="erase",t}();t.BlendMode=e,__reflect(e.prototype,"egret.BlendMode")}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=n[t];return void 0===e?0:e}function r(t){var e=i[t];return void 0===e?"normal":e}for(var i=["normal","add","erase"],n={},a=i.length,o=0;a>o;o++){var s=i[o];n[s]=o}t.blendModeToNumber=e,t.numberToBlendMode=r}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t._url="",t._method="",t}return __extends(r,e),Object.defineProperty(r.prototype,"response",{get:function(){if(!this._xhr)return null;if(void 0!=this._xhr.response)return this._xhr.response;if("text"==this._responseType)return this._xhr.responseText;if("arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)){var t=window;return t.convertResponseBodyToText(this._xhr.responseBody)}return"document"==this._responseType?this._xhr.responseXML:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),r.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},r.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e,this._xhr&&(this._xhr.abort(),this._xhr=null),this._xhr=this.getXHR(),this._xhr.onreadystatechange=this.onReadyStateChange.bind(this),this._xhr.onprogress=this.updateProgress.bind(this),this._xhr.open(this._method,this._url,!0)},r.prototype.send=function(t){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var e in this.headerObj)this._xhr.setRequestHeader(e,this.headerObj[e]);this._xhr.send(t)},r.prototype.abort=function(){this._xhr&&this._xhr.abort()},r.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var t=this._xhr.getAllResponseHeaders();return t?t:""},r.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},r.prototype.getResponseHeader=function(t){if(!this._xhr)return null;var e=this._xhr.getResponseHeader(t);return e?e:""},r.prototype.onReadyStateChange=function(){var e=this._xhr;if(4==e.readyState){var r=e.status>=400||0==e.status,i=(this._url,this);window.setTimeout(function(){r?i.dispatchEventWith(t.IOErrorEvent.IO_ERROR):i.dispatchEventWith(t.Event.COMPLETE)},0)}},r.prototype.updateProgress=function(e){e.lengthComputable&&t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.PROGRESS,e.loaded,e.total)},r}(t.EventDispatcher);e.WebHttpRequest=r,__reflect(r.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),t.HttpRequest=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=window.URL||window.webkitURL,i=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t._hasCrossOriginSet=!1,t.currentImage=null,t.request=null,t}return __extends(n,i),Object.defineProperty(n.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._hasCrossOriginSet=!0,this._crossOrigin=t},enumerable:!0,configurable:!0}),n.prototype.load=function(r){if(e.Html5Capatibility._canUseBlob&&0!=r.indexOf("wxLocalResource:")&&0!=r.indexOf("data:")&&0!=r.indexOf("http:")&&0!=r.indexOf("https:")){var i=this.request;i||(i=this.request=new t.web.WebHttpRequest,i.addEventListener(t.Event.COMPLETE,this.onBlobLoaded,this),i.addEventListener(t.IOErrorEvent.IO_ERROR,this.onBlobError,this),i.responseType="blob"),i.open(r),i.send()}else this.loadImage(r)},n.prototype.onBlobLoaded=function(t){var e=this.request.response;this.request=void 0,this.loadImage(r.createObjectURL(e))},n.prototype.onBlobError=function(t){this.dispatchIOError(this.currentURL),this.request=void 0},n.prototype.loadImage=function(t){var e=new Image;this.data=null,this.currentImage=e,this._hasCrossOriginSet?this._crossOrigin&&(e.crossOrigin=this._crossOrigin):n.crossOrigin&&(e.crossOrigin=n.crossOrigin),e.onload=this.onImageComplete.bind(this),e.onerror=this.onLoadError.bind(this),e.src=t},n.prototype.onImageComplete=function(e){var r=this.getImage(e);if(r){this.data=new t.BitmapData(r);var i=this;window.setTimeout(function(){i.dispatchEventWith(t.Event.COMPLETE)},0)}},n.prototype.onLoadError=function(t){var e=this.getImage(t);e&&this.dispatchIOError(e.src)},n.prototype.dispatchIOError=function(e){var r=this;window.setTimeout(function(){r.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},0)},n.prototype.getImage=function(e){var i=e.target,n=i.src;if(0==n.indexOf("blob:"))try{r.revokeObjectURL(i.src)}catch(a){t.$warn(1037)}return i.onerror=null,i.onload=null,this.currentImage!==i?null:(this.currentImage=null,i)},n.crossOrigin=null,n}(t.EventDispatcher);e.WebImageLoader=i,__reflect(i.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),t.ImageLoader=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(i){var n=r.call(this)||this;return n.isStage=!1,n.$renderNode=new e.BitmapNode,n.renderBuffer=null,n.offsetX=0,n.offsetY=0,n.offsetMatrix=new t.Matrix,n.needUpdateRegions=!1,n.$canvasScaleX=1,n.$canvasScaleY=1,n.root=i,n.isStage=i instanceof t.Stage,n}return __extends(i,r),i.create=function(r){var i=new t.sys.DisplayList(r);try{var n=new e.RenderBuffer;i.renderBuffer=n}catch(a){return null}return i.root=r,i},i.prototype.$getRenderNode=function(){return this.$renderNode},i.prototype.setClipRect=function(t,e){t*=i.$canvasScaleX,e*=i.$canvasScaleY,this.renderBuffer.resize(t,e)},i.prototype.drawToSurface=function(){var r=0;this.$canvasScaleX=this.offsetMatrix.a=i.$canvasScaleX,this.$canvasScaleY=this.offsetMatrix.d=i.$canvasScaleY,this.isStage||this.changeSurfaceSize();var n=this.renderBuffer;if(n.clear(),r=e.systemRenderer.render(this.root,n,this.offsetMatrix),!this.isStage){var a=n.surface,o=this.$renderNode;o.drawData.length=0;var s=a.width,h=a.height;this.bitmapData?(this.bitmapData.source=a,this.bitmapData.width=s,this.bitmapData.height=h):this.bitmapData=new t.BitmapData(a),o.image=this.bitmapData,o.imageWidth=s,o.imageHeight=h,o.drawImage(0,0,s,h,-this.offsetX,-this.offsetY,s/this.$canvasScaleX,h/this.$canvasScaleY)}return r},i.prototype.changeSurfaceSize=function(){var t=(this.root,this.offsetX),e=this.offsetY,r=this.root.$getOriginalBounds(),i=this.$canvasScaleX,n=this.$canvasScaleY;this.offsetX=-r.x,this.offsetY=-r.y,this.offsetMatrix.setTo(this.offsetMatrix.a,0,0,this.offsetMatrix.d,this.offsetX,this.offsetY);var a=this.renderBuffer,o=Math.max(257,r.width*i),s=Math.max(257,r.height*n);(this.offsetX!=t||this.offsetY!=e||a.surface.width!=o||a.surface.height!=s)&&a.resize(o,s)},i.$setCanvasScale=function(e,r){i.$canvasScaleX=e,i.$canvasScaleY=r,t.nativeRender&&t.NativeDelegate.setCanvasScaleFactor(i.$canvasScaleFactor,e,r)},i.$canvasScaleFactor=1,i.$canvasScaleX=1,i.$canvasScaleY=1,i}(t.HashObject);e.DisplayList=r,__reflect(r.prototype,"egret.sys.DisplayList")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$stageWidth=0,r.$stageHeight=0,r.$scaleMode=t.StageScaleMode.SHOW_ALL,r.$orientation=t.OrientationMode.AUTO,r.$maxTouches=99,r.$stage=r,r.$nestLevel=1,r}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(13)},Object.defineProperty(r.prototype,"frameRate",{get:function(){return t.ticker.$frameRate},set:function(e){t.ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),r.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},r.prototype.registerImplementation=function(e,r){t.registerImplementation(e,r)},r.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(r.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dirtyRegionPolicy",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),r.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},r}(t.DisplayObjectContainer);t.Stage=e,__reflect(e.prototype,"egret.Stage")}(egret||(egret={}));var egret;!function(t){t.CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"}}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(r,n,h,c){if(n&&(t.log=function(){for(var t=arguments.length,r="",n=0;t>n;n++)r+=arguments[n]+" ";e.$logToFPS(r),console.log.apply(console,i(arguments))}),o=c?{}:c,n=!!n,this.showFPS=!!r,this.showLog=n,!this.fps){var l=void 0===c.x?0:c.x,u=void 0===c.y?0:c.y;a=this.fps=new FPS(this.stage,r,n,h,c),a.x=l,a.y=u;for(var d=s.length,p=0;d>p;p++)a.updateInfo(s[p]);s=null}}function i(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}var n=function(i){function n(e,n,a){var o=i.call(this)||this;return o.isPlaying=!1,o.entryClassName=a,o.stage=n,o.screenDisplayList=o.createDisplayList(n,e),o.showFPS=!1,o.showLog=!1,o.stageDisplayList=null,o.displayFPS=r,t.nativeRender&&t.NativeDelegate.setRootBuffer(e),o}return __extends(n,i),n.prototype.createDisplayList=function(t,r){var i=new e.DisplayList(t);return i.renderBuffer=r,t.$displayList=i,i},n.prototype.start=function(){!this.isPlaying&&this.stage&&(e.$TempStage=e.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),t.ticker.$addPlayer(this))},n.prototype.initialize=function(){var e;if(this.entryClassName&&(e=t.getDefinitionByName(this.entryClassName)),e){var r=new e;this.root=r,r instanceof t.DisplayObject&&this.stage.addChild(r)}},n.prototype.stop=function(){this.pause(),this.stage=null},n.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,t.ticker.$removePlayer(this))},n.prototype.$render=function(e,r){if(t.nativeRender)return t.NativeDelegate.update(),void t.NativeDelegate.render();(this.showFPS||this.showLog)&&this.stage.addChild(this.fps);var i=this.stage,n=t.getTimer(),a=i.$displayList.drawToSurface(),o=t.getTimer();e&&this.showFPS&&this.fps.update(a,o-n,r)},n.prototype.updateStageSize=function(e,r){var i=this.stage;i.$stageWidth=e,i.$stageHeight=r,t.nativeRender?t.NativeDelegate.resize(e,r):(this.screenDisplayList.setClipRect(e,r),this.stageDisplayList&&this.stageDisplayList.setClipRect(e,r)),i.dispatchEventWith(t.Event.RESIZE)},n}(t.HashObject);e.Player=n,__reflect(n.prototype,"egret.sys.Player");var a,o,s=[];e.$logToFPS=function(t){return a?void a.updateInfo(t):void s.push(t)};var h=function(e){function r(r,i,n,a,o){var s=e.call(this)||this;s.showFPS=i,s.showLog=n,s.logFilter=a,s.styles=o,s.infoLines=[],s.totalTime=0,s.totalTick=0,s.lastTime=0,s.drawCalls=0,s.costRender=0,s.costTicker=0,s.isFPS=!0,s.infoLines=[],s.totalTime=0,s.totalTick=0,s.lastTime=0,s.drawCalls=0,s.costRender=0,s.costTicker=0,s._stage=r,s.showFPS=i,s.showLog=n,s.logFilter=a,s.touchChildren=!1,s.touchEnabled=!1,s.styles=o,s.fpsDisplay=new t.FPSDisplay(r,i,n,a,o),s.addChild(s.fpsDisplay);var h;try{h=a?new RegExp(a):null}catch(c){t.log(c)}return s.filter=function(t){return h?h.test(t):!a||0==t.indexOf(a)},s}return __extends(r,e),r.prototype.update=function(e,r,i){var n=t.getTimer();if(this.totalTime+=n-this.lastTime,this.lastTime=n,this.totalTick++,this.drawCalls+=e,this.costRender+=r,this.costTicker+=i,this.totalTime>=1e3){var a=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),t.ticker.$frameRate),o=Math.round(this.drawCalls/this.totalTick),s=Math.round(this.costRender/this.totalTick),h=Math.round(this.costTicker/this.totalTick);this.fpsDisplay.update({fps:a,draw:o,costTicker:h,costRender:s}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.costRender=0,this.costTicker=0}},r.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},r}(t.Sprite);__reflect(h.prototype,"FPSImpl"),__global.FPS=h,t.warn=function(){console.warn.apply(console,i(arguments))},t.error=function(){console.error.apply(console,i(arguments))},t.assert=function(){console.assert.apply(console,i(arguments))},t.log=function(){console.log.apply(console,i(arguments))}}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){return e.call(this)||this}return __extends(r,e),r.prototype.calculateStageSize=function(e,r,i,n,a){var o=r,s=i,h=n,c=a,l=r/h||0,u=i/c||0;switch(e){case t.StageScaleMode.EXACT_FIT:break;case t.StageScaleMode.FIXED_HEIGHT:h=Math.round(r/u);break;case t.StageScaleMode.FIXED_WIDTH:c=Math.round(i/l);break;case t.StageScaleMode.NO_BORDER:l>u?s=Math.round(c*l):o=Math.round(h*u);break;case t.StageScaleMode.SHOW_ALL:l>u?o=Math.round(h*u):s=Math.round(c*l);break;case t.StageScaleMode.FIXED_NARROW:l>u?h=Math.round(r/u):c=Math.round(i/l);break;case t.StageScaleMode.FIXED_WIDE:l>u?c=Math.round(i/l):h=Math.round(r/u);break;default:h=r,c=i}return h%2!=0&&(h+=1),c%2!=0&&(c+=1),o%2!=0&&(o+=1),s%2!=0&&(s+=1),{stageWidth:h,stageHeight:c,displayWidth:o,displayHeight:s}},r}(t.HashObject);e.DefaultScreenAdapter=r,__reflect(r.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NO_SCALE="noScale",t.SHOW_ALL="showAll",t.NO_BORDER="noBorder",t.EXACT_FIT="exactFit",t.FIXED_WIDTH="fixedWidth",t.FIXED_HEIGHT="fixedHeight",t.FIXED_NARROW="fixedNarrow",t.FIXED_WIDE="fixedWide",t}();t.StageScaleMode=e,__reflect(e.prototype,"egret.StageScaleMode")}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.$START_TIME=0,e.$invalidateRenderFlag=!1,e.$requestRenderingFlag=!1;var r=function(){function r(){this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,this.isPaused=!1,e.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}return r.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(this.playerList=this.playerList.concat(),this.playerList.push(t))},r.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);if(-1!==e){this.playerList=this.playerList.concat(),this.playerList.splice(e,1)}},r.prototype.$startTick=function(t,e){var r=this.getTickIndex(t,e);-1==r&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},r.prototype.$stopTick=function(t,e){var r=this.getTickIndex(t,e);-1!=r&&(this.concatTick(),this.callBackList.splice(r,1),this.thisObjectList.splice(r,1))},r.prototype.getTickIndex=function(t,e){for(var r=this.callBackList,i=this.thisObjectList,n=r.length-1;n>=0;n--)if(r[n]==t&&i[n]==e)return n;return-1},r.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},r.prototype.$setFrameRate=function(t){return 0>=t?!1:this.$frameRate==t?!1:(this.$frameRate=t,t>60&&(t=60),this.frameDeltaTime=1e3/t,this.lastCount=this.frameInterval=Math.round(6e4/t),!0)},r.prototype.pause=function(){this.isPaused=!0},r.prototype.resume=function(){this.isPaused=!1},r.prototype.update=function(){for(var r=t.getTimer(),i=this.callBackList,n=this.thisObjectList,a=i.length,o=e.$requestRenderingFlag,s=t.getTimer(),h=t.lifecycle.contexts,c=0,l=h;c<l.length;c++){var u=l[c];u.onUpdate&&u.onUpdate()}if(this.isPaused)return void(this.lastTimeStamp=s);this.callLaterAsyncs();for(var d=0;a>d;d++)i[d].call(n[d],s)&&(o=!0);var p=t.getTimer(),f=s-this.lastTimeStamp;if(this.lastTimeStamp=s,f>=this.frameDeltaTime)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return void(o&&this.render(!1,this.costEnterFrame+p-r));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+p-r);var g=t.getTimer();this.broadcastEnterFrame();var v=t.getTimer();this.costEnterFrame=v-g},r.prototype.render=function(t,r){var i=this.playerList,n=i.length;if(0!=n){this.callLaters(),e.$invalidateRenderFlag&&(this.broadcastRender(),e.$invalidateRenderFlag=!1);for(var a=0;n>a;a++)i[a].$render(t,r);e.$requestRenderingFlag=!1}},r.prototype.broadcastEnterFrame=function(){var e=t.DisplayObject.$enterFrameCallBackList,r=e.length;if(0!=r){e=e.concat();for(var i=0;r>i;i++)e[i].dispatchEventWith(t.Event.ENTER_FRAME)}},r.prototype.broadcastRender=function(){var e=t.DisplayObject.$renderCallBackList,r=e.length;if(0!=r){e=e.concat();for(var i=0;r>i;i++)e[i].dispatchEventWith(t.Event.RENDER)}},r.prototype.callLaters=function(){var e,r,i;if(t.$callLaterFunctionList.length>0&&(e=t.$callLaterFunctionList,t.$callLaterFunctionList=[],r=t.$callLaterThisList,t.$callLaterThisList=[],i=t.$callLaterArgsList,t.$callLaterArgsList=[]),e)for(var n=e.length,a=0;n>a;a++){var o=e[a];null!=o&&o.apply(r[a],i[a])}},r.prototype.callLaterAsyncs=function(){if(t.$callAsyncFunctionList.length>0){var e=t.$callAsyncFunctionList,r=t.$callAsyncThisList,i=t.$callAsyncArgsList;t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[];for(var n=0;n<e.length;n++){var a=e[n];null!=a&&a.apply(r[n],i[n])}}},r}();e.SystemTicker=r,__reflect(r.prototype,"egret.sys.SystemTicker")}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){var e;!function(e){function r(t){var r=new n;e.contexts.push(r),t(r)}e.contexts=[];var i=!0,n=function(){function r(){}return r.prototype.pause=function(){i&&(i=!1,e.stage.dispatchEvent(new t.Event(t.Event.DEACTIVATE)),e.onPause&&e.onPause())},r.prototype.resume=function(){i||(i=!0,e.stage.dispatchEvent(new t.Event(t.Event.ACTIVATE)),e.onResume&&e.onResume())},r}();e.LifecycleContext=n,__reflect(n.prototype,"egret.lifecycle.LifecycleContext"),e.addLifecycleListener=r}(e=t.lifecycle||(t.lifecycle={})),t.ticker=new t.sys.SystemTicker}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(t){var r=e.call(this)||this;return r.maxTouches=0,r.useTouchesCount=0,r.touchDownTarget={},r.lastTouchX=-1,r.lastTouchY=-1,r.stage=t,r}return __extends(r,e),r.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},r.prototype.onTouchBegin=function(e,r,i){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=e,this.lastTouchY=r;var n=this.findTarget(e,r);null==this.touchDownTarget[i]&&(this.touchDownTarget[i]=n,this.useTouchesCount++),t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_BEGIN,!0,!0,e,r,i,!0)}},r.prototype.onTouchMove=function(e,r,i){if(null!=this.touchDownTarget[i]&&(this.lastTouchX!=e||this.lastTouchY!=r)){this.lastTouchX=e,this.lastTouchY=r;var n=this.findTarget(e,r);t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_MOVE,!0,!0,e,r,i,!0)}},r.prototype.onTouchEnd=function(e,r,i){if(null!=this.touchDownTarget[i]){var n=this.findTarget(e,r),a=this.touchDownTarget[i];delete this.touchDownTarget[i],this.useTouchesCount--,t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_END,!0,!0,e,r,i,!1),a==n?t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_TAP,!0,!0,e,r,i,!1):t.TouchEvent.dispatchTouchEvent(a,t.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,e,r,i,!1)}},r.prototype.findTarget=function(t,e){var r=this.stage.$hitTest(t,e);return r||(r=this.stage),r},r}(t.HashObject);e.TouchHandler=r,__reflect(r.prototype,"egret.sys.TouchHandler")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=0/0,t.filter=null,t.rotated=!1,t.type=1,t}return __extends(r,e),r.prototype.drawImage=function(t,e,r,i,n,a,o,s){this.drawData.push(t,e,r,i,n,a,o,s),this.renderCount++},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=0/0,this.filter=null},r.$updateTextureData=function(e,i,n,a,o,s,h,c,l,u,d,p,f,g,v,y){if(i){var $=t.$TextureScaleFactor;if(e.smoothing=y,e.image=i,e.imageWidth=f,e.imageHeight=g,v==t.BitmapFillMode.SCALE){var m=d/l*$,b=p/u*$;e.drawImage(n,a,o,s,m*h,b*c,m*o,b*s)}else if(v==t.BitmapFillMode.CLIP){var x=Math.min(l,d),T=Math.min(u,p),w=o*$,_=s*$;r.drawClipImage(e,$,n,a,w,_,h,c,x,T)}else for(var w=o*$,_=s*$,E=0;d>E;E+=l)for(var S=0;p>S;S+=u){var x=Math.min(d-E,l),T=Math.min(p-S,u);r.drawClipImage(e,$,n,a,w,_,h,c,x,T,E,S)}}},r.$updateTextureDataWithScale9Grid=function(e,r,i,n,a,o,s,h,c,l,u,d,p,f,g,v){e.smoothing=v,e.image=r,e.imageWidth=f,e.imageHeight=g;var y=o,$=s;d-=l-o*t.$TextureScaleFactor,p-=u-s*t.$TextureScaleFactor;var m=i.x-h,b=i.y-c,x=m/t.$TextureScaleFactor,T=b/t.$TextureScaleFactor,w=i.width/t.$TextureScaleFactor,_=i.height/t.$TextureScaleFactor;0==_&&(_=1,T>=$&&T--),0==w&&(w=1,x>=y&&x--);var E=n,S=E+x,C=S+w,D=y-x-w,R=a,O=R+T,L=O+_,A=$-T-_,M=D*t.$TextureScaleFactor,B=A*t.$TextureScaleFactor;if((x+D)*t.$TextureScaleFactor>d||(T+A)*t.$TextureScaleFactor>p)return void e.drawImage(n,a,o,s,h,c,d,p);var F=h,P=F+m,N=F+(d-M),I=d-m-M,k=c,H=k+b,W=k+p-B,U=p-b-B;T>0&&(x>0&&e.drawImage(E,R,x,T,F,k,m,b),w>0&&e.drawImage(S,R,w,T,P,k,I,b),D>0&&e.drawImage(C,R,D,T,N,k,M,b)),_>0&&(x>0&&e.drawImage(E,O,x,_,F,H,m,U),w>0&&e.drawImage(S,O,w,_,P,H,I,U),D>0&&e.drawImage(C,O,D,_,N,H,M,U)),A>0&&(x>0&&e.drawImage(E,L,x,A,F,W,m,B),w>0&&e.drawImage(S,L,w,A,P,W,I,B),D>0&&e.drawImage(C,L,D,A,N,W,M,B))},r.drawClipImage=function(t,e,r,i,n,a,o,s,h,c,l,u){void 0===l&&(l=0),void 0===u&&(u=0);var d=o+n-h;d>0&&(n-=d),d=s+a-c,d>0&&(a-=d),t.drawImage(r,i,n/e,a/e,l+o,u+s,n,a)},r}(e.RenderNode);e.BitmapNode=r,__reflect(r.prototype,"egret.sys.BitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=["none","round","square"],i=["bevel","miter","round"],n=function(n){function a(){var t=n.call(this)||this;
return t.dirtyRender=!0,t.type=3,t}return __extends(a,n),a.prototype.beginFill=function(t,r,i){void 0===r&&(r=1);var n=new e.FillPath;if(n.fillColor=t,n.fillAlpha=r,i){var a=this.drawData.lastIndexOf(i);this.drawData.splice(a,0,n)}else this.drawData.push(n);return n},a.prototype.beginGradientFill=function(r,i,n,a,o,s){var h=new t.Matrix;o?(h.a=819.2*o.a,h.b=819.2*o.b,h.c=819.2*o.c,h.d=819.2*o.d,h.tx=o.tx,h.ty=o.ty):(h.a=100,h.d=100);var c=new e.GradientFillPath;if(c.gradientType=r,c.colors=i,c.alphas=n,c.ratios=a,c.matrix=h,s){var l=this.drawData.lastIndexOf(s);this.drawData.splice(l,0,c)}else this.drawData.push(c);return c},a.prototype.lineStyle=function(n,a,o,s,h,c){void 0===o&&(o=1),void 0===c&&(c=3),-1==r.indexOf(s)&&(s="round"),-1==i.indexOf(h)&&(h="round");var l=new e.StrokePath;return l.lineWidth=n,l.lineColor=a,l.lineAlpha=o,l.caps=s||t.CapsStyle.ROUND,l.joints=h,l.miterLimit=c,this.drawData.push(l),l},a.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0},a.prototype.cleanBeforeRender=function(){},a.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},a}(e.RenderNode);e.GraphicsNode=n,__reflect(n.prototype,"egret.sys.GraphicsNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=4,e}return __extends(e,t),e.prototype.addNode=function(t){this.drawData.push(t)},e.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;e>=0;e--)t[e].cleanBeforeRender()},e.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,r=e.length-1;r>=0;r--)t+=e[r].$getRenderCount();return t},e}(t.RenderNode);t.GroupNode=e,__reflect(e.prototype,"egret.sys.GroupNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=e.call(this)||this;return r.image=null,r.smoothing=!0,r.bounds=new t.Rectangle,r.blendMode=null,r.alpha=0/0,r.filter=null,r.rotated=!1,r.type=5,r.vertices=[],r.uvs=[],r.indices=[],r}return __extends(r,e),r.prototype.drawMesh=function(t,e,r,i,n,a,o,s){this.drawData.push(t,e,r,i,n,a,o,s),this.renderCount++},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},r}(e.RenderNode);e.MeshNode=r,__reflect(r.prototype,"egret.sys.MeshNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.DirtyRegionPolicy={OFF:"off",ON:"on"}}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){}return t.blur_frag="precision mediump float;\nuniform vec2 blur;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\nuniform vec2 uTextureSize;\nvoid main()\n{\n    const int sampleRadius = 5;\n    const int samples = sampleRadius * 2 + 1;\n    vec2 blurUv = blur / uTextureSize;\n    vec4 color = vec4(0, 0, 0, 0);\n    vec2 uv = vec2(0.0, 0.0);\n    blurUv /= float(sampleRadius);\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\n        color += texture2D(uSampler, uv);\n    }\n    color /= float(samples);\n    gl_FragColor = color;\n}",t.colorTransform_frag="precision mediump float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform mat4 matrix;\nuniform vec4 colorAdd;\nuniform sampler2D uSampler;\nvoid main(void) {\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\n    if(texColor.a > 0.) {\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\n    }\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\n}",t.default_vert="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",t.glow_frag="precision mediump float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float dist;\nuniform float angle;\nuniform vec4 color;\nuniform float alpha;\nuniform float blurX;\nuniform float blurY;\nuniform float strength;\nuniform float inner;\nuniform float knockout;\nuniform float hideObject;\nuniform vec2 uTextureSize;\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\nvoid main(void) {\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\n    const float linearSamplingTimes = 7.0;\n    const float circleSamplingTimes = 12.0;\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\n    vec4 curColor;\n    float totalAlpha = 0.0;\n    float maxTotalAlpha = 0.0;\n    float curDistanceX = 0.0;\n    float curDistanceY = 0.0;\n    float offsetX = dist * cos(angle) * px.x;\n    float offsetY = dist * sin(angle) * px.y;\n    const float PI = 3.14159265358979323846264;\n    float cosAngle;\n    float sinAngle;\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    float stepX = blurX * px.x / linearSamplingTimes;\n    float stepY = blurY * px.y / linearSamplingTimes;\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\n        cosAngle = cos(a + offset);\n        sinAngle = sin(a + offset);\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\n            curDistanceX = i * stepX * cosAngle;\n            curDistanceY = i * stepY * sinAngle;\n            \n            curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\n            totalAlpha += (linearSamplingTimes - i) * curColor.a;\n            maxTotalAlpha += (linearSamplingTimes - i);\n        }\n    }\n    ownColor.a = max(ownColor.a, 0.0001);\n    ownColor.rgb = ownColor.rgb / ownColor.a;\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\n}",t.primitive_frag="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvoid main(void) {\n    gl_FragColor = vColor;\n}",t.texture_frag="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\n}",t}();t.EgretShaderLib=e,__reflect(e.prototype,"egret.web.EgretShaderLib")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}return __extends(r,e),r.prototype.drawText=function(t,e,r,i){this.drawData.push(t,e,r,i),this.renderCount++,this.dirtyRender=!0},r.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},r.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.dirtyRender=!0},r}(e.RenderNode);e.TextNode=r,__reflect(r.prototype,"egret.sys.TextNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=1,e}return __extends(e,t),e}(t.Path2D);t.FillPath=e,__reflect(e.prototype,"egret.sys.FillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=2,e}return __extends(e,t),e}(t.Path2D);t.GradientFillPath=e,__reflect(e.prototype,"egret.sys.GradientFillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=3,e}return __extends(e,t),e.prototype.setLineDash=function(t){this.$commands[this.commandPosition++]=5;var e=this.dataPosition;this.$data[e++]=t,this.dataPosition=e},e}(t.Path2D);t.StrokePath=e,__reflect(e.prototype,"egret.sys.StrokePath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(t,e){var r=null==e.italic?t.italic:e.italic,i=null==e.bold?t.bold:e.bold,n=null==e.size?t.size:e.size,a=e.fontFamily||t.fontFamily,o=r?"italic ":"normal ";return o+=i?"bold ":"normal ",o+=n+"px "+a}function r(t,e){var r=t>>16,i=t>>8&255,n=255&t;return"rgba("+r+","+i+","+n+","+e+")"}function i(e,i,n,a,o,s){var h;h=i==t.GradientType.LINEAR?e.createLinearGradient(-1,0,1,0):e.createRadialGradient(0,0,0,0,0,1);for(var c=n.length,l=0;c>l;l++)h.addColorStop(o[l]/255,r(n[l],a[l]));return h}function n(t,e,r){void 0===r&&(r=0);for(var i=0,n=e.length;n>i;i++)t[i+r]=e[i]}function a(t,e,r,i){for(var n=i[0],a=i[1],o=i[2],s=i[3],h=i[4],c=i[5],l=i[6],u=i[7],d=i[8],p=i[9],f=i[10],g=i[11],v=i[12],y=i[13],$=i[14],m=i[15],b=i[16],x=i[17],T=i[18],w=i[19],_=0,E=e*r*4;E>_;_+=4){var S=t[_+0],C=t[_+1],D=t[_+2],R=t[_+3];t[_+0]=n*S+a*C+o*D+s*R+h,t[_+1]=c*S+l*C+u*D+d*R+p,t[_+2]=f*S+g*C+v*D+y*R+$,t[_+3]=m*S+b*C+x*D+T*R+w}}function o(t,e,r,i,n){s(t,e,r,i),h(t,e,r,n)}function s(t,e,r,i){var a;a=T?new Uint8ClampedArray(4*e):new Array(4*e);for(var o=4*e,s=2*i+1,h=0;r>h;h++){for(var c=h*o,l=0,u=0,d=0,p=0,f=0,g=0,v=4*-i,y=4*i+4;y>v;v+=4){var $=c+v;c>$||$>=c+o||(f=t[$+3],l+=t[$+0]*f,u+=t[$+1]*f,d+=t[$+2]*f,p+=f)}for(var v=c,y=c+o,m=0,b=v-4*i,x=v+4*(i+1);y>v;v+=4,m+=4,x+=4,b+=4)0===p?(a[m+0]=0,a[m+1]=0,a[m+2]=0,a[m+3]=0):(a[m+0]=l/p,a[m+1]=u/p,a[m+2]=d/p,a[m+3]=p/s),f=t[x+3],g=t[b+3],f||0==f?g||0==g?(l+=t[x+0]*f-t[b+0]*g,u+=t[x+1]*f-t[b+1]*g,d+=t[x+2]*f-t[b+2]*g,p+=f-g):(l+=t[x+0]*f,u+=t[x+1]*f,d+=t[x+2]*f,p+=f):(g||0==g)&&(l+=-t[b+0]*g,u+=-t[b+1]*g,d+=-t[b+2]*g,p+=-g);T?t.set(a,c):n(t,a,c)}}function h(t,e,r,i){var n;n=T?new Uint8ClampedArray(4*r):new Array(4*r);for(var a=4*e,o=2*i+1,s=0;e>s;s++){for(var h=4*s,c=0,l=0,u=0,d=0,p=0,f=0,g=-i*a,v=i*a+a;v>g;g+=a){var y=h+g;h>y||y>=h+r*a||(p=t[y+3],c+=t[y+0]*p,l+=t[y+1]*p,u+=t[y+2]*p,d+=p)}for(var g=h,v=h+r*a,$=0,m=h-i*a,b=h+(i+1)*a;v>g;g+=a,$+=4,b+=a,m+=a)0===d?(n[$+0]=0,n[$+1]=0,n[$+2]=0,n[$+3]=0):(n[$+0]=c/d,n[$+1]=l/d,n[$+2]=u/d,n[$+3]=d/o),p=t[b+3],f=t[m+3],p||0==p?f||0==f?(c+=t[b+0]*p-t[m+0]*f,l+=t[b+1]*p-t[m+1]*f,u+=t[b+2]*p-t[m+2]*f,d+=p-f):(c+=t[b+0]*p,l+=t[b+1]*p,u+=t[b+2]*p,d+=p):(f||0==f)&&(c+=-t[m+0]*f,l+=-t[m+1]*f,u+=-t[m+2]*f,d+=-f);for(var x=4*s,v=x+r*a,w=0;v>x;x+=a,w+=4)t[x+0]=n[w+0],t[x+1]=n[w+1],t[x+2]=n[w+2],t[x+3]=n[w+3]}}function c(t,e,r,i,a,s,h,c,f){var g=l(t,i);u(g,e,r,h,c),o(g,e,r,a,s),d(g,f),p(g,t),t.set(g),T?t.set(g):n(t,g)}function l(t,e){e||(e=[0,0,0,0]);var r;T?r=new Uint8ClampedArray(t):(r=new Array(t.length),n(r,t));for(var i=e[0],a=e[1],o=e[2],s=e[3],h=0,c=r.length;c>h;h+=4){var l=r[h+3];r[h+0]=i*l,r[h+1]=a*l,r[h+2]=o*l,r[h+3]=s*l}return r}function u(t,e,r,i,a){var o,s,h=Math.sin(i)*a|0,c=Math.cos(i)*a|0;if(T){o=new Int32Array(t.buffer),s=new Int32Array(o.length);for(var l=0;r>l;l++){var u=l+h;if(!(0>u||u>r))for(var d=0;e>d;d++){var p=d+c;0>p||p>e||(s[u*e+p]=o[l*e+d])}}o.set(s)}else{o=t,s=new Array(o.length);for(var l=0;r>l;l++){var u=l+h;if(!(0>u||u>r))for(var d=0;e>d;d++){var p=d+c;0>p||p>e||(s[4*(u*e+p)+0]=o[4*(l*e+d)+0],s[4*(u*e+p)+1]=o[4*(l*e+d)+1],s[4*(u*e+p)+2]=o[4*(l*e+d)+2],s[4*(u*e+p)+3]=o[4*(l*e+d)+3])}}n(o,s)}}function d(t,e){for(var r=0,i=t.length;i>r;r+=4)t[r+3]*=e}function p(t,e){for(var r=0,i=t.length;i>r;r+=4){var n=t[r+0],a=t[r+1],o=t[r+2],s=t[r+3]/255,h=e[r+0],c=e[r+1],l=e[r+2],u=e[r+3]/255;t[r+0]=h+n*(1-u),t[r+1]=c+a*(1-u),t[r+2]=l+o*(1-u),t[r+3]=255*(u+s*(1-u))}}function f(t,e,r){return t*(1-r)+e*r}function g(t,e,r,i,a,o,s,h,c,l,u,d){var p;p=T?new Uint8ClampedArray(t.length):new Array(t.length);for(var g,v,y=i[3],$=0,m=0,b=h*Math.cos(s),x=h*Math.sin(s),w=7,_=12,E=3.141592653589793,S=a/w,C=o/w,D=0;e>D;D++)for(var R=0;r>R;R++){for(var O=0,L=R*e*4+4*D,A=0,M=0,B=t[L+0]/255,F=t[L+1]/255,P=t[L+2]/255,N=t[L+3]/255,I=0;2*E>=I;I+=2*E/_){g=Math.cos(I+O),v=Math.sin(I+O);for(var k=0;w>k;k++){$=k*S*g,m=k*C*v;var H=Math.round(D+$-b),W=Math.round(R+m-x),U=0;if(H>=e||0>H||0>W||W>=r)U=0;else{var X=W*e*4+4*H;U=t[X+3]/255}A+=(w-k)*U,M+=w-k}}N=Math.max(N,1e-4);var j=A/M*c*y*(1-l)*Math.max(Math.min(d,u),1-N),Y=(M-A)/M*c*y*l*N;N=Math.max(N*u*(1-d),1e-4);var G=Y/(Y+N),V=f(B,i[0],G),z=f(F,i[1],G),q=f(P,i[2],G),K=j/(Y+N+j),J=f(V,i[0],K),Q=f(z,i[1],K),Z=f(q,i[2],K),te=Math.min(N+j+Y,1);p[L+0]=255*J,p[L+1]=255*Q,p[L+2]=255*Z,p[L+3]=255*te}T?t.set(p):n(t,p)}var v=["source-over","lighter","destination-out"],y="source-over";t.BLACK_COLOR="#000000";var $={none:"butt",square:"square",round:"round"},m=[],b=[],x=function(){function n(){this.nestLevel=0,this.renderingMask=!1}return n.prototype.render=function(e,r,i,n){this.nestLevel++;var a=r.context;a.transform(i.a,i.b,i.c,i.d,0,0);var o=this.drawDisplayObject(e,a,i.tx,i.ty,!0),s=t.Matrix.create();if(i.$invertInto(s),a.transform(s.a,s.b,s.c,s.d,0,0),t.Matrix.release(s),this.nestLevel--,0===this.nestLevel){m.length>6&&(m.length=6);for(var h=m.length,c=0;h>c;c++)m[c].resize(0,0)}return o},n.prototype.drawDisplayObject=function(e,r,i,n,a){var o,s=0,h=e.$displayList;if(h&&!a?((e.$cacheDirty||e.$renderDirty||h.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||h.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=h.drawToSurface()),o=h.$renderNode):o=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,o){switch(s++,r.$offsetX=i,r.$offsetY=n,o.type){case 1:this.renderBitmap(o,r);break;case 2:this.renderText(o,r);break;case 3:this.renderGraphics(o,r);break;case 4:this.renderGroup(o,r);break;case 5:this.renderMesh(o,r);break;case 6:this.renderNormalBitmap(o,r)}r.$offsetX=0,r.$offsetY=0}if(h&&!a)return s;var c=e.$children;if(c)for(var l=c.length,u=0;l>u;u++){var d=c[u],p=void 0,f=void 0;if(d.$useTranslate){var g=d.$getMatrix();p=i+d.$x,f=n+d.$y,r.save(),r.transform(g.a,g.b,g.c,g.d,p,f),p=-d.$anchorOffsetX,f=-d.$anchorOffsetY}else p=i+d.$x-d.$anchorOffsetX,f=n+d.$y-d.$anchorOffsetY;var v=void 0;switch(1!=d.$alpha&&(v=r.globalAlpha,r.globalAlpha*=d.$alpha),d.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(d,r,p,f);break;case 3:s+=this.drawWithClip(d,r,p,f);break;case 4:s+=this.drawWithScrollRect(d,r,p,f);break;default:s+=this.drawDisplayObject(d,r,p,f)}d.$useTranslate?r.restore():v&&(r.globalAlpha=v)}return s},n.prototype.drawWithFilter=function(e,r,i,n){if(t.Capabilities.runtimeType==t.RuntimeType.NATIVE)return this.drawWithFilterNative(e,r,i,n);var s,h=0,l=e.$filters,u=l.length,d=0!==e.$blendMode;d&&(s=v[e.$blendMode],s||(s=y));var p=e.$getOriginalBounds();if(p.width<=0||p.height<=0)return h;var f=this.createRenderBuffer(p.width,p.height,!0),$=f.context;if(h+=e.$mask?this.drawWithClip(e,r,i,n):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,r,i,n):this.drawDisplayObject(e,r,i,n),h>0){d&&(r.globalCompositeOperation=s),h++;for(var m=$.getImageData(0,0,f.surface.width,f.surface.height),x=0;u>x;x++){var T=l[x];if("colorTransform"==T.type)a(m.data,f.surface.width,f.surface.height,T.$matrix);else if("blur"==T.type)o(m.data,f.surface.width,f.surface.height,T.$blurX,T.$blurY);else if("glow"==T.type){var w=T.$red,_=T.$green,E=T.$blue,S=T.$alpha;T.$inner||T.$knockout||T.$hideObject?g(m.data,f.surface.width,f.surface.height,[w/255,_/255,E/255,S],T.$blurX,T.$blurY,T.$angle?T.$angle/180*Math.PI:0,T.$distance||0,T.$strength,T.$inner?1:0,T.$knockout?0:1,T.$hideObject?1:0):c(m.data,f.surface.width,f.surface.height,[w/255,_/255,E/255,S],T.$blurX,T.$blurY,T.$angle?T.$angle/180*Math.PI:0,T.$distance||0,T.$strength)}else"custom"==T.type}$.putImageData(m,0,0),r.globalAlpha=1,r.drawImage(f.surface,i+p.x,n+p.y),d&&(r.globalCompositeOperation=y)}return b.push(f),h},n.prototype.drawWithFilterNative=function(t,e,r,i){var n,a=0,o=t.$filters,s=0!==t.$blendMode;s&&(n=v[t.$blendMode],n||(n=y));var h=t.$getOriginalBounds();if(h.width<=0||h.height<=0)return a;if(1==o.length&&"colorTransform"==o[0].type&&!t.$children)return s&&(e.globalCompositeOperation=n),e.setGlobalShader(o[0]),a+=t.$mask?this.drawWithClip(t,e,r,i):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,e,r,i):this.drawDisplayObject(t,e,r,i),e.setGlobalShader(null),s&&(e.globalCompositeOperation=y),a;var c=this.createRenderBuffer(h.width,h.height);return a+=t.$mask?this.drawWithClip(t,e,r,i):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,e,r,i):this.drawDisplayObject(t,e,r,i),a>0&&(s&&(e.globalCompositeOperation=n),a++,e.globalAlpha=1,e.setGlobalShader(o[0]),e.drawImage(c.surface,0,0,c.width,c.height,r+h.x,i+h.y,c.width,c.height),e.setGlobalShader(null),s&&(e.globalCompositeOperation=y)),m.push(c),a},n.prototype.drawWithClip=function(e,r,i,n){var a,o=0,s=0!==e.$blendMode;s&&(a=v[e.$blendMode],a||(a=y));var h=e.$scrollRect?e.$scrollRect:e.$maskRect,c=e.$mask;if(c){var l=c.$getMatrix();if(0==l.a&&0==l.b||0==l.c&&0==l.d)return o}if(!(c||e.$children&&0!=e.$children.length))return h&&(r.save(),r.beginPath(),r.rect(h.x+i,h.y+n,h.width,h.height),r.clip()),s&&(r.globalCompositeOperation=a),o+=this.drawDisplayObject(e,r,i,n),s&&(r.globalCompositeOperation=y),h&&r.restore(),o;var u=c.$getRenderNode();if(c&&t.Capabilities.$runtimeType==t.RuntimeType.WEB&&(!c.$children||0==c.$children.length)&&u&&3==u.type&&1==u.drawData.length&&1==u.drawData[0].type&&1==u.drawData[0].fillAlpha){this.renderingMask=!0,r.save();var d=t.Matrix.create();d.copyFrom(c.$getConcatenatedMatrix()),c.$getConcatenatedMatrixAt(e,d),r.transform(d.a,d.b,d.c,d.d,d.tx,d.ty);var p=this.drawDisplayObject(c,r,i,n);return this.renderingMask=!1,d.$invertInto(d),r.transform(d.a,d.b,d.c,d.d,d.tx,d.ty),t.Matrix.release(d),h&&(r.beginPath(),r.rect(h.x+i,h.y+n,h.width,h.height),r.clip()),p+=this.drawDisplayObject(e,r,i,n),r.restore(),p}var f=e.$getOriginalBounds(),g=this.createRenderBuffer(f.width,f.height),$=g.context;if(!$)return o+=this.drawDisplayObject(e,r,i,n);if(o+=this.drawDisplayObject(e,$,0,0),c){var d=t.Matrix.create();if(d.copyFrom(c.$getConcatenatedMatrix()),c.$getConcatenatedMatrixAt(e,d),t.Capabilities.$runtimeType==t.RuntimeType.WEB&&u&&1==u.$getRenderCount()||c.$displayList)$.globalCompositeOperation="destination-in",$.save(),$.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty),o+=this.drawDisplayObject(c,$,0,0),$.restore();else{var b=this.createRenderBuffer(f.width,f.height),x=b.context;x.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty),o+=this.drawDisplayObject(c,x,-f.x,-f.y),$.globalCompositeOperation="destination-in",$.globalAlpha=1,$.drawImage(b.surface,0,0),m.push(b)}t.Matrix.release(d)}return o>0&&(o++,s&&(r.globalCompositeOperation=a),h&&(r.save(),r.beginPath(),r.rect(h.x+i,h.y+n,h.width,h.height),r.clip()),r.globalAlpha=1,r.drawImage(g.surface,i+f.x,n+f.y),h&&r.restore(),s&&(r.globalCompositeOperation=y)),m.push(g),o},n.prototype.drawWithScrollRect=function(t,e,r,i){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;return a.isEmpty()?n:(t.$scrollRect&&(r-=a.x,i-=a.y),e.save(),e.beginPath(),e.rect(a.x+r,a.y+i,a.width,a.height),e.clip(),n+=this.drawDisplayObject(t,e,r,i),e.restore(),n)},n.prototype.drawNodeToBuffer=function(t,e,r,i){var n=e.context;n.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(t,n,i)},n.prototype.drawDisplayToBuffer=function(t,e,r){var i=e.context;r&&i.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty);var n;n=t.$renderDirty?t.$getRenderNode():t.$renderNode;var a=0;if(n)switch(a++,n.type){case 1:this.renderBitmap(n,i);break;case 2:this.renderText(n,i);break;case 3:this.renderGraphics(n,i);break;case 4:this.renderGroup(n,i);break;case 5:this.renderMesh(n,i);break;case 6:this.renderNormalBitmap(n,i)}var o=t.$children;if(o)for(var s=o.length,h=0;s>h;h++){var c=o[h];switch(c.$renderMode){case 1:break;case 2:a+=this.drawWithFilter(c,i,0,0);break;case 3:a+=this.drawWithClip(c,i,0,0);break;case 4:a+=this.drawWithScrollRect(c,i,0,0);break;default:a+=this.drawDisplayObject(c,i,0,0)}}return a},n.prototype.renderNode=function(t,e,r){var i=0;switch(t.type){case 1:i=this.renderBitmap(t,e);break;case 2:i=1,this.renderText(t,e);break;case 3:i=this.renderGraphics(t,e,r);break;case 4:i=this.renderGroup(t,e);break;case 5:i=this.renderMesh(t,e);break;case 6:i+=this.renderNormalBitmap(t,e)}return i},n.prototype.renderNormalBitmap=function(t,e){var r=t.image;if(!r||!r.source)return 0;if(e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),t.rotated){var i=t.sourceX,n=t.sourceY,a=t.sourceW,o=t.sourceH,s=t.drawX,h=t.drawY,c=t.drawW,l=t.drawH;e.save(),e.transform(0,-1,1,0,0,l),e.drawImage(r.source,i,n,o,a,s+e.$offsetX,h+e.$offsetY,l,c),e.restore()}else e.drawImage(r.source,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX+e.$offsetX,t.drawY+e.$offsetY,t.drawW,t.drawH);return 1},n.prototype.renderBitmap=function(t,e){var r=t.image;if(!r||!r.source)return 0;e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing);var i,n,o=t.drawData,s=o.length,h=0,c=t.matrix,l=t.blendMode,u=t.alpha,d=!1;c&&(e.save(),d=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,n=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(c.a,c.b,c.c,c.d,c.tx,c.ty)),l&&(e.globalCompositeOperation=v[l]);var p;u==u&&(p=e.globalAlpha,e.globalAlpha*=u);var f=0,g=t.filter;if(g&&8==s){var $=o[0],b=o[1],x=o[2],T=o[3],w=o[4],_=o[5],E=o[6],S=o[7];t.rotated&&(x=o[3],T=o[2],E=o[7],S=o[6]);var C=this.createRenderBuffer(E,S),D=C.context;f++,t.rotated&&e.transform(0,-1,1,0,0,E),D.drawImage(r.source,$,b,x,T,0,0,E,S),f++;var R=D.getImageData(0,0,E,S);a(R.data,E,S,g.$matrix),D.putImageData(R,0,0),e.drawImage(C.surface,0,0,E,S,w+e.$offsetX,_+e.$offsetY,E,S),m.push(C)}else for(;s>h;)if(f++,t.rotated){var $=o[h++],b=o[h++],T=o[h++],x=o[h++],O=o[h++],L=o[h++],S=o[h++],E=o[h++];e.save(),e.transform(0,-1,1,0,0,E),e.drawImage(r.source,$,b,x,T,O+e.$offsetX,L+e.$offsetY,E,S),e.restore()}else e.drawImage(r.source,o[h++],o[h++],o[h++],o[h++],o[h++]+e.$offsetX,o[h++]+e.$offsetY,o[h++],o[h++]);return d?e.restore():(l&&(e.globalCompositeOperation=y),u==u&&(e.globalAlpha=p)),i&&(e.$offsetX=i),n&&(e.$offsetY=n),f},n.prototype.renderMesh=function(t,e){return 0},n.prototype.renderText=function(r,i){i.textAlign="left",i.textBaseline="middle",i.lineJoin="round";for(var n=r.drawData,a=n.length,o=0;a>o;){var s=n[o++],h=n[o++],c=n[o++],l=n[o++];i.font=e(r,l);var u=null==l.textColor?r.textColor:l.textColor,d=null==l.strokeColor?r.strokeColor:l.strokeColor,p=null==l.stroke?r.stroke:l.stroke;i.fillStyle=t.toColorString(u),i.strokeStyle=t.toColorString(d),p&&(i.lineWidth=2*p,i.strokeText(c,s+i.$offsetX,h+i.$offsetY)),i.fillText(c,s+i.$offsetX,h+i.$offsetY)}},n.prototype.renderGraphics=function(e,n,a){var o=e.drawData,s=o.length;a=!!a;for(var h=0;s>h;h++){var c=o[h];switch(c.type){case 1:var l=c;n.fillStyle=a?t.BLACK_COLOR:r(l.fillColor,l.fillAlpha),this.renderPath(c,n),this.renderingMask?n.clip():n.fill();break;case 2:var u=c;n.fillStyle=a?t.BLACK_COLOR:i(n,u.gradientType,u.colors,u.alphas,u.ratios,u.matrix),n.save();var d=u.matrix;this.renderPath(c,n),n.transform(d.a,d.b,d.c,d.d,d.tx,d.ty),n.fill(),n.restore();break;case 3:var p=c,f=p.lineWidth;n.lineWidth=f,n.strokeStyle=a?t.BLACK_COLOR:r(p.lineColor,p.lineAlpha),n.lineCap=$[p.caps],n.lineJoin=p.joints,n.miterLimit=p.miterLimit;var g=1===f||3===f;g&&n.translate(.5,.5),this.renderPath(c,n),n.stroke(),g&&n.translate(-.5,-.5)}}return 0==s?0:1},n.prototype.renderPath=function(t,e){e.beginPath();for(var r=t.$data,i=t.$commands,n=i.length,a=0,o=0;n>o;o++){var s=i[o];switch(s){case 4:e.bezierCurveTo(r[a++]+e.$offsetX,r[a++]+e.$offsetY,r[a++]+e.$offsetX,r[a++]+e.$offsetY,r[a++]+e.$offsetX,r[a++]+e.$offsetY);break;case 3:e.quadraticCurveTo(r[a++]+e.$offsetX,r[a++]+e.$offsetY,r[a++]+e.$offsetX,r[a++]+e.$offsetY);break;case 2:e.lineTo(r[a++]+e.$offsetX,r[a++]+e.$offsetY);break;case 1:e.moveTo(r[a++]+e.$offsetX,r[a++]+e.$offsetY);break;case 5:e.setLineDash(r[a++])}}},n.prototype.renderGroup=function(t,e){var r,i,n=t.matrix,a=!1;n&&(e.save(),a=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),r=e.$offsetX,i=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty));for(var o=0,s=t.drawData,h=s.length,c=0;h>c;c++){var l=s[c];o+=this.renderNode(l,e)}return a&&e.restore(),r&&(e.$offsetX=r),i&&(e.$offsetY=i),o},n.prototype.createRenderBuffer=function(e,r,i){var n=i?b.pop():m.pop();return n?n.resize(e,r,!0):n=new t.sys.CanvasRenderBuffer(e,r),n},n}();t.CanvasRenderer=x,__reflect(x.prototype,"egret.CanvasRenderer"),t.getFontString=e,t.getRGBAString=r;var T=!1;try{T=void 0!==typeof Uint8ClampedArray}catch(w){}}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),t.call(this,e,r,i)||this}return __extends(e,t),e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e}(t.Event);t.FocusEvent=e,__reflect(e.prototype,"egret.FocusEvent")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t){var r=e.call(this)||this;return r.format="image",r.$deleteSource=!0,r.source=t,r.width=t.width,r.height=t.height,r}return __extends(r,e),r.create=function(e,i,n){var a="";a="arraybuffer"===e?t.Base64Util.encode(i):i;var o="image/png";"/"===a.charAt(0)?o="image/jpeg":"R"===a.charAt(0)?o="image/gif":"i"===a.charAt(0)&&(o="image/png");var s=new Image;s.src="data:"+o+";base64,"+a,s.crossOrigin="*";var h=new r(s);return s.onload=function(){s.onload=void 0,h.source=s,h.height=s.height,h.width=s.width,n&&n(h)},h},r.prototype.$dispose=function(){t.Capabilities.runtimeType==t.RuntimeType.WEB&&"webgl"==t.Capabilities.renderMode&&this.webGLTexture&&(t.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source=null,r.$dispose(this)},r.$addDisplayObject=function(t,e){if(e){var i=e.hashCode;if(i){if(!r._displayList[i])return void(r._displayList[i]=[t]);var n=r._displayList[i];n.indexOf(t)<0&&n.push(t)}}},r.$removeDisplayObject=function(t,e){if(e){var i=e.hashCode;if(i&&r._displayList[i]){var n=r._displayList[i],a=n.indexOf(t);a>=0&&n.splice(a)}}},r.$invalidate=function(e){if(e){var i=e.hashCode;if(i&&r._displayList[i])for(var n=r._displayList[i],a=0;a<n.length;a++){n[a]instanceof t.Bitmap&&n[a].$refreshImageData();var o=n[a];o.$renderDirty=!0;var s=o.$parent;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp());var h=o.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}}},r.$dispose=function(e){if(e){var i=e.hashCode;if(i&&r._displayList[i]){for(var n=r._displayList[i],a=0,o=n;a<o.length;a++){var s=o[a];s instanceof t.Bitmap&&(s.$bitmapData=null),s.$renderDirty=!0;var h=s.$parent;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp());var c=s.$maskedObject;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp())}t.nativeRender&&t.NativeNode.disposeBitmapData(e),delete r._displayList[i]}}},r._displayList=t.createMap(),r}(t.HashObject);t.BitmapData=e,__reflect(e.prototype,"egret.BitmapData")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onChange=function(e){var i=new t.OrientationEvent(t.Event.CHANGE);i.beta=e.beta,i.gamma=e.gamma,i.alpha=e.alpha,r.dispatchEvent(i)},r}return __extends(r,e),r.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},r.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},r}(t.EventDispatcher);e.WebDeviceOrientation=r,__reflect(r.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(e=t.web||(t.web={}))}(egret||(egret={})),egret.DeviceOrientation=egret.web.WebDeviceOrientation;var egret;!function(t){var e;!function(e){var r=function(e){function r(r){var i=e.call(this)||this;return i.onUpdate=function(e){var r=new t.GeolocationEvent(t.Event.CHANGE),n=e.coords;r.altitude=n.altitude,r.heading=n.heading,r.accuracy=n.accuracy,r.latitude=n.latitude,r.longitude=n.longitude,r.speed=n.speed,r.altitudeAccuracy=n.altitudeAccuracy,i.dispatchEvent(r)},i.onError=function(e){var r=t.GeolocationEvent.UNAVAILABLE;e.code==e.PERMISSION_DENIED&&(r=t.GeolocationEvent.PERMISSION_DENIED);var n=new t.GeolocationEvent(t.IOErrorEvent.IO_ERROR);n.errorType=r,n.errorMessage=e.message,i.dispatchEvent(n)},i.geolocation=navigator.geolocation,i}return __extends(r,e),r.prototype.start=function(){var e=this.geolocation;e?this.watchId=e.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:t.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},r.prototype.stop=function(){var t=this.geolocation;t.clearWatch(this.watchId)},r}(t.EventDispatcher);e.WebGeolocation=r,__reflect(r.prototype,"egret.web.WebGeolocation",["egret.Geolocation"]),t.Geolocation=t.web.WebGeolocation}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onChange=function(e){var i=new t.MotionEvent(t.Event.CHANGE),n={x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},a={x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},o={alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma};i.acceleration=n,i.accelerationIncludingGravity=a,i.rotationRate=o,r.dispatchEvent(i)},r}return __extends(r,e),r.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},r.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},r}(t.EventDispatcher);e.WebMotion=r,__reflect(r.prototype,"egret.web.WebMotion",["egret.Motion"]),t.Motion=t.web.WebMotion}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var n=e.call(this,t,r,i)||this;return n._status=0,n}return __extends(r,e),Object.defineProperty(r.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),r.dispatchHTTPStatusEvent=function(e,i){var n=t.Event.create(r,r.HTTP_STATUS);n._status=i;var a=e.dispatchEvent(n);return t.Event.release(n),a},r.HTTP_STATUS="httpStatus",r}(t.Event);t.HTTPStatusEvent=e,__reflect(e.prototype,"egret.HTTPStatusEvent")}(egret||(egret={}));var egret;!function(t){function e(t,e){i[t]=e}function r(t){return i[t]}var i={};t.registerImplementation=e,t.getImplementation=r}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LINEAR="linear",t.RADIAL="radial",t}();t.GradientType=e,__reflect(e.prototype,"egret.GradientType")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.MotionEvent=e,__reflect(e.prototype,"egret.MotionEvent")}(egret||(egret={}));var egret;!function(t){var e,r,i,n=0,a=1,o=1,s={},h={},c=2,l=0;t.nativeRender&&(i=new Float32Array(2e4));var u=!1,d=function(){function t(t){this.id=n,this.$obj=new Module.WasmNode(this.id,t),i[c++]=0,i[c++]=n,i[c++]=t,l++,n++}return t.init=function(t,n,a,o,h){if(2!=c){console.log("displayCmdBufferIndex "+c);for(var l=2;c>l;l++)t[l]=i[l]}i=t,u=n,i[0]=0,i[1]=2,e=a,r=o,s=h},t.update=function(){i[0]=l,i[1]=c,l=0,c=2},t.prototype.addChildAt=function(t,e){i[c++]=3,i[c++]=this.id,i[c++]=t,i[c++]=e,l++
},t.prototype.removeChild=function(t){i[c++]=2,i[c++]=this.id,i[c++]=t,l++},t.prototype.swapChild=function(t,e){i[c++]=4,i[c++]=this.id,i[c++]=t,i[c++]=e,l++},t.prototype.setX=function(t){i[c++]=101,i[c++]=this.id,i[c++]=t,l++},t.prototype.setY=function(t){i[c++]=102,i[c++]=this.id,i[c++]=t,l++},t.prototype.setRotation=function(t){i[c++]=103,i[c++]=this.id,i[c++]=t,l++},t.prototype.setScaleX=function(t){i[c++]=104,i[c++]=this.id,i[c++]=t,l++},t.prototype.setScaleY=function(t){i[c++]=105,i[c++]=this.id,i[c++]=t,l++},t.prototype.setSkewX=function(t){i[c++]=106,i[c++]=this.id,i[c++]=t,l++},t.prototype.setSkewY=function(t){i[c++]=107,i[c++]=this.id,i[c++]=t,l++},t.prototype.setAlpha=function(t){i[c++]=108,i[c++]=this.id,i[c++]=t,l++},t.prototype.setAnchorOffsetX=function(t){i[c++]=116,i[c++]=this.id,i[c++]=t,l++},t.prototype.setAnchorOffsetY=function(t){i[c++]=117,i[c++]=this.id,i[c++]=t,l++},t.prototype.setVisible=function(t){i[c++]=118,i[c++]=this.id,i[c++]=t?1:0,l++},t.prototype.setBlendMode=function(t){i[c++]=126,i[c++]=this.id,i[c++]=t,l++},t.prototype.setMaskRect=function(t,e,r,n){i[c++]=127,i[c++]=this.id,i[c++]=t,i[c++]=e,i[c++]=r,i[c++]=n,l++},t.prototype.setScrollRect=function(t,e,r,n){i[c++]=128,i[c++]=this.id,i[c++]=t,i[c++]=e,i[c++]=r,i[c++]=n,l++},t.prototype.setFilters=function(t){if(!t)return i[c++]=134,i[c++]=this.id,i[c++]=0,void l++;i[c++]=134,i[c++]=this.id;for(var e=c++,r=t.length,n=r,a=0;r>a;a++){var o=t[a];if("blur"==o.type){var s=o;0!=s.$blurX&&0!=s.$blurY?(n++,i[c++]=s.blurXFilter.$id,i[c++]=s.blurYFilter.$id):0!=s.$blurX?i[c++]=s.blurXFilter.$id:0!=s.$blurY?i[c++]=s.blurYFilter.$id:n--}else i[c++]=o.$id}i[e]=n,l++},t.createFilter=function(t){t.$id=o,r[o]=t,o++,i[c++]=0,i[c++]=t.$id,i[c++]=6,l++},t.setFilterPadding=function(t,e,r,n,a){i[c++]=136,i[c++]=t,i[c++]=e,i[c++]=r,i[c++]=n,i[c++]=a,l++},t.prototype.setMask=function(t){i[c++]=131,i[c++]=this.id,i[c++]=t,l++},t.setValuesToBitmapData=function(t){var r=t.bitmapData;r.$bitmapDataId||(r.$bitmapDataId=a,e[a]=r,a++),t.$textureId||(t.$textureId=a,i[c++]=0,i[c++]=a,i[c++]=2,l++,i[c++]=122,i[c++]=t.$textureId,i[c++]=t.$bitmapX,i[c++]=t.$bitmapY,i[c++]=t.$bitmapWidth,i[c++]=t.$bitmapHeight,i[c++]=t.$offsetX,i[c++]=t.$offsetY,i[c++]=t.$getTextureWidth(),i[c++]=t.$getTextureHeight(),i[c++]=t.$sourceWidth,i[c++]=t.$sourceHeight,i[c++]=t.$rotated?1:0,l++,i[c++]=123,i[c++]=t.$textureId,i[c++]=r.$bitmapDataId,l++,a++)},t.setValuesToRenderBuffer=function(t){var r;return t.rootRenderTarget?r=t.rootRenderTarget.texture:t.texture?r=t.texture:(r={},t.texture=r),r.$bitmapDataId||(r.isTexture=!0,r.$bitmapDataId=a,e[a]=r,i[c++]=0,i[c++]=r.$bitmapDataId,i[c++]=2,l++,i[c++]=123,i[c++]=r.$bitmapDataId,i[c++]=r.$bitmapDataId,l++,a++,t.bufferIdForWasm=a),r.$bitmapDataId},t.prototype.setBitmapData=function(r){if(!r)return i[c++]=121,i[c++]=this.id,i[c++]=-1,void l++;if(r.$renderBuffer){var n=void 0;n=r.$renderBuffer.rootRenderTarget?r.$renderBuffer.rootRenderTarget.texture:r.$renderBuffer.texture?r.$renderBuffer.texture:r.$renderBuffer.surface,n.$bitmapDataId||(n.isTexture=!0,n.$bitmapDataId=a,e[a]=n,i[c++]=0,i[c++]=n.$bitmapDataId,i[c++]=2,l++,i[c++]=123,i[c++]=n.$bitmapDataId,i[c++]=n.$bitmapDataId,l++,a++),i[c++]=122,i[c++]=n.$bitmapDataId,i[c++]=r.$bitmapX,i[c++]=r.$bitmapY,i[c++]=r.$bitmapWidth,i[c++]=r.$bitmapHeight,i[c++]=r.$offsetY,i[c++]=r.$offsetX,i[c++]=r.textureHeight,i[c++]=r.textureWidth,i[c++]=r.$sourceWidth,i[c++]=r.$sourceHeight,i[c++]=r.$rotated?1:0,l++,i[c++]=121,i[c++]=this.id,i[c++]=n.$bitmapDataId,l++}else t.setValuesToBitmapData(r),i[c++]=121,i[c++]=this.id,i[c++]=r.$textureId,l++},t.prototype.setBitmapDataToMesh=function(e){return e?(t.setValuesToBitmapData(e),i[c++]=147,i[c++]=this.id,i[c++]=e.$textureId,void l++):(i[c++]=147,i[c++]=this.id,i[c++]=-1,void l++)},t.prototype.setBitmapDataToParticle=function(e){t.setValuesToBitmapData(e),i[c++]=902,i[c++]=this.id,i[c++]=e.$textureId,l++},t.prototype.setStopToParticle=function(t){i[c++]=903,i[c++]=this.id,i[c++]=t?1:0,l++},t.prototype.setCustomData=function(t){i[c++]=901,i[c++]=this.id;t.length;i[c++]=t.length;for(var e=0;e<t.length;e++)i[c++]=t[e];l++},t.prototype.setWidth=function(t){i[c++]=114,i[c++]=this.id,i[c++]=t,l++},t.prototype.setHeight=function(t){i[c++]=115,i[c++]=this.id,i[c++]=t,l++},t.prototype.setCacheAsBitmap=function(t){i[c++]=135,i[c++]=this.id,i[c++]=t?1:0,l++},t.prototype.setScale9Grid=function(t,e,r,n){i[c++]=124,i[c++]=this.id,i[c++]=t,i[c++]=e,i[c++]=r,i[c++]=n,l++},t.prototype.setMatrix=function(t,e,r,n,a,o){i[c++]=125,i[c++]=this.id,i[c++]=t,i[c++]=e,i[c++]=r,i[c++]=n,i[c++]=a,i[c++]=o,l++},t.prototype.setIsTyping=function(t){i[c++]=137,i[c++]=this.id,i[c++]=t?1:0,l++},t.prototype.setTextRect=function(t,e,r,n){i[c++]=138,i[c++]=this.id,i[c++]=t,i[c++]=e,i[c++]=r,i[c++]=n,l++},t.prototype.setGraphicsRect=function(t,e,r,n,a){a?i[c++]=143:i[c++]=139,i[c++]=this.id,i[c++]=t,i[c++]=e,i[c++]=r,i[c++]=n,l++},t.prototype.setGraphicsRenderData=function(t){i[c++]=1003,i[c++]=this.id;var e=t.length;i[c++]=e;for(var r=0;e>r;r++)i[c++]=t[r];l++},t.prototype.setDataToBitmapNode=function(e,r,n){t.setValuesToBitmapData(r),i[c++]=1001,i[c++]=e,i[c++]=r.$bitmapData.$bitmapDataId;var a=n.length;i[c++]=a/10;for(var o=0;a>o;o++)i[c++]=n[o];l++},t.prototype.setDataToMesh=function(t,e,r){i[c++]=144,i[c++]=this.id;var n=t.length;i[c++]=n;for(var a=0;n>a;a++)i[c++]=t[a];i[c++]=146,i[c++]=this.id,n=e.length,i[c++]=n;for(var a=0;n>a;a++)i[c++]=e[a];i[c++]=145,i[c++]=this.id,n=r.length,i[c++]=n;for(var a=0;n>a;a++)i[c++]=r[a];l+=3},t.setDataToFilter=function(t){if(u!==!1){var e,n=r[t],a=[];h[n.$id]||(h[n.$id]=[]);var o=h[n.$id],d="",p="";"custom"==n.type?(d=n.$vertexSrc,p=n.$fragmentSrc,e=4):"colorTransform"==n.type?e=1:"blur"==n.type?e=2:"glow"==n.type&&(e=3);var f="",g=0,v=n.$uniforms;for(var y in v)f+=y,f+=" ",o[g]=y,g++;s[n.$id]={vertexSrc:d,fragmentSrc:p,uniformsSrc:f};for(var $=0;$<o.length;$++){var m=v[o[$]],b=typeof m;if("number"==b)a.push(1),a.push(m);else if(m instanceof Array){a.push(m.length);for(var x=0;x<m.length;x++)a.push(m[x])}else if("object"==b){a.push(1);var T=1;null!==m.x&&void 0!==m.x&&(T++,a.push(m.x)),null!==m.y&&void 0!==m.y&&(T++,a.push(m.y)),null!==m.z&&void 0!==m.z&&(T++,a.push(m.z)),null!==m.w&&void 0!==m.w&&(T++,a.push(m.w)),a[a.length-T]=T-1}}i[c++]=1004,i[c++]=t,i[c++]=e;var w=a.length;i[c++]=w;for(var $=0;w>$;$++)i[c++]=a[$];l++}},t.prototype.setDataToTextField=function(t,e){i[c++]=1002,i[c++]=t;var r=e.length;i[c++]=r;for(var n=0;r>n;n++)i[c++]=e[n];l++},t.prototype.disposeDisplayObject=function(){i[c++]=140,i[c++]=this.id,l++},t.disposeTexture=function(t){i[c++]=141,i[c++]=t.$textureId,l++},t.disposeBitmapData=function(t){t.$bitmapDataId&&delete e[t.$bitmapDataId]},t.disposeFilter=function(t){i[c++]=142,i[c++]=t.$id,l++,delete r[t.$id];var e=t;e.blurXFilter&&delete r[e.blurXFilter.$id],e.blurYFilter&&delete r[e.blurYFilter.$id]},t}();t.NativeNode=d,__reflect(d.prototype,"egret.NativeNode")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r){var i=t.call(this,e)||this;return i.firstCharHeight=0,"string"==typeof r?i.charList=i.parseConfig(r):r&&r.hasOwnProperty("frames")?i.charList=r.frames:i.charList={},i}return __extends(e,t),e.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var r=this.charList[t];if(!r)return null;e=this.createTexture(t,r.x,r.y,r.w,r.h,r.offX,r.offY,r.sourceW,r.sourceH),this._textureMap[t]=e}return e},e.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},e.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var r=e.sourceH;if(void 0===r){var i=e.h;void 0===i&&(i=0);var n=e.offY;void 0===n&&(n=0),r=i+n}if(0>=r)continue;this.firstCharHeight=r;break}}return this.firstCharHeight},e.prototype.parseConfig=function(t){t=t.split("\r\n").join("\n");for(var e=t.split("\n"),r=this.getConfigByKey(e[3],"count"),i={},n=4;4+r>n;n++){var a=e[n],o=String.fromCharCode(this.getConfigByKey(a,"id")),s={};i[o]=s,s.x=this.getConfigByKey(a,"x"),s.y=this.getConfigByKey(a,"y"),s.w=this.getConfigByKey(a,"width"),s.h=this.getConfigByKey(a,"height"),s.offX=this.getConfigByKey(a,"xoffset"),s.offY=this.getConfigByKey(a,"yoffset"),s.xadvance=this.getConfigByKey(a,"xadvance")}return i},e.prototype.getConfigByKey=function(t,e){for(var r=t.split(" "),i=0,n=r.length;n>i;i++){var a=r[i];if(e==a.substring(0,e.length)){var o=a.substring(e.length+1);return parseInt(o)}}return 0},e}(t.SpriteSheet);t.BitmapFont=e,__reflect(e.prototype,"egret.BitmapFont")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var r=e.call(this)||this;return r.$smoothing=t.Bitmap.defaultSmoothing,r.$text="",r.$textFieldWidth=0/0,r.$textLinesChanged=!1,r.$textFieldHeight=0/0,r.$font=null,r.$fontStringChanged=!1,r.$lineSpacing=0,r.$letterSpacing=0,r.$textAlign=t.HorizontalAlign.LEFT,r.$verticalAlign=t.VerticalAlign.TOP,r.$textWidth=0/0,r.$textHeight=0/0,r.$textOffsetX=0,r.$textOffsetY=0,r.$textStartX=0,r.$textStartY=0,r.$lineHeights=[],t.nativeRender||(r.$renderNode=new t.sys.BitmapNode),r}return __extends(r,e),r.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(11)},Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){var e=this;t!=e.$smoothing&&(e.$smoothing=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"text",{get:function(){return this.$text},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),r.prototype.$setText=function(t){null==t&&(t="");var e=this;return t==e.$text?!1:(e.$text=t,e.$invalidateContentBounds(),!0)},r.prototype.$getWidth=function(){var t=this,e=t.$textFieldWidth;return isNaN(e)?t.$getContentBounds().width:e},r.prototype.$setWidth=function(t){var e=this;return 0>t||t==e.$textFieldWidth?!1:(e.$textFieldWidth=t,e.$invalidateContentBounds(),!0)},r.prototype.$invalidateContentBounds=function(){this.$renderDirty=!0,this.$textLinesChanged=!0,this.$updateRenderNode()},r.prototype.$getHeight=function(){var t=this,e=t.$textFieldHeight;return isNaN(e)?t.$getContentBounds().height:e},r.prototype.$setHeight=function(t){var e=this;return 0>t||t==e.$textFieldHeight?!1:(e.$textFieldHeight=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"font",{get:function(){return this.$font},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),r.prototype.$setFont=function(t){var e=this;return e.$font==t?!1:(e.$font=t,e.$fontStringChanged=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"lineSpacing",{get:function(){return this.$lineSpacing},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),r.prototype.$setLineSpacing=function(t){var e=this;return e.$lineSpacing==t?!1:(e.$lineSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"letterSpacing",{get:function(){return this.$letterSpacing},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),r.prototype.$setLetterSpacing=function(t){var e=this;return e.$letterSpacing==t?!1:(e.$letterSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),r.prototype.$setTextAlign=function(t){var e=this;return e.$textAlign==t?!1:(e.$textAlign=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(r.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),r.prototype.$setVerticalAlign=function(t){var e=this;return e.$verticalAlign==t?!1:(e.$verticalAlign=t,e.$invalidateContentBounds(),!0)},r.prototype.$updateRenderNode=function(){var e=this,i=this.$getTextLines(),n=i.length;if(0!=n){var a,o=[],s=this.$textLinesWidth,h=e.$font;t.nativeRender||(a=this.$renderNode,h.$texture&&(a.image=h.$texture.$bitmapData),a.smoothing=e.$smoothing);for(var c=h._getFirstCharHeight(),l=Math.ceil(c*r.EMPTY_FACTOR),u=!isNaN(e.$textFieldHeight),d=e.$textWidth,p=e.$textFieldWidth,f=e.$textFieldHeight,g=e.$textAlign,v=this.$textOffsetY+this.$textStartY,y=this.$lineHeights,$=0;n>$;$++){var m=y[$];if(u&&$>0&&v+m>f)break;var b=i[$],x=b.length,T=this.$textOffsetX;if(g!=t.HorizontalAlign.LEFT){var w=p>d?p:d;g==t.HorizontalAlign.RIGHT?T+=w-s[$]:g==t.HorizontalAlign.CENTER&&(T+=Math.floor((w-s[$])/2))}for(var _=0;x>_;_++){var E=b.charAt(_),S=h.getTexture(E);if(S){var C=S.$bitmapWidth,D=S.$bitmapHeight;t.nativeRender?o.push(S.$bitmapX,S.$bitmapY,C,D,T+S.$offsetX,v+S.$offsetY,S.$getScaleBitmapWidth(),S.$getScaleBitmapHeight(),S.$sourceWidth,S.$sourceHeight):(a.imageWidth=S.$sourceWidth,a.imageHeight=S.$sourceHeight,a.drawImage(S.$bitmapX,S.$bitmapY,C,D,T+S.$offsetX,v+S.$offsetY,S.$getScaleBitmapWidth(),S.$getScaleBitmapHeight())),T+=(h.getConfig(E,"xadvance")||S.$getTextureWidth())+e.$letterSpacing}else" "==E?T+=l:t.$warn(1046,E)}v+=m+e.$lineSpacing}if(t.nativeRender){e.$nativeNode.setDataToBitmapNode(e.$nativeNode.id,h.$texture,o);var R=e.$getContentBounds();e.$nativeNode.setWidth(R.width),e.$nativeNode.setHeight(R.height)}}},r.prototype.$measureContentBounds=function(t){var e=this.$getTextLines();0==e.length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$textWidth-this.$textOffsetX,this.$textHeight-this.$textOffsetY)},Object.defineProperty(r.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$textHeight},enumerable:!0,configurable:!0}),r.prototype.$getTextLines=function(){function e(t){return m&&n.length>0&&f>m?!1:(f+=c+u,s||h||(l-=d),n.push(t),o.push(c),a.push(l),p=Math.max(l,p),!0)}var i=this;if(!i.$textLinesChanged)return i.textLines;var n=[];i.textLines=n;var a=[];i.$textLinesWidth=a,i.$textLinesChanged=!1;var o=[];if(i.$lineHeights=o,!i.$text||!i.$font)return n;for(var s,h,c,l,u=i.$lineSpacing,d=i.$letterSpacing,p=0,f=0,g=0,v=0,y=!isNaN(i.$textFieldWidth),$=i.$textFieldWidth,m=i.$textFieldHeight,b=i.$font,x=b._getFirstCharHeight(),T=Math.ceil(x*r.EMPTY_FACTOR),w=i.$text,_=w.split(/(?:\r\n|\r|\n)/),E=_.length,S=!0,C=0;E>C;C++){var D=_[C],R=D.length;c=0,l=0,s=!0,h=!1;for(var O=0;R>O;O++){s||(l+=d);var L=D.charAt(O),A=void 0,M=void 0,B=0,F=0,P=b.getTexture(L);if(P)A=P.$getTextureWidth(),M=P.$getTextureHeight(),B=P.$offsetX,F=P.$offsetY;else{if(" "!=L){t.$warn(1046,L),s&&(s=!1);continue}A=T,M=x}if(s&&(s=!1,g=Math.min(B,g)),S&&(S=!1,v=Math.min(F,v)),y&&O>0&&l+A>$){if(!e(D.substring(0,O)))break;D=D.substring(O),R=D.length,O=0,l=O==R-1?A:b.getConfig(L,"xadvance")||A,c=M}else l+=O==R-1?A:b.getConfig(L,"xadvance")||A,c=Math.max(M,c)}if(m&&C>0&&f>m)break;if(h=!0,!e(D))break}f-=u,i.$textWidth=p,i.$textHeight=f,this.$textOffsetX=g,this.$textOffsetY=v,this.$textStartX=0,this.$textStartY=0;var N;return $>p&&(N=i.$textAlign,N==t.HorizontalAlign.RIGHT?this.$textStartX=$-p:N==t.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor(($-p)/2))),m>f&&(N=i.$verticalAlign,N==t.VerticalAlign.BOTTOM?this.$textStartY=m-f:N==t.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((m-f)/2))),n},r.EMPTY_FACTOR=.33,r}(t.DisplayObject);t.BitmapText=e,__reflect(e.prototype,"egret.BitmapText")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.HorizontalAlign=e,__reflect(e.prototype,"egret.HorizontalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}return e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var r=this.replaceArr[e][0],i=this.replaceArr[e][1];t=t.replace(r,i)}return t},e.prototype.parse=function(e){this.stackArray=[],this.resutlArr=[];for(var r=0,i=e.length;i>r;){var n=e.indexOf("<",r);if(0>n)this.addToResultArr(e.substring(r)),r=i;else{this.addToResultArr(e.substring(r,n));var a=e.indexOf(">",n);-1==a?(t.$error(1038),a=n):"/"==e.charAt(n+1)?this.stackArray.pop():this.addToArray(e.substring(n+1,a)),r=a+1}}return this.resutlArr},e.prototype.parser=function(t){return this.parse(t)},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),this.stackArray.length>0?this.resutlArr.push({text:t,style:this.stackArray[this.stackArray.length-1]}):this.resutlArr.push({text:t}))},e.prototype.changeStringToObject=function(t){t=t.trim();var e={},r=[];if("i"==t.charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(e,t,"true");else if(r=t.match(/^(font|a)\s/)){t=t.substring(r[0].length).trim();for(var i=0,n=void 0;n=t.match(this.getHeadReg());){var a=n[0],o="";t=t.substring(a.length).trim(),'"'==t.charAt(0)?(i=t.indexOf('"',1),o=t.substring(1,i),i+=1):"'"==t.charAt(0)?(i=t.indexOf("'",1),o=t.substring(1,i),i+=1):(o=t.match(/(\S)+/)[0],i=o.length),this.addProperty(e,a.substring(0,a.length-1).trim(),o.trim()),t=t.substring(i).trim()}}return e},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,r){switch(e.toLowerCase()){case"color":case"textcolor":r=r.replace(/#/,"0x"),t.textColor=parseInt(r);break;case"strokecolor":r=r.replace(/#/,"0x"),t.strokeColor=parseInt(r);break;case"stroke":t.stroke=parseInt(r);break;case"b":case"bold":t.bold="true"==r;break;case"u":t.underline="true"==r;break;case"i":case"italic":t.italic="true"==r;break;case"size":t.size=parseInt(r);break;case"fontfamily":t.fontFamily=r;break;case"href":t.href=this.replaceSpecial(r);break;case"target":t.target=this.replaceSpecial(r)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var r=this.stackArray[this.stackArray.length-1];for(var i in r)null==e[i]&&(e[i]=r[i]);this.stackArray.push(e)}},e}();t.HtmlTextParser=e,__reflect(e.prototype,"egret.HtmlTextParser")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}return __extends(r,e),r.prototype.init=function(e){this._text=e,this.stageText=new t.StageText,this.stageText.$setTextField(this._text)},r.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},r.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)},r.prototype._getText=function(){return this.stageText.$getText()},r.prototype._setText=function(t){this.stageText.$setText(t)},r.prototype._setColor=function(t){this.stageText.$setColor(t)},r.prototype.focusHandler=function(e){this._isFocus||(this._isFocus=!0,e.showing||(this._text.$isTyping=!0,this._text.$invalidateTextField()),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_IN,!0)))},r.prototype.blurHandler=function(e){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$isTyping=!1,this._text.$invalidateTextField(),this.stageText.$onBlur(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_OUT,!0)))},r.prototype.onMouseDownHandler=function(t){this.$onFocus()},r.prototype.$onFocus=function(){var e=this;this._text.visible&&(this._isFocus||(this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),t.callLater(function(){e.tempStage.addEventListener(t.TouchEvent.TOUCH_BEGIN,e.onStageDownHandler,e)},this),this.stageText.$show()))},r.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},r.prototype.updateTextHandler=function(e){var r,i,n=this._text.$TextField,a=this.stageText.$getText(),o=!1;null!=n[35]&&(r=new RegExp("["+n[35]+"]","g"),i=a.match(r),a=i?i.join(""):"",o=!0),null!=n[36]&&(r=new RegExp("[^"+n[36]+"]","g"),i=a.match(r),a=i?i.join(""):"",o=!0),o&&this.stageText.$getText()!=a&&this.stageText.$setText(a),this.resetText(),this._text.dispatchEvent(new t.Event(t.Event.CHANGE,!0))},r.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},r.prototype._hideInput=function(){this.stageText.$removeFromStage()},r.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},r.prototype._updateProperties=function(){if(this._isFocus)return this.stageText.$resetStageText(),void this.updateInput();var t=this._text.$stage;if(null==t);else for(var e=this._text,r=e.$visible;;){if(!r)break;if(e=e.parent,e==t)break;r=e.$visible}this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),this.updateInput()},r}(t.HashObject);t.InputController=e,__reflect(e.prototype,"egret.InputController")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.OrientationEvent=e,__reflect(e.prototype,"egret.OrientationEvent")}(egret||(egret={}));var egret;!function(t){function e(e,r,n){n=n||{};var a=null==n.italic?r[16]:n.italic,o=null==n.bold?r[15]:n.bold,s=null==n.size?r[0]:n.size,h=n.fontFamily||r[8]||i.default_fontFamily;return t.sys.measureText(e,h,s,o,a)}var r=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![。，！、》…）)}”】\\.\\,\\!\\?\\]\\:])"),i=function(i){function n(){var e=i.call(this)||this;e.$inputEnabled=!1,e.inputUtils=null,e.$graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1;var r=new t.sys.TextNode;return r.fontFamily=n.default_fontFamily,e.textNode=r,e.$renderNode=r,e.$TextField={0:n.default_size,1:0,2:n.default_textColor,3:0/0,4:0/0,5:0,6:0,7:0,8:n.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT},e}return __extends(n,i),n.prototype.createNativeNode=function(){this.$nativeNode=new t.NativeNode(7)},n.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},n.prototype.$setTouchEnabled=function(t){i.prototype.$setTouchEnabled.call(this,t),this.isInput()&&(this.$inputEnabled=!0)},Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),n.prototype.$setFontFamily=function(t){var e=this.$TextField;return e[8]==t?!1:(e[8]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),n.prototype.$setSize=function(t){var e=this.$TextField;return e[0]==t?!1:(e[0]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),n.prototype.$setBold=function(t){var e=this.$TextField;return t==e[15]?!1:(e[15]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),n.prototype.$setItalic=function(t){var e=this.$TextField;return t==e[16]?!1:(e[16]=t,this.invalidateFontString(),!0)},n.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextAlign=function(t){var e=this.$TextField;return e[9]==t?!1:(e[9]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setVerticalAlign=function(t){var e=this.$TextField;return e[10]==t?!1:(e[10]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),n.prototype.$setLineSpacing=function(t){var e=this.$TextField;return e[1]==t?!1:(e[1]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextColor=function(t){var e=this.$TextField;return e[2]==t?!1:(e[2]=t,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),n.prototype.$setWordWrap=function(t){var e=this.$TextField;t!=e[19]&&(e[20]||(e[19]=t,this.$invalidateTextField()))},Object.defineProperty(n.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),n.prototype.$setType=function(e){var r=this.$TextField;return r[24]!=e?(r[24]=e,e==t.TextFieldType.INPUT?(isNaN(r[3])&&this.$setWidth(100),isNaN(r[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0):!1},Object.defineProperty(n.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(t){this.$TextField[37]=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),n.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},n.prototype.$setBaseText=function(t){null==t&&(t=""),this.isFlow=!1;var e=this.$TextField;if(e[13]!=t){this.$invalidateTextField(),e[13]=t;var r="";return r=e[20]?this.changeToPassText(t):t,this.setMiddleStyle([{text:r}]),!0}return!1},n.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),n.prototype.$setDisplayAsPassword=function(t){var e=this.$TextField;if(e[20]!=t){e[20]=t,this.$invalidateTextField();var r="";return r=t?this.changeToPassText(e[13]):e[13],this.setMiddleStyle([{text:r}]),!0}return!1},Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setStrokeColor=function(e){var r=this.$TextField;return r[25]!=e?(this.$invalidateTextField(),r[25]=e,r[26]=t.toColorString(e),!0):!1},Object.defineProperty(n.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),n.prototype.$setStroke=function(t){return this.$TextField[27]!=t?(this.$invalidateTextField(),this.$TextField[27]=t,!0):!1},Object.defineProperty(n.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),n.prototype.$setMaxChars=function(t){return this.$TextField[21]!=t?(this.$TextField[21]=t,!0):!1},Object.defineProperty(n.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(t){this.$TextField[28]=Math.max(t,1),this.$invalidateTextField()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),n.prototype.$setSelection=function(t,e){return!1},n.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(n.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),n.prototype.$setMultiline=function(t){return this.$TextField[30]=t,this.$invalidateTextField(),!0},Object.defineProperty(n.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var r=-1;r<t.length&&(r=t.indexOf("^",r),0!=r)&&r>0&&"\\"==t.charAt(r-1);)r++;0==r?(e[35]=null,e[36]=t.substring(r+1)):r>0?(e[35]=t.substring(0,r),e[36]=t.substring(r+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),n.prototype.$setWidth=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[3]))return!1;e[3]=0/0}else{if(e[3]==t)return!1;e[3]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),!0)},n.prototype.$setHeight=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[4]))return!1;e[4]=0/0}else{if(e[4]==t)return!1;e[4]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),!0)},n.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},n.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(n.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorder=function(t){this.$TextField[31]=!!t},Object.defineProperty(n.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorderColor=function(t){this.$TextField[32]=+t||0},Object.defineProperty(n.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackground=function(t){this.$TextField[33]=t},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackgroundColor=function(t){this.$TextField[34]=t
},n.prototype.fillBackground=function(e){var r=this.$graphicsNode;r&&r.clear();var i=this.$TextField;if(i[33]||i[31]||e&&e.length>0){if(!r)if(r=this.$graphicsNode=new t.sys.GraphicsNode,t.nativeRender)this.$renderNode=this.textNode;else{var n=new t.sys.GroupNode;n.addNode(r),n.addNode(this.textNode),this.$renderNode=n}var a=void 0,o=void 0;if(i[33]&&(a=r.beginFill(i[34]),a.drawRect(0,0,this.$getWidth(),this.$getHeight())),i[31]&&(o=r.lineStyle(1,i[32]),o.drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1)),e&&e.length>0)for(var s=i[2],h=-1,c=e.length,l=0;c>l;l+=4){var u=e[l],d=e[l+1],p=e[l+2],f=e[l+3]||s;(0>h||h!=f)&&(h=f,o=r.lineStyle(2,f,1,t.CapsStyle.NONE)),o.moveTo(u,d),o.lineTo(u+p,d)}}if(r){var g=this.$getRenderBounds();r.x=g.x,r.y=g.y,r.width=g.width,r.height=g.height,t.Rectangle.release(g)}},n.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus()},n.prototype.$onRemoveFromStage=function(){i.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&this.textNode.clean()},n.prototype.$onAddToStage=function(e,r){i.prototype.$onAddToStage.call(this,e,r),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},n.prototype.$invalidateTextField=function(){var e=this;if(e.$renderDirty=!0,e.$TextField[18]=!0,t.nativeRender)t.NativeDelegate.dirtyTextField(this);else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var i=e.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())}},n.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),r=t.Rectangle.create();r.copyFrom(e),this.$TextField[31]&&(r.width+=2,r.height+=2);var i=2*this.$TextField[27];return i>0&&(r.width+=2*i,r.height+=2*i),r.x-=i+2,r.y-=i+2,r.width=Math.ceil(r.width)+4,r.height=Math.ceil(r.height)+4,r},n.prototype.$measureContentBounds=function(e){this.$getLinesArr();var r=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],i=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4];e.setTo(0,0,r,i)},n.prototype.$updateRenderNode=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.$graphicsNode;return void(e&&e.clear())}var r=this.drawText();this.fillBackground(r);var i=this.$getRenderBounds(),n=this.textNode;n.x=i.x,n.y=i.y,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),t.Rectangle.release(i)},Object.defineProperty(n.prototype,"textFlow",{get:function(){return this.textArr},set:function(t){this.isFlow=!0;var e="";null==t&&(t=[]);for(var r=0;r<t.length;r++){var i=t[r];e+=i.text}this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.setMiddleStyle(t))},enumerable:!0,configurable:!0}),n.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",r=0,i=t.length;i>r;r++)switch(t.charAt(r)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},n.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.$getLinesArr(),this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),n.prototype.appendText=function(t){this.appendElement({text:t})},n.prototype.appendElement=function(t){var e=this.$TextField[13]+t.text;this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.textArr.push(t),this.setMiddleStyle(this.textArr))},n.prototype.$getLinesArr=function(){var i=this.$TextField;if(!i[18])return this.linesArr;i[18]=!1;var n=this.textArr;this.linesArr.length=0,i[6]=0,i[5]=0;var a=i[3];if(!isNaN(a)&&0==a)return i[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var o,s=this.linesArr,h=0,c=0,l=0,u=0,d=0,p=n.length;p>d;d++){var f=n[d];if(f.text){f.style=f.style||{};for(var g=f.text.toString(),v=g.split(/(?:\r\n|\r|\n)/),y=0,$=v.length;$>y;y++){null==s[u]&&(o={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},s[u]=o,h=0,l=0,c=0),l=i[24]==t.TextFieldType.INPUT?i[0]:Math.max(l,f.style.size||i[0]);var m=!0;if(""==v[y])y==$-1&&(m=!1);else{var b=e(v[y],i,f.style);if(isNaN(a))h+=b,c+=v[y].length,o.elements.push({width:b,text:v[y],style:f.style}),y==$-1&&(m=!1);else if(a>=h+b)o.elements.push({width:b,text:v[y],style:f.style}),h+=b,c+=v[y].length,y==$-1&&(m=!1);else{var x=0,T=0,w=v[y],_=void 0;_=i[19]?w.split(r):w.match(/./g);for(var E=_.length,S=0;E>x;x++){var C=_[x].length,D=!1;if(1==C&&E-1>x){var R=_[x].charCodeAt(0),O=_[x+1].charCodeAt(0);if(R>=55296&&56319>=R&&56320==(64512&O)){var L=_[x]+_[x+1];C=2,D=!0,b=e(L,i,f.style)}else b=e(_[x],i,f.style)}else b=e(_[x],i,f.style);if(0!=h&&h+b>a&&h+x!=0)break;if(T+b>a)for(var A=_[x].match(/./g),M=0,B=A.length;B>M;M++){var C=A[M].length,F=!1;if(1==C&&B-1>M){var R=A[M].charCodeAt(0),O=A[M+1].charCodeAt(0);if(R>=55296&&56319>=R&&56320==(64512&O)){var L=A[M]+A[M+1];C=2,F=!0,b=e(L,i,f.style)}else b=e(A[M],i,f.style)}else b=e(A[M],i,f.style);if(M>0&&h+b>a)break;S+=C,T+=b,h+=b,c+=S,F&&M++}else S+=C,T+=b,h+=b,c+=S;D&&x++}if(x>0){o.elements.push({width:T,text:w.substring(0,S),style:f.style});var P=w.substring(S),N=void 0,I=P.length;for(N=0;I>N&&" "==P.charAt(N);N++);v[y]=P.substring(N)}""!=v[y]&&(y--,m=!1)}}m&&(c++,o.hasNextLine=!0),y<v.length-1&&(o.width=h,o.height=l,o.charNum=c,i[5]=Math.max(i[5],h),i[6]+=l,u++)}d==n.length-1&&o&&(o.width=h,o.height=l,o.charNum=c,i[5]=Math.max(i[5],h),i[6]+=l)}else o&&(o.width=h,o.height=l,o.charNum=c,i[5]=Math.max(i[5],h),i[6]+=l)}return i[29]=s.length,s},n.prototype.drawText=function(){var e=this.textNode,r=this.$TextField;e.bold=r[15],e.fontFamily=r[8]||n.default_fontFamily,e.italic=r[16],e.size=r[0],e.stroke=r[27],e.strokeColor=r[25],e.textColor=r[2];var i=this.$getLinesArr();if(0==r[5])return[];var a=isNaN(r[3])?r[5]:r[3],o=t.TextFieldUtils.$getTextHeight(this),s=0,h=t.TextFieldUtils.$getStartLine(this),c=r[4];if(!isNaN(c)&&c>o){var l=t.TextFieldUtils.$getValign(this);s+=l*(c-o)}s=Math.round(s);for(var u=t.TextFieldUtils.$getHalign(this),d=0,p=[],f=h,g=r[29];g>f;f++){var v=i[f],y=v.height;if(s+=y/2,f!=h){if(r[24]==t.TextFieldType.INPUT&&!r[30])break;if(!isNaN(c)&&s>c)break}d=Math.round((a-v.width)*u);for(var $=0,m=v.elements.length;m>$;$++){var b=v.elements[$],x=b.style.size||r[0];e.drawText(d,s+(y-x)/2,b.text,b.style),b.style.underline&&p.push(d,s+y/2,b.width,b.style.textColor),d+=b.width}s+=y/2+r[1]}return p},n.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.onTapHandler=function(e){if(this.$TextField[24]!=t.TextFieldType.INPUT){var r=t.TextFieldUtils.$getTextElement(this,e.localX,e.localY);if(null!=r){var i=r.style;if(i&&i.href)if(i.href.match(/^event:/)){var n=i.href.match(/^event:/)[0];t.TextEvent.dispatchTextEvent(this,t.TextEvent.LINK,i.href.substring(n.length))}else open(i.href,i.target||"_blank")}}},n.default_fontFamily="Arial",n.default_size=30,n.default_textColor=16777215,n}(t.DisplayObject);t.TextField=i,__reflect(i.prototype,"egret.TextField")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.TEL="tel",t.PASSWORD="password",t}();t.TextFieldInputType=e,__reflect(e.prototype,"egret.TextFieldInputType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.DYNAMIC="dynamic",t.INPUT="input",t}();t.TextFieldType=e,__reflect(e.prototype,"egret.TextFieldType")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.$getStartLine=function(t){var r=t.$TextField,i=e.$getTextHeight(t),n=0,a=r[4];return isNaN(a)||(a>i||i>a&&(n=Math.max(r[28]-1,0),n=Math.min(r[29]-1,n)),r[30]||(n=Math.max(r[28]-1,0),r[29]>0&&(n=Math.min(r[29]-1,n)))),n},e.$getHalign=function(e){var r=e.$getLinesArr(),i=0;return e.$TextField[9]==t.HorizontalAlign.CENTER?i=.5:e.$TextField[9]==t.HorizontalAlign.RIGHT&&(i=1),e.$TextField[24]==t.TextFieldType.INPUT&&!e.$TextField[30]&&r.length>1&&(i=0),i},e.$getTextHeight=function(e){var r=t.TextFieldType.INPUT!=e.$TextField[24]||e.$TextField[30]?e.$TextField[6]+(e.$TextField[29]-1)*e.$TextField[1]:e.$TextField[0];return r},e.$getValign=function(r){var i=e.$getTextHeight(r),n=r.$TextField[4];if(!isNaN(n)&&n>i){var a=0;return r.$TextField[10]==t.VerticalAlign.MIDDLE?a=.5:r.$TextField[10]==t.VerticalAlign.BOTTOM&&(a=1),a}return 0},e.$getTextElement=function(t,r,i){var n=e.$getHit(t,r,i),a=t.$getLinesArr();return n&&a[n.lineIndex]&&a[n.lineIndex].elements[n.textElementIndex]?a[n.lineIndex].elements[n.textElementIndex]:null},e.$getHit=function(t,r,i){var n=t.$getLinesArr();if(0==t.$TextField[3])return null;var a=0,o=e.$getTextHeight(t),s=0,h=t.$TextField[4];if(!isNaN(h)&&h>o){var c=e.$getValign(t);s=c*(h-o),0!=s&&(i-=s)}for(var l=e.$getStartLine(t),u=0,d=l;d<n.length;d++){var p=n[d];if(u+p.height>=i){i>u&&(a=d+1);break}if(u+=p.height,u+t.$TextField[1]>i)return null;u+=t.$TextField[1]}if(0==a)return null;var f=n[a-1],g=t.$TextField[3];isNaN(g)&&(g=t.textWidth);var v=e.$getHalign(t);r-=v*(g-f.width);for(var y=0,d=0;d<f.elements.length;d++){var $=f.elements[d];if(y+$.width<=r)y+=$.width;else if(r>y)return{lineIndex:a-1,textElementIndex:d}}return null},e.$getScrollNum=function(t){var e=1;if(t.$TextField[30]){var r=t.height,i=t.size,n=t.lineSpacing;e=Math.floor(r/(i+n));var a=r-(i+n)*e;a>i/2&&e++}return e},e}();t.TextFieldUtils=e,__reflect(e.prototype,"egret.TextFieldUtils")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n,a){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===a&&(a=0);var o=e.call(this,t,r,i)||this;return o.bytesLoaded=0,o.bytesTotal=0,o.bytesLoaded=n,o.bytesTotal=a,o}return __extends(r,e),r.dispatchProgressEvent=function(e,i,n,a){void 0===n&&(n=0),void 0===a&&(a=0);var o=t.Event.create(r,i);o.bytesLoaded=n,o.bytesTotal=a;var s=e.dispatchEvent(o);return t.Event.release(o),s},r.PROGRESS="progress",r.SOCKET_DATA="socketData",r}(t.Event);t.ProgressEvent=e,__reflect(e.prototype,"egret.ProgressEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TOP="top",t.BOTTOM="bottom",t.MIDDLE="middle",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.VerticalAlign=e,__reflect(e.prototype,"egret.VerticalAlign")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t._isNeedShow=!1,t.inputElement=null,t.inputDiv=null,t._gscaleX=0,t._gscaleY=0,t.textValue="",t.colorValue=16777215,t._styleInfoes={},t}return __extends(i,r),i.prototype.$setTextField=function(t){return this.$textfield=t,!0},i.prototype.$addToStage=function(){this.htmlInput=t.web.$getTextAdapter(this.$textfield)},i.prototype._initElement=function(){var e=this.$textfield.localToGlobal(0,0),r=e.x,i=e.y,n=this.htmlInput.$scaleX,a=this.htmlInput.$scaleY;this.inputDiv.style.left=r*n+"px",this.inputDiv.style.top=i*a+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=i*a+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*a+"px"):(this.inputDiv.style.top=i*a+"px",this.inputElement.style.top="0px");for(var o=this.$textfield,s=1,h=1,c=0;o.parent;)s*=o.scaleX,h*=o.scaleY,c+=o.rotation,o=o.parent;var l=t.web.getPrefixStyleName("transform");this.inputDiv.style[l]="rotate("+c+"deg)",this._gscaleX=n*s,this._gscaleY=a*h},i.prototype.$show=function(){this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.$textfield.multiline?this.inputElement.type="text":this.inputElement.type=this.$textfield.inputType,this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement()},i.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},i.prototype.executeShow=function(){this.inputElement.value=this.$getText(),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},i.prototype.$hide=function(){this.htmlInput&&this.htmlInput.disconnectStageText(this)},i.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},i.prototype.$setText=function(t){return this.textValue=t,this.resetText(),!0},i.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},i.prototype.$setColor=function(t){return this.colorValue=t,this.resetColor(),!0},i.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",t.toColorString(this.colorValue))},i.prototype.$onBlur=function(){e.Html5Capatibility._System_OS==e.SystemOSType.WPHONE&&t.Event.dispatchEvent(this,"updateText",!1)},i.prototype._onInput=function(){var r=this;if(e.Html5Capatibility._System_OS==e.SystemOSType.WPHONE){var i=this.$textfield.$TextField;null==i[35]&&null==i[36]?(r.textValue=r.inputElement.value,t.Event.dispatchEvent(r,"updateText",!1)):window.setTimeout(function(){r.inputElement&&r.inputElement.selectionStart&&r.inputElement.selectionEnd&&r.inputElement.selectionStart==r.inputElement.selectionEnd&&(r.textValue=r.inputElement.value,t.Event.dispatchEvent(r,"updateText",!1))},0)}else window.setTimeout(function(){r.inputElement&&r.inputElement.selectionStart==r.inputElement.selectionEnd&&(r.textValue=r.inputElement.value,t.Event.dispatchEvent(r,"updateText",!1))},0)},i.prototype.setAreaHeight=function(){var e=this.$textfield;if(e.multiline){var r=t.TextFieldUtils.$getTextHeight(e);if(e.height<=e.size)this.setElementStyle("height",e.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",e.size*this._gscaleY+"px");else if(e.height<r)this.setElementStyle("height",e.height*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px");else{this.setElementStyle("height",(r+e.lineSpacing)*this._gscaleY+"px");var i=(e.height-r)*this._gscaleY,n=t.TextFieldUtils.$getValign(e),a=i*n,o=i-a;this.setElementStyle("padding",a+"px 0px "+o+"px 0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px")}}},i.prototype._onClickHandler=function(e){this._isNeedShow&&(e.stopImmediatePropagation(),this._isNeedShow=!1,this.executeShow(),this.dispatchEvent(new t.Event("focus")))},i.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new t.Event("blur"))},i.prototype.setElementStyle=function(t,e){this.inputElement&&this._styleInfoes[t]!=e&&(this.inputElement.style[t]=e)},i.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},i.prototype.$resetStageText=function(){if(this.inputElement){var e=this.$textfield;this.setElementStyle("fontFamily",e.fontFamily),this.setElementStyle("fontStyle",e.italic?"italic":"normal"),this.setElementStyle("fontWeight",e.bold?"bold":"normal"),this.setElementStyle("textAlign",e.textAlign),this.setElementStyle("fontSize",e.size*this._gscaleY+"px"),this.setElementStyle("color",t.toColorString(e.textColor));var r=void 0;if(e.stage?(r=e.localToGlobal(0,0).x,r=Math.min(e.width,e.stage.stageWidth-r)):r=e.width,this.setElementStyle("width",r*this._gscaleX+"px"),this.setElementStyle("verticalAlign",e.verticalAlign),e.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",e.size*this._gscaleY+"px"),e.height<e.size){this.setElementStyle("height",e.size*this._gscaleY+"px");var i=e.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+i+"px 0px")}else{this.setElementStyle("height",e.size*this._gscaleY+"px");var n=(e.height-e.size)*this._gscaleY,a=t.TextFieldUtils.$getValign(e),o=n*a,i=n-o;i<e.size/2*this._gscaleY&&(i=e.size/2*this._gscaleY),this.setElementStyle("padding",o+"px 0px "+i+"px 0px")}this.inputDiv.style.clip="rect(0px "+e.width*this._gscaleX+"px "+e.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=e.height*this._gscaleY+"px",this.inputDiv.style.width=r*this._gscaleX+"px"}},i}(t.EventDispatcher);e.HTML5StageText=r,__reflect(r.prototype,"egret.web.HTML5StageText",["egret.StageText"]),t.StageText=r}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var r=function(){function e(){this._needShow=!1,this.$scaleX=1,this.$scaleY=1}return e.prototype.isInputOn=function(){return null!=this._stageText},e.prototype.isCurrentStageText=function(t){return this._stageText==t},e.prototype.initValue=function(t){t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.border="none",t.style.padding="0"},e.prototype.$updateSize=function(){if(this.canvas){this.$scaleX=t.sys.DisplayList.$canvasScaleX,this.$scaleY=t.sys.DisplayList.$canvasScaleY,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var e=t.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[e]=this.canvas.style[e],this.StageDelegateDiv.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},e.prototype._initStageDelegateDiv=function(e,r){this.canvas=r;var i,n=this;i||(i=document.createElement("div"),this.StageDelegateDiv=i,i.id="StageDelegateDiv",e.appendChild(i),n.initValue(i),n._inputDIV=document.createElement("div"),n.initValue(n._inputDIV),n._inputDIV.style.width="0px",n._inputDIV.style.height="0px",n._inputDIV.style.left="0px",n._inputDIV.style.top="-100px",n._inputDIV.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",i.appendChild(n._inputDIV),this.canvas.addEventListener("click",function(t){n._needShow?(n._needShow=!1,n._stageText._onClickHandler(t),n.show()):n._inputElement&&(n.clearInputElement(),n._inputElement.blur(),n._inputElement=null)}),n.initInputElement(!0),n.initInputElement(!1))},e.prototype.initInputElement=function(t){var e,r=this;t?(e=document.createElement("textarea"),e.style.resize="none",r._multiElement=e,e.id="egretTextarea"):(e=document.createElement("input"),r._simpleElement=e,e.id="egretInput"),e.type="text",r._inputDIV.appendChild(e),e.setAttribute("tabindex","-1"),e.style.width="1px",e.style.height="12px",r.initValue(e),e.style.outline="thin",e.style.background="none",e.style.overflow="hidden",e.style.wordBreak="break-all",e.style.opacity=0,e.oninput=function(){r._stageText&&r._stageText._onInput()}},e.prototype.show=function(){var e=this,r=e._inputElement;t.$callAsync(function(){r.style.opacity=1},e)},e.prototype.disconnectStageText=function(t){(null==this._stageText||this._stageText==t)&&(this.clearInputElement(),this._inputElement&&this._inputElement.blur())},e.prototype.clearInputElement=function(){var t=this;if(t._inputElement){t._inputElement.value="",t._inputElement.onblur=null,t._inputElement.style.width="1px",t._inputElement.style.height="12px",t._inputElement.style.left="0px",t._inputElement.style.top="0px",t._inputElement.style.opacity=0;var e=void 0;e=t._simpleElement==t._inputElement?t._multiElement:t._simpleElement,e.style.display="block",t._inputDIV.style.left="0px",t._inputDIV.style.top="-100px",t._inputDIV.style.height="0px",t._inputDIV.style.width="0px"}t._stageText&&(t._stageText._onDisconnect(),t._stageText=null,this.canvas.userTyping=!1)},e.prototype.getInputElement=function(t){var e=this;e.clearInputElement(),e._stageText=t,this.canvas.userTyping=!0,e._stageText.$textfield.multiline?e._inputElement=e._multiElement:e._inputElement=e._simpleElement;var r;return r=e._simpleElement==e._inputElement?e._multiElement:e._simpleElement,r.style.display="none",e._inputElement},e}();e.HTMLInput=r,__reflect(r.prototype,"egret.web.HTMLInput")}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=t.stage?t.stage.$hashCode:0,r=i[e],o=n[e],s=a[e];return o&&s&&(delete n[e],delete a[e]),r}function r(t,e,r,o){t._initStageDelegateDiv(r,o),i[e.$hashCode]=t,n[e.$hashCode]=o,a[e.$hashCode]=r}var i={},n={},a={};t.$getTextAdapter=e,t.$cacheTextAdapter=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t,e,r,a,o){n||i();var s="";return o&&(s+="italic "),a&&(s+="bold "),s+=(r||12)+"px ",s+=e||"Arial",n.font=s,n.measureText(t).width}function i(){n=t.sys.canvasHitTestBuffer.context,n.textAlign="left",n.textBaseline="middle"}var n=null;t.sys.measureText=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.encode=function(t){for(var e=new Uint8Array(t),r=e.length,i="",n=0;r>n;n+=3)i+=chars[e[n]>>2],i+=chars[(3&e[n])<<4|e[n+1]>>4],i+=chars[(15&e[n+1])<<2|e[n+2]>>6],i+=chars[63&e[n+2]];return r%3===2?i=i.substring(0,i.length-1)+"=":r%3===1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(t){var e=.75*t.length,r=t.length,i=0,n=0,a=0,o=0,s=0;"="===t[t.length-1]&&(e--,"="===t[t.length-2]&&e--);for(var h=new ArrayBuffer(e),c=new Uint8Array(h),l=0;r>l;l+=4)n=lookup[t.charCodeAt(l)],a=lookup[t.charCodeAt(l+1)],o=lookup[t.charCodeAt(l+2)],s=lookup[t.charCodeAt(l+3)],c[i++]=n<<2|a>>4,c[i++]=(15&a)<<4|o>>2,c[i++]=(3&o)<<6|63&s;return h},t}();t.Base64Util=e,__reflect(e.prototype,"egret.Base64Util")}(egret||(egret={}));for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var egret;!function(t){var e=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=e,__reflect(e.prototype,"egret.Endian");var r=function(){function r(t,r){void 0===r&&(r=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,0>r&&(r=0),this.bufferExtSize=r;var i,n=0;if(t){var a=void 0;if(t instanceof Uint8Array?(a=t,n=t.length):(n=t.byteLength,a=new Uint8Array(t)),0==r)i=new Uint8Array(n);else{var o=(n/r|0)+1;i=new Uint8Array(o*r)}i.set(a)}else i=new Uint8Array(r);this.write_position=n,this._position=0,this._bytes=i,this.data=new DataView(i.buffer),this.endian=e.BIG_ENDIAN}return Object.defineProperty(r.prototype,"endian",{get:function(){return 0==this.$endian?e.LITTLE_ENDIAN:e.BIG_ENDIAN},set:function(t){this.$endian=t==e.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),r.prototype.setArrayBuffer=function(t){},Object.defineProperty(r.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,r=t.byteLength,i=new Uint8Array(t),n=this.bufferExtSize;if(0==n)e=new Uint8Array(r);else{var a=(r/n|0)+1;e=new Uint8Array(a*n)}e.set(i),this.write_position=r,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),r.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,r=void 0;if(0==e)r=new Uint8Array(t);else{var i=((t/e>>0)+1)*e;r=new Uint8Array(i)}r.set(this._bytes),this._bytes=r,this.data=new DataView(r.buffer)}},Object.defineProperty(r.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),r.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},r.prototype.readBoolean=function(){return this.validate(1)?!!this._bytes[this.position++]:void 0},r.prototype.readByte=function(){return this.validate(1)?this.data.getInt8(this.position++):void 0},r.prototype.readBytes=function(e,r,i){if(void 0===r&&(r=0),void 0===i&&(i=0),e){var n=this._position,a=this.write_position-n;if(0>a)return void t.$error(1025);if(0==i)i=a;else if(i>a)return void t.$error(1025);e.validateBuffer(r+i),e._bytes.set(this._bytes.subarray(n,n+i),r),this.position+=i}},r.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},r.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},r.prototype.readUnsignedByte=function(){return this.validate(1)?this._bytes[this.position++]:void 0},r.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},r.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},r.prototype.readUTF=function(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""},r.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,r=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(r)}},r.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},r.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},r.prototype.writeBytes=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=0);var i;0>e||0>r||(i=0==r?t.length-e:Math.min(t.length-e,r),i>0&&(this.validateBuffer(i),this._bytes.set(t._bytes.subarray(e,e+i),this._position),this.position=this._position+i))},r.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},r.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},r.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},r.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},r.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),r=e.length;this.validateBuffer(2+r),this.data.setUint16(this._position,r,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},r.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},r.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},r.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0);var r=this._position,i=r+t.length;e&&this.validateBuffer(i),this.bytes.set(t,r),this.position=i},r.prototype.validate=function(e){var r=this._bytes.length;return r>0&&this._position+e<=r?!0:void t.$error(1025)},r.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},r.prototype.encodeUTF8=function(t){for(var e=0,r=this.stringToCodePoints(t),i=[];r.length>e;){var n=r[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))i.push(n);else{var a=void 0,o=void 0;for(this.inRange(n,128,2047)?(a=1,o=192):this.inRange(n,2048,65535)?(a=2,o=224):this.inRange(n,65536,1114111)&&(a=3,o=240),i.push(this.div(n,Math.pow(64,a))+o);a>0;){var s=this.div(n,Math.pow(64,a-1));i.push(128+s%64),a-=1}}}return new Uint8Array(i)},r.prototype.decodeUTF8=function(t){for(var e,r=!1,i=0,n="",a=0,o=0,s=0,h=0;t.length>i;){var c=t[i++];if(c==this.EOF_byte)e=0!=o?this.decoderError(r):this.EOF_code_point;else if(0==o)this.inRange(c,0,127)?e=c:(this.inRange(c,194,223)?(o=1,h=128,a=c-192):this.inRange(c,224,239)?(o=2,h=2048,a=c-224):this.inRange(c,240,244)?(o=3,h=65536,a=c-240):this.decoderError(r),a*=Math.pow(64,o),e=null);else if(this.inRange(c,128,191))if(s+=1,a+=(c-128)*Math.pow(64,o-s),s!==o)e=null;else{var l=a,u=h;a=0,o=0,s=0,h=0,e=this.inRange(l,u,1114111)&&!this.inRange(l,55296,57343)?l:this.decoderError(r,c)}else a=0,o=0,s=0,h=0,i--,e=this.decoderError(r,c);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},r.prototype.encoderError=function(e){t.$error(1026,e)},r.prototype.decoderError=function(e,r){return e&&t.$error(1027),r||65533},r.prototype.inRange=function(t,e,r){return t>=e&&r>=t},r.prototype.div=function(t,e){return Math.floor(t/e)},r.prototype.stringToCodePoints=function(t){for(var e=[],r=0,i=t.length;r<t.length;){var n=t.charCodeAt(r);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(r==i-1)e.push(65533);else{var a=t.charCodeAt(r+1);if(this.inRange(a,56320,57343)){var o=1023&n,s=1023&a;r+=1,e.push(65536+(o<<10)+s)}else e.push(65533)}else e.push(n);r+=1}return e},r}();t.ByteArray=r,__reflect(r.prototype,"egret.ByteArray")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),e.call(this,t,r,i)||this}return __extends(r,e),r.dispatchStageOrientationEvent=function(e,i){var n=t.Event.create(r,i),a=e.dispatchEvent(n);return t.Event.release(n),a},r.ORIENTATION_CHANGE="orientationChange",r}(t.Event);t.StageOrientationEvent=e,__reflect(e.prototype,"egret.StageOrientationEvent")}(egret||(egret={}));var egret;!function(t){function e(e,r){t.useFontMapping=!0,t.fontMapping[e]=r}t.fontMapping={},t.useFontMapping=!1,t.registerFontMapping=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,n){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n="");var a=e.call(this,t,r,i)||this;return a.text=n,a}return __extends(r,e),r.dispatchTextEvent=function(e,i,n){var a=t.Event.create(r,i);a.text=n;var o=e.dispatchEvent(a);return t.Event.release(a),o},r.LINK="link",r}(t.Event);t.TextEvent=e,__reflect(e.prototype,"egret.TextEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i){return e.call(this,t,r,i)||this}return __extends(r,e),r.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},r.dispatchTimerEvent=function(e,i,n,a){var o=t.Event.create(r,i,n,a),s=e.dispatchEvent(o);return t.Event.release(o),s},r.TIMER="timer",r.TIMER_COMPLETE="timerComplete",r}(t.Event);t.TimerEvent=e,__reflect(e.prototype,"egret.TimerEvent")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t
}var r=function(r){function i(){var e=r.call(this)||this;return e.lastX=0,e.lastY=0,e.fillPath=null,e.strokePath=null,e.topLeftStrokeWidth=0,e.bottomRightStrokeWidth=0,e.minX=1/0,e.minY=1/0,e.maxX=-(1/0),e.maxY=-(1/0),e.includeLastPosition=!0,e.$renderNode=new t.sys.GraphicsNode,e}return __extends(i,r),i.prototype.$setTarget=function(e){this.$targetDisplay&&(this.$targetDisplay.$renderNode=null),e.$renderNode=this.$renderNode,this.$targetDisplay=e,this.$targetIsSprite=e instanceof t.Sprite},i.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},i.prototype.beginFill=function(t,e){void 0===e&&(e=1),t=+t||0,e=+e||0,this.fillPath=this.$renderNode.beginFill(t,e,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},i.prototype.beginGradientFill=function(t,e,r,i,n){void 0===n&&(n=null),this.fillPath=this.$renderNode.beginGradientFill(t,e,r,i,n,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},i.prototype.endFill=function(){this.fillPath=null},i.prototype.lineStyle=function(t,e,r,i,n,a,o,s,h){void 0===t&&(t=0/0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=!1),void 0===n&&(n="normal"),void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=3),t=+t||0,0>=t?(this.strokePath=null,this.setStrokeWidth(0)):(e=+e||0,r=+r||0,s=+s||0,this.setStrokeWidth(t),this.strokePath=this.$renderNode.lineStyle(t,e,r,a,o,s),h&&this.strokePath.setLineDash(h),this.$renderNode.drawData.length>1&&this.strokePath.moveTo(this.lastX,this.lastY))},i.prototype.drawRect=function(t,e,r,i){t=+t||0,e=+e||0,r=+r||0,i=+i||0;var n=this.fillPath,a=this.strokePath;n&&n.drawRect(t,e,r,i),a&&a.drawRect(t,e,r,i),this.extendBoundsByPoint(t+r,e+i),this.updatePosition(t,e),this.dirty()},i.prototype.drawRoundRect=function(t,e,r,i,n,a){t=+t||0,e=+e||0,r=+r||0,i=+i||0,n=+n||0,a=+a||0;var o=this.fillPath,s=this.strokePath;o&&o.drawRoundRect(t,e,r,i,n,a),s&&s.drawRoundRect(t,e,r,i,n,a);var h=.5*n|0,c=a?.5*a|0:h,l=t+r,u=e+i,d=u-c;this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(l,u),this.updatePosition(l,d),this.dirty()},i.prototype.drawCircle=function(t,e,r){t=+t||0,e=+e||0,r=+r||0;var i=this.fillPath,n=this.strokePath;i&&i.drawCircle(t,e,r),n&&n.drawCircle(t,e,r),this.extendBoundsByPoint(t-r-1,e-r-1),this.extendBoundsByPoint(t+r+2,e+r+2),this.updatePosition(t+r,e),this.dirty()},i.prototype.drawEllipse=function(t,e,r,i){t=+t||0,e=+e||0,r=+r||0,i=+i||0;var n=this.fillPath,a=this.strokePath;n&&n.drawEllipse(t,e,r,i),a&&a.drawEllipse(t,e,r,i),this.extendBoundsByPoint(t-1,e-1),this.extendBoundsByPoint(t+r+2,e+i+2),this.updatePosition(t+r,e+.5*i),this.dirty()},i.prototype.moveTo=function(t,e){t=+t||0,e=+e||0;var r=this.fillPath,i=this.strokePath;r&&r.moveTo(t,e),i&&i.moveTo(t,e),this.includeLastPosition=!1,this.lastX=t,this.lastY=e,this.dirty()},i.prototype.lineTo=function(t,e){t=+t||0,e=+e||0;var r=this.fillPath,i=this.strokePath;r&&r.lineTo(t,e),i&&i.lineTo(t,e),this.updatePosition(t,e),this.dirty()},i.prototype.curveTo=function(t,e,r,i){t=+t||0,e=+e||0,r=+r||0,i=+i||0;var n=this.fillPath,a=this.strokePath;n&&n.curveTo(t,e,r,i),a&&a.curveTo(t,e,r,i),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(r,i),this.updatePosition(r,i),this.dirty()},i.prototype.cubicCurveTo=function(t,e,r,i,n,a){t=+t||0,e=+e||0,r=+r||0,i=+i||0,n=+n||0,a=+a||0;var o=this.fillPath,s=this.strokePath;o&&o.cubicCurveTo(t,e,r,i,n,a),s&&s.cubicCurveTo(t,e,r,i,n,a),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(r,i),this.extendBoundsByPoint(n,a),this.updatePosition(n,a),this.dirty()},i.prototype.drawArc=function(t,r,i,n,a,o){if(!(0>i||n===a)){t=+t||0,r=+r||0,i=+i||0,n=+n||0,a=+a||0,o=!!o,n=e(n),a=e(a);var s=this.fillPath,h=this.strokePath;s&&(s.$lastX=this.lastX,s.$lastY=this.lastY,s.drawArc(t,r,i,n,a,o)),h&&(h.$lastX=this.lastX,h.$lastY=this.lastY,h.drawArc(t,r,i,n,a,o)),o?this.arcBounds(t,r,i,a,n):this.arcBounds(t,r,i,n,a);var c=t+Math.cos(a)*i,l=r+Math.sin(a)*i;this.updatePosition(c,l),this.dirty()}},i.prototype.dirty=function(){var e=this;e.$renderNode.dirtyRender=!0,t.nativeRender&&t.NativeDelegate.dirtyGraphics(e)},i.prototype.arcBounds=function(t,e,r,i,n){var a=Math.PI;if(Math.abs(i-n)<.01)return this.extendBoundsByPoint(t-r,e-r),void this.extendBoundsByPoint(t+r,e+r);i>n&&(n+=2*a);for(var o=Math.cos(i)*r,s=Math.cos(n)*r,h=Math.min(o,s),c=Math.max(o,s),l=Math.sin(i)*r,u=Math.sin(n)*r,d=Math.min(l,u),p=Math.max(l,u),f=i/(.5*a),g=n/(.5*a),v=Math.ceil(f);g>=v;v++)switch(v%4){case 0:c=r;break;case 1:p=r;break;case 2:h=-r;break;case 3:d=-r}h=Math.floor(h),d=Math.floor(d),c=Math.ceil(c),p=Math.ceil(p),this.extendBoundsByPoint(h+t,d+e),this.extendBoundsByPoint(c+t,p+e)},i.prototype.clear=function(){this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0),this.dirty()},i.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},i.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},i.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},i.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX,t.y=this.minY,t.width=Math.ceil(this.maxX-this.minX),t.height=Math.ceil(this.maxY-this.minY)},i.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e)},i.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},i.prototype.$hitTest=function(e,r){var i=this.$targetDisplay,n=i.$getInvertedConcatenatedMatrix(),a=n.a*e+n.c*r+n.tx,o=n.b*e+n.d*r+n.ty,s=t.sys.canvasHitTestBuffer;s.resize(3,3);var h=this.$renderNode,c=t.Matrix.create();c.identity(),c.translate(1-a,1-o),t.sys.canvasRenderer.drawNodeToBuffer(h,s,c,!0),t.Matrix.release(c);try{var l=s.getPixels(1,1);if(0===l[3])return null}catch(u){throw new Error(t.sys.tr(1039))}return i},i.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean()},i}(t.HashObject);t.Graphics=r,__reflect(r.prototype,"egret.Graphics")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){var r=Math.floor(e),i=r+1,n=t.sinInt(r);if(r==e)return n;var a=t.sinInt(i);return(e-r)*a+(i-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),egret_sin_map[t]},t.cos=function(e){var r=Math.floor(e),i=r+1,n=t.cosInt(r);if(r==e)return n;var a=t.cosInt(i);return(e-r)*a+(i-e)*n},t.cosInt=function(t){return t%=360,0>t&&(t+=360),egret_cos_map[t]},t}();t.NumberUtils=e,__reflect(e.prototype,"egret.NumberUtils")}(egret||(egret={}));for(var egret_sin_map={},egret_cos_map={},DEG_TO_RAD=Math.PI/180,NumberUtils_i=0;360>NumberUtils_i;NumberUtils_i++)egret_sin_map[NumberUtils_i]=Math.sin(NumberUtils_i*DEG_TO_RAD),egret_cos_map[NumberUtils_i]=Math.cos(NumberUtils_i*DEG_TO_RAD);egret_sin_map[90]=1,egret_cos_map[90]=0,egret_sin_map[180]=0,egret_cos_map[180]=-1,egret_sin_map[270]=-1,egret_cos_map[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&egret.$error(1029);var e=Array.prototype.slice.call(arguments,1),r=this,i=function(){},n=function(){return r.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,n.prototype=new i,n});var egret;!function(t){var e=function(e){function r(t,r){void 0===r&&(r=0);var i=e.call(this)||this;return i._delay=0,i._currentCount=0,i._running=!1,i.updateInterval=1e3,i.lastCount=1e3,i.lastTimeStamp=0,i.delay=t,i.repeatCount=0|+r,i}return __extends(r,e),Object.defineProperty(r.prototype,"delay",{get:function(){return this._delay},set:function(t){1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),r.prototype.reset=function(){this.stop(),this._currentCount=0},r.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=t.getTimer(),t.ticker.$startTick(this.$update,this),this._running=!0)},r.prototype.stop=function(){this._running&&(t.stopTick(this.$update,this),this._running=!1)},r.prototype.$update=function(e){var r=e-this.lastTimeStamp;if(r>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=e,this._currentCount++;var i=this.repeatCount>0&&this._currentCount>=this.repeatCount;return t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER),i&&(this.stop(),t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER_COMPLETE)),!1},r}(t.EventDispatcher);t.Timer=e,__reflect(e.prototype,"egret.Timer")}(egret||(egret={}));var egret;!function(t){var e=new t.Point,r=function(r){function i(t,e,i,n,a,o){var s=r.call(this,t,e,i)||this;return s.targetChanged=!0,s.touchDown=!1,s.$initTo(n,a,o),s}return __extends(i,r),i.prototype.$initTo=function(t,e,r){this.touchPointID=+r||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(i.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),i.prototype.getLocalXY=function(){this.targetChanged=!1;var t=this.$target.$getInvertedConcatenatedMatrix();t.transformPoint(this.$stageX,this.$stageY,e),this._localX=e.x,this._localY=e.y},i.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},i.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},i.dispatchTouchEvent=function(e,r,n,a,o,s,h,c){if(void 0===c&&(c=!1),!n&&!e.hasEventListener(r))return!0;var l=t.Event.create(i,r,n,a);l.$initTo(o,s,h),l.touchDown=c;var u=e.dispatchEvent(l);return t.Event.release(l),u},i.TOUCH_MOVE="touchMove",i.TOUCH_BEGIN="touchBegin",i.TOUCH_END="touchEnd",i.TOUCH_CANCEL="touchCancel",i.TOUCH_TAP="touchTap",i.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",i}(t.Event);t.TouchEvent=r,__reflect(r.prototype,"egret.TouchEvent")}(egret||(egret={}));var egret;!function(t){function e(e,r){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t.$callLaterFunctionList.push(e),t.$callLaterThisList.push(r),t.$callLaterArgsList.push(i)}function r(e,r){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];t.$callAsyncFunctionList.push(e),t.$callAsyncThisList.push(r),t.$callAsyncArgsList.push(i)}t.$callLaterFunctionList=[],t.$callLaterThisList=[],t.$callLaterArgsList=[],t.callLater=e,t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[],t.$callAsync=r}(egret||(egret={}));var egret;!function(t){function e(t,e,r){for(var i=[],n=3;n<arguments.length;n++)i[n-3]=arguments[n];var a,o=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}}),a=t.__sets__;var s=a[r];if(s)return s.apply(e,i);var h=Object.getPrototypeOf(o);if(null!=h){for(;!h.hasOwnProperty(r);)if(h=Object.getPrototypeOf(h),null==h)return;s=Object.getOwnPropertyDescriptor(h,r).set,a[r]=s,s.apply(e,i)}}function r(t,e,r){var i,n=t.prototype;t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}}),i=t.__gets__;var a=i[r];if(a)return a.call(e);var o=Object.getPrototypeOf(n);if(null!=o){for(;!o.hasOwnProperty(r);)if(o=Object.getPrototypeOf(o),null==o)return;return a=Object.getOwnPropertyDescriptor(o,r).get,i[r]=a,a.call(e)}}t.superSetter=e,t.superGetter=r}(egret||(egret={}));var egret;!function(t){function e(t){if(!t)return null;var e=r[t];if(e)return e;var i=t.split("."),n=i.length;e=global;for(var a=0;n>a;a++){var o=i[a];if(e=e[o],!e)return null}return r[t]=e,e}var r={};t.getDefinitionByName=e}(egret||(egret={}));var egret;!function(t){t.JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"}}(egret||(egret={}));var egret;!function(t){function e(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var r=t.prototype?t.prototype:Object.getPrototypeOf(t);if(r.hasOwnProperty("__class__"))return r.__class__;var i=r.constructor.toString().trim(),n=i.indexOf("("),a=i.substring(9,n);return Object.defineProperty(r,"__class__",{value:a,enumerable:!1,writable:!0}),a}t.getQualifiedClassName=e}(egret||(egret={}));var egret;!function(t){function e(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var r=e.prototype?e.prototype:Object.getPrototypeOf(e),i=Object.getPrototypeOf(r);if(!i)return null;var n=t.getQualifiedClassName(i.constructor);return n?n:null}t.getQualifiedSuperclassName=e}(egret||(egret={}));var egret;!function(t){function e(){return Date.now()-t.sys.$START_TIME}t.getTimer=e}(egret||(egret={}));var egret;!function(t){function e(e){var r=t.getDefinitionByName(e);return r?!0:!1}t.hasDefinition=e}(egret||(egret={}));var egret;!function(t){function e(t,e){if(!t||"object"!=typeof t)return!1;var r=Object.getPrototypeOf(t),i=r?r.__types__:null;return i?-1!==i.indexOf(e):!1}t.is=e}(egret||(egret={}));var egret;!function(t){function e(e,r){t.ticker.$startTick(e,r)}t.startTick=e}(egret||(egret={}));var egret;!function(t){function e(e,r){t.ticker.$stopTick(e,r)}t.stopTick=e}(egret||(egret={}));var egret;!function(t){function e(t){0>t&&(t=0),t>16777215&&(t=16777215);for(var e=t.toString(16).toUpperCase();e.length>6;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e}t.toColorString=e}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){t.onStart(c),h=t}function i(){if(l)for(var t=document.querySelectorAll(".egret-player"),e=t.length,r=0;e>r;r++){var i=t[r],n=i["egret-player"];n.updateScreenSize()}}function n(r){if(!l){l=!0,r||(r={});var i=navigator.userAgent.toLowerCase();if(i.indexOf("egretnative")>=0&&t.nativeRender)t.NativeDelegate.addModuleCallback(function(){if(e.Html5Capatibility.$init(),"webgl"==r.renderMode){var i=r.antialias;e.WebGLRenderContext.antialias=!!i}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,a(r.renderMode),t.NativeDelegate.setRenderMode(t.Capabilities.$renderMode);var n;n=r.canvasScaleFactor?r.canvasScaleFactor:r.calculateCanvasScaleFactor?r.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context):window.devicePixelRatio,t.sys.DisplayList.$canvasScaleFactor=n;var h=t.ticker;o(h),r.screenAdapter?t.sys.screenAdapter=r.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var c=document.querySelectorAll(".egret-player"),l=c.length,d=0;l>d;d++){var p=c[d],f=new e.WebPlayer(p,r);p["egret-player"]=f}window.addEventListener("resize",function(){isNaN(u)&&(u=window.setTimeout(s,300))})},null),t.NativeDelegate.init();else{if(e.Html5Capatibility._audioType=r.audioType,e.Html5Capatibility.$init(),"webgl"==r.renderMode){var n=r.antialias;e.WebGLRenderContext.antialias=!!n}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,a(r.renderMode);var h=void 0;if(r.canvasScaleFactor)h=r.canvasScaleFactor;else if(r.calculateCanvasScaleFactor)h=r.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context);else{var c=t.sys.canvasHitTestBuffer.context,d=c.backingStorePixelRatio||c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;h=(window.devicePixelRatio||1)/d}t.sys.DisplayList.$canvasScaleFactor=h;var p=t.ticker;o(p),r.screenAdapter?t.sys.screenAdapter=r.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var f=document.querySelectorAll(".egret-player"),g=f.length,v=0;g>v;v++){var y=f[v],$=new e.WebPlayer(y,r);y["egret-player"]=$}window.addEventListener("resize",function(){isNaN(u)&&(u=window.setTimeout(s,300))})}}}function a(r){"webgl"==r&&t.WebGLUtils.checkCanUseWebGL()?(t.sys.RenderBuffer=e.WebGLRenderBuffer,t.sys.systemRenderer=new e.WebGLRenderer,t.sys.canvasRenderer=new t.CanvasRenderer,t.sys.customHitTestBuffer=new e.WebGLRenderBuffer(3,3),t.sys.canvasHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.Capabilities.$renderMode="webgl"):(t.sys.RenderBuffer=e.CanvasRenderBuffer,t.sys.systemRenderer=new t.CanvasRenderer,t.sys.canvasRenderer=t.sys.systemRenderer,t.sys.customHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.sys.canvasHitTestBuffer=t.sys.customHitTestBuffer,t.Capabilities.$renderMode="canvas")}function o(t){function e(){h&&h.onRender(c),t.update(),r(e)}var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;r||(r=function(t){return window.setTimeout(t,1e3/60)}),r(e)}function s(){u=0/0,t.updateAllScreens(),h&&h.onResize(c)}var h,c={setAutoClear:function(t){e.WebGLRenderBuffer.autoClear=t},save:function(){},restore:function(){var t=e.WebGLRenderContext.getInstance(0,0),r=t.context;r.bindBuffer(r.ARRAY_BUFFER,t.vertexBuffer),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer),r.activeTexture(r.TEXTURE0),t.currentProgram=null,t.bindIndices=!1;var i=t.$bufferStack[1];t.activateBuffer(i),r.enable(r.BLEND),t.setBlendMode("source-over")}};t.setRendererContext=r;var l=!1;window.isNaN=function(t){return t=+t,t!==t},t.runEgret=n,t.updateAllScreens=i;var u=0/0}(e=t.web||(t.web={}))}(egret||(egret={}));var language,egret;!function(t){var e;!function(e){function r(t,e){var r="";if(null!=e)r=i(t,e);else{if(null==s){var n=document.createElement("div").style;s=i("transform",n)}r=s}return""==r?t:r+t.charAt(0).toUpperCase()+t.substring(1,t.length)}function i(t,e){if(t in e)return"";t=t.charAt(0).toUpperCase()+t.substring(1,t.length);for(var r=["webkit","ms","Moz","O"],i=0;i<r.length;i++){var n=r[i]+t;if(n in e)return r[i]}return""}var n=function(){function t(){}return t.WEB_AUDIO=2,t.HTML5_AUDIO=3,t}();e.AudioType=n,__reflect(n.prototype,"egret.web.AudioType");var a=function(){function t(){}return t.WPHONE=1,t.IOS=2,t.ADNROID=3,t}();e.SystemOSType=a,__reflect(a.prototype,"egret.web.SystemOSType");var o=function(r){function i(){return r.call(this)||this}return __extends(i,r),i.$init=function(){var r=navigator.userAgent.toLowerCase();i.ua=r,t.Capabilities.$isMobile=-1!=r.indexOf("mobile")||-1!=r.indexOf("android"),i._canUseBlob=!1;var o=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(o)try{e.WebAudioDecode.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}catch(s){o=!1}var h,c=i._audioType;c==n.WEB_AUDIO&&o||c==n.HTML5_AUDIO?(h=!1,i.setAudioType(c)):(h=!0,i.setAudioType(n.HTML5_AUDIO)),r.indexOf("windows phone")>=0?(i._System_OS=a.WPHONE,t.Capabilities.$os="Windows Phone"):r.indexOf("android")>=0?(t.Capabilities.$os="Android",i._System_OS=a.ADNROID,h&&o&&i.setAudioType(n.WEB_AUDIO)):r.indexOf("iphone")>=0||r.indexOf("ipad")>=0||r.indexOf("ipod")>=0?(t.Capabilities.$os="iOS",i._System_OS=a.IOS,i.getIOSVersion()>=7&&(i._canUseBlob=!0,h&&o&&i.setAudioType(n.WEB_AUDIO))):-1!=r.indexOf("windows nt")?t.Capabilities.$os="Windows PC":-1!=r.indexOf("mac os")&&(t.Capabilities.$os="Mac OS");var l=window.URL||window.webkitURL;l||(i._canUseBlob=!1),r.indexOf("egretnative")>=0&&(i.setAudioType(n.HTML5_AUDIO),i._canUseBlob=!0),t.Sound=i._AudioClass},i.setAudioType=function(e){switch(i._audioType=e,e){case n.WEB_AUDIO:i._AudioClass=t.web.WebAudioSound;break;case n.HTML5_AUDIO:i._AudioClass=t.web.HtmlSound}},i.getIOSVersion=function(){var t=i.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/)[0];return parseInt(t.match(/\d+(_\d)*/)[0])||0},i.checkHtml5Support=function(){var e=(navigator.language||navigator.browserLanguage).toLowerCase(),r=e.split("-");r.length>1&&(r[1]=r[1].toUpperCase()),t.Capabilities.$language=r.join("-")},i._canUseBlob=!1,i._audioType=0,i._System_OS=0,i.ua="",i}(t.HashObject);e.Html5Capatibility=o,__reflect(o.prototype,"egret.web.Html5Capatibility");var s=null;e.getPrefixStyleName=r,e.getPrefix=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r="egret.BitmapData";t.registerClass(HTMLImageElement,r),t.registerClass(HTMLCanvasElement,r),t.registerClass(HTMLVideoElement,r)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){function e(e){return e.hashCode=e.$hashCode=t.$hashCount++,e}t.$toBitmapData=e}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function e(){}return e.detect=function(){var r=t.Capabilities,i=navigator.userAgent.toLowerCase();r.$isMobile=-1!=i.indexOf("mobile")||-1!=i.indexOf("android"),r.$isMobile?i.indexOf("windows")<0&&(-1!=i.indexOf("iphone")||-1!=i.indexOf("ipad")||-1!=i.indexOf("ipod"))?r.$os="iOS":-1!=i.indexOf("android")&&-1!=i.indexOf("linux")?r.$os="Android":-1!=i.indexOf("windows")&&(r.$os="Windows Phone"):-1!=i.indexOf("windows nt")?r.$os="Windows PC":-1!=i.indexOf("mac os")&&(r.$os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase(),a=n.split("-");a.length>1&&(a[1]=a[1].toUpperCase()),r.$language=a.join("-"),e.injectUIntFixOnIE9()},e.injectUIntFixOnIE9=function(){if(/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var t="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n<!-- convertResponseBodyToText -->\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n</script>\r\n";document.write(t)}},e}();e.WebCapability=r,__reflect(r.prototype,"egret.web.WebCapability"),r.detect()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i,n,a,o){var s=e.call(this)||this;if(s.showPanle=!0,s.fpsHeight=0,s.WIDTH=101,s.HEIGHT=20,s.bgCanvasColor="#18304b",s.fpsFrontColor="#18fefe",s.WIDTH_COST=50,s.cost1Color="#18fefe",s.cost3Color="#ff0000",s.arrFps=[],s.arrCost=[],s.arrLog=[],i||n){"canvas"==t.Capabilities.renderMode?s.renderMode="Canvas":s.renderMode="WebGL",s.panelX=void 0===o.x?0:parseInt(o.x),s.panelY=void 0===o.y?0:parseInt(o.y),s.fontColor=void 0===o.textColor?"#ffffff":o.textColor.replace("0x","#"),s.fontSize=void 0===o.size?12:parseInt(o.size),t.Capabilities.isMobile&&(s.fontSize-=2);var h=document.createElement("div");h.style.position="absolute",h.style.background="rgba(0,0,0,"+o.bgAlpha+")",h.style.left=s.panelX+"px",h.style.top=s.panelY+"px",h.style.pointerEvents="none",document.body.appendChild(h);var c=document.createElement("div");c.style.color=s.fontColor,c.style.fontSize=s.fontSize+"px",c.style.lineHeight=s.fontSize+"px",c.style.margin="4px 4px 4px 4px",s.container=c,h.appendChild(c),i&&s.addFps(),n&&s.addLog()}return s}return __extends(r,e),r.prototype.addFps=function(){var t=document.createElement("div");t.style.display="inline-block",this.containerFps=t,this.container.appendChild(t);var e=document.createElement("div");e.style.paddingBottom="2px",this.fps=e,this.containerFps.appendChild(e),e.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var r=document.createElement("canvas");this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,this.canvasFps=r;var i=r.getContext("2d");this.contextFps=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);var a=document.createElement("div");a.style["float"]="left",a.innerHTML="Draw<br/>Cost",n.appendChild(a);var o=document.createElement("div");o.style.paddingLeft=a.offsetWidth+20+"px",n.appendChild(o);var s=document.createElement("div");this.divDraw=s,s.innerHTML="0<br/>",o.appendChild(s);var h=document.createElement("div");this.divCost=h,h.innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',o.appendChild(h),r=document.createElement("canvas"),this.canvasCost=r,this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,i=r.getContext("2d"),this.contextCost=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT),i.fillStyle="#000000",i.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},r.prototype.addLog=function(){var t=document.createElement("div");t.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",t.style.wordWrap="break-word",this.log=t,this.container.appendChild(t)},r.prototype.update=function(t,e){void 0===e&&(e=!1);var r,i,n;e?(r=this.arrFps[this.arrFps.length-1],i=this.arrCost[this.arrCost.length-1][0],n=this.arrCost[this.arrCost.length-1][1]):(r=t.fps,i=t.costTicker,n=t.costRender,this.lastNumDraw=t.draw,this.arrFps.push(r),this.arrCost.push([i,n]));var a=0,o=this.arrFps.length;o>101&&(o=101,this.arrFps.shift(),this.arrCost.shift());for(var s=this.arrFps[0],h=this.arrFps[0],c=0;o>c;c++){var l=this.arrFps[c];a+=l,s>l?s=l:l>h&&(h=l)}var u=this.WIDTH,d=this.HEIGHT,p=this.contextFps;p.drawImage(this.canvasFps,1,0,u-1,d,0,0,u-1,d),p.fillStyle=this.bgCanvasColor,p.fillRect(u-1,0,1,d);var f=Math.floor(r/60*20);1>f&&(f=1),p.fillStyle=this.fpsFrontColor,p.fillRect(u-1,20-f,1,f);var g=this.WIDTH_COST;p=this.contextCost,p.drawImage(this.canvasCost,1,0,g-1,d,0,0,g-1,d),p.drawImage(this.canvasCost,g+2,0,g-1,d,g+1,0,g-1,d);var v=Math.floor(i/2);1>v?v=1:v>20&&(v=20);var y=Math.floor(n/2);1>y?y=1:y>20&&(y=20),p.fillStyle=this.bgCanvasColor,p.fillRect(g-1,0,1,d),p.fillRect(2*g,0,1,d),p.fillRect(3*g+1,0,1,d),p.fillStyle=this.cost1Color,p.fillRect(g-1,20-v,1,v),p.fillStyle=this.cost3Color,p.fillRect(2*g,20-y,1,y);var $=Math.floor(a/o),m=r+" FPS "+this.renderMode;this.showPanle&&(m+="<br/>min"+s+" max"+h+" avg"+$,this.divDraw.innerHTML=this.lastNumDraw+"<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+i+'<font/> <font  style="color:#ff0000">'+n+"<font/>"),this.fps.innerHTML=m},r.prototype.updateInfo=function(t){for(this.arrLog.push(t),this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},r}(t.DisplayObject);e.WebFps=r,__reflect(r.prototype,"egret.web.WebFps",["egret.FPSDisplay","egret.DisplayObject"]),t.FPSDisplay=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){if(window.location){var e=location.search;if(""==e)return"";e=e.slice(1);for(var r=e.split("&"),i=r.length,n=0;i>n;n++){var a=r[n],o=a.split("=");if(o[0]==t)return o[1]}}return""}e.getOption=r,t.getOption=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.WebLifeCycleHandler=function(t){var e=function(){document[r]?t.pause():t.resume()};window.addEventListener("focus",t.resume,!1),window.addEventListener("blur",t.pause,!1);var r,i;"undefined"!=typeof document.hidden?(r="hidden",i="visibilitychange"):"undefined"!=typeof document.mozHidden?(r="mozHidden",i="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(r="msHidden",i="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(r="webkitHidden",i="webkitvisibilitychange"):"undefined"!=typeof document.oHidden&&(r="oHidden",i="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",t.resume,!1),window.addEventListener("pagehide",t.pause,!1)),r&&i&&document.addEventListener(i,e,!1);var n=navigator.userAgent,a=/micromessenger/gi.test(n),o=/mqq/gi.test(n),s=/mobile.*qq/gi.test(n);if((s||a)&&(o=!1),o){var h=window.browser||{};h.execWebFn=h.execWebFn||{},h.execWebFn.postX5GamePlayerMessage=function(e){var r=e.type;"app_enter_background"==r?t.pause():"app_enter_foreground"==r&&t.resume()},window.browser=h}}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(t,e){var i=r.call(this)||this;return i.init(t,e),i.initOrientation(),i}return __extends(i,r),i.prototype.init=function(r,i){var n=this.readOption(r,i),a=new t.Stage;a.$screen=this,a.$scaleMode=n.scaleMode,a.$orientation=n.orientation,a.$maxTouches=n.maxTouches,a.frameRate=n.frameRate,a.textureScaleFactor=n.textureScaleFactor;var o=new t.sys.RenderBuffer(void 0,void 0,!0),s=o.surface;this.attachCanvas(r,s);var h=new e.WebTouchHandler(a,s),c=new t.sys.Player(o,a,n.entryClassName);t.lifecycle.stage=a,t.lifecycle.addLifecycleListener(e.WebLifeCycleHandler);var l=new e.HTMLInput;(n.showFPS||n.showLog)&&(t.nativeRender||c.displayFPS(n.showFPS,n.showLog,n.logFilter,n.fpsStyles)),this.playerOption=n,this.container=r,this.canvas=s,this.stage=a,this.player=c,this.webTouchHandler=h,this.webInput=l,t.web.$cacheTextAdapter(l,a,r,s),this.updateScreenSize(),this.updateMaxTouches(),c.start()},i.prototype.initOrientation=function(){var e=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){t.StageOrientationEvent.dispatchStageOrientationEvent(e.stage,t.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},i.prototype.readOption=function(e,r){var i={};i.entryClassName=e.getAttribute("data-entry-class"),i.scaleMode=e.getAttribute("data-scale-mode")||t.StageScaleMode.NO_SCALE,i.frameRate=+e.getAttribute("data-frame-rate")||30,i.contentWidth=+e.getAttribute("data-content-width")||480,i.contentHeight=+e.getAttribute("data-content-height")||800,i.orientation=e.getAttribute("data-orientation")||t.OrientationMode.AUTO,i.maxTouches=+e.getAttribute("data-multi-fingered")||2,i.textureScaleFactor=+e.getAttribute("texture-scale-factor")||1,i.showFPS="true"==e.getAttribute("data-show-fps");for(var n=e.getAttribute("data-show-fps-style")||"",a=n.split(","),o={},s=0;s<a.length;s++){var h=a[s].split(":");o[h[0]]=h[1]}return i.fpsStyles=o,i.showLog="true"==e.getAttribute("data-show-log"),i.logFilter=e.getAttribute("data-log-filter"),i},i.prototype.attachCanvas=function(t,e){var r=e.style;r.cursor="inherit",r.position="absolute",r.top="0",r.bottom="0",r.left="0",r.right="0",t.appendChild(e),r=t.style,r.overflow="hidden",r.position="absolute"},i.prototype.updateScreenSize=function(){var e=this.canvas;if(!e.userTyping){var r=this.playerOption,i=this.container.getBoundingClientRect(),n=0,a=i.width,o=i.height;i.top<0&&(o+=i.top,n=-i.top);var s=!1,h=this.stage.$orientation;h!=t.OrientationMode.AUTO&&(s=h!=t.OrientationMode.PORTRAIT&&o>a||h==t.OrientationMode.PORTRAIT&&a>o);
var c=s?o:a,l=s?a:o;t.Capabilities.$boundingClientWidth=c,t.Capabilities.$boundingClientHeight=l;var u=t.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,c,l,r.contentWidth,r.contentHeight),d=u.stageWidth,p=u.stageHeight,f=u.displayWidth,g=u.displayHeight;e.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",e.width!=d&&(e.width=d),e.height!=p&&(e.height=p);var v=0;s?h==t.OrientationMode.LANDSCAPE?(v=90,e.style.top=n+(o-f)/2+"px",e.style.left=(a+g)/2+"px"):(v=-90,e.style.top=n+(o+f)/2+"px",e.style.left=(a-g)/2+"px"):(e.style.top=n+(o-g)/2+"px",e.style.left=(a-f)/2+"px");var y=f/d,$=g/p,m=y*t.sys.DisplayList.$canvasScaleFactor,b=$*t.sys.DisplayList.$canvasScaleFactor;"canvas"==t.Capabilities.$renderMode&&(m=Math.ceil(m),b=Math.ceil(b));var x=new t.Matrix;x.scale(y/m,$/b),x.rotate(v*Math.PI/180);var T="matrix("+x.a+","+x.b+","+x.c+","+x.d+","+x.tx+","+x.ty+")";e.style[t.web.getPrefixStyleName("transform")]=T,t.sys.DisplayList.$setCanvasScale(m,b),this.webTouchHandler.updateScaleMode(y,$,v),this.webInput.$updateSize(),this.player.updateStageSize(d,p),t.nativeRender&&(e.width=d*m,e.height=p*b)}},i.prototype.setContentSize=function(t,e){var r=this.playerOption;r.contentWidth=t,r.contentHeight=e,this.updateScreenSize()},i.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},i}(t.HashObject);e.WebPlayer=r,__reflect(r.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(e,r){s||(s=document.createElement("canvas"),h=s.getContext("2d"));var i=e.$getTextureWidth(),n=e.$getTextureHeight();null==r&&(r=t.$TempRectangle,r.x=0,r.y=0,r.width=i,r.height=n),r.x=Math.min(r.x,i-1),r.y=Math.min(r.y,n-1),r.width=Math.min(r.width,i-r.x),r.height=Math.min(r.height,n-r.y);var a=r.width,o=r.height,c=s;if(c.style.width=a+"px",c.style.height=o+"px",s.width=a,s.height=o,"webgl"==t.Capabilities.$renderMode){var l=void 0;e.$renderBuffer?l=e:(l=new t.RenderTexture,l.drawToTexture(new t.Bitmap(e)));for(var u=l.$renderBuffer.getPixels(r.x,r.y,a,o),d=new ImageData(a,o),p=0;p<u.length;p++)d.data[p]=u[p];return h.putImageData(d,0,0),e.$renderBuffer||l.dispose(),c}var f=e,g=Math.round(f.$offsetX),v=Math.round(f.$offsetY),y=f.$bitmapWidth,$=f.$bitmapHeight;return h.drawImage(f.$bitmapData.source,f.$bitmapX+r.x/t.$TextureScaleFactor,f.$bitmapY+r.y/t.$TextureScaleFactor,y*r.width/i,$*r.height/n,g,v,r.width,r.height),c}function i(e,i,n){try{var a=r(this,i),o=a.toDataURL(e,n);return o}catch(s){t.$error(1033)}return null}function n(t,e,r,n){var a=i.call(this,t,r,n);if(null!=a){var o=a.replace(/^data:image[^;]*/,"data:image/octet-stream"),s=document.createElement("a");s.download=e,s.href=o;var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(h)}}function a(e,r){return t.$warn(1041,"getPixel32","getPixels"),this.getPixels(e,r)}function o(e,i,n,a){void 0===n&&(n=1),void 0===a&&(a=1);try{var o=(r(this),h.getImageData(e,i,n,a).data);return o}catch(s){t.$error(1039)}}var s,h;t.Texture.prototype.toDataURL=i,t.Texture.prototype.saveToFile=n,t.Texture.prototype.getPixel32=a,t.Texture.prototype.getPixels=o}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i){var n=e.call(this)||this;return n.onTouchBegin=function(t){var e=n.getLocation(t);n.touch.onTouchBegin(e.x,e.y,t.identifier)},n.onTouchMove=function(t){var e=n.getLocation(t);n.touch.onTouchMove(e.x,e.y,t.identifier)},n.onTouchEnd=function(t){var e=n.getLocation(t);n.touch.onTouchEnd(e.x,e.y,t.identifier)},n.scaleX=1,n.scaleY=1,n.rotation=0,n.canvas=i,n.touch=new t.sys.TouchHandler(r),n.addListeners(),n}return __extends(r,e),r.prototype.addListeners=function(){var e=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(t){t.identifier=t.pointerId,e.onTouchBegin(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerMove",function(t){t.identifier=t.pointerId,e.onTouchMove(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerUp",function(t){t.identifier=t.pointerId,e.onTouchEnd(t),e.prevent(t)},!1)):(t.Capabilities.$isMobile||this.addMouseListener(),this.addTouchListener())},r.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onTouchMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},r.prototype.addTouchListener=function(){var t=this;this.canvas.addEventListener("touchstart",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchBegin(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchmove",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchMove(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchend",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchEnd(e.changedTouches[i]);t.prevent(e)},!1),this.canvas.addEventListener("touchcancel",function(e){for(var r=e.changedTouches.length,i=0;r>i;i++)t.onTouchEnd(e.changedTouches[i]);t.prevent(e)},!1)},r.prototype.prevent=function(t){t.stopPropagation(),1==t.isScroll||this.canvas.userTyping||t.preventDefault()},r.prototype.getLocation=function(e){e.identifier=+e.identifier||0;var r=document.documentElement,i=this.canvas.getBoundingClientRect(),n=i.left+window.pageXOffset-r.clientLeft,a=i.top+window.pageYOffset-r.clientTop,o=e.pageX-n,s=o,h=e.pageY-a,c=h;return 90==this.rotation?(s=h,c=i.width-o):-90==this.rotation&&(s=i.height-h,c=o),s/=this.scaleX,c/=this.scaleY,t.$TempPoint.setTo(Math.round(s),Math.round(c))},r.prototype.updateScaleMode=function(t,e,r){this.scaleX=t,this.scaleY=e,this.rotation=r},r.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},r}(t.HashObject);e.WebTouchHandler=r,__reflect(r.prototype,"egret.web.WebTouchHandler")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){for(var e=s.parseFromString(t,"text/xml"),r=e.childNodes.length,n=0;r>n;n++){var a=e.childNodes[n];if(1==a.nodeType)return i(a,null)}return null}function i(t,e){if("parsererror"==t.localName)throw new Error(t.textContent);for(var r=new a(t.localName,e,t.prefix,t.namespaceURI,t.nodeName),n=t.attributes,s=r.attributes,h=n.length,c=0;h>c;c++){var l=n[c],u=l.name;0!=u.indexOf("xmlns:")&&(s[u]=l.value,r["$"+u]=l.value)}var d=t.childNodes;h=d.length;for(var p=r.children,c=0;h>c;c++){var f=d[c],g=f.nodeType,v=null;if(1==g)v=i(f,r);else if(3==g){var y=f.textContent.trim();y&&(v=new o(y,r))}v&&p.push(v)}return r}var n=function(){function t(t,e){this.nodeType=t,this.parent=e}return t}();e.XMLNode=n,__reflect(n.prototype,"egret.web.XMLNode");var a=function(t){function e(e,r,i,n,a){var o=t.call(this,1,r)||this;return o.attributes={},o.children=[],o.localName=e,o.prefix=i,o.namespace=n,o.name=a,o}return __extends(e,t),e}(n);e.XML=a,__reflect(a.prototype,"egret.web.XML");var o=function(t){function e(e,r){var i=t.call(this,3,r)||this;return i.text=e,i}return __extends(e,t),e}(n);e.XMLText=o,__reflect(o.prototype,"egret.web.XMLText");var s=new DOMParser;t.XML={parse:r}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e){var r=document.createElement("canvas");isNaN(t)||isNaN(e)||(r.width=t,r.height=e);var i=r.getContext("2d");if(void 0===i.imageSmoothingEnabled){for(var n,a=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],o=a.length-1;o>=0&&(n=a[o],void 0===i[n]);o--);try{Object.defineProperty(i,"imageSmoothingEnabled",{get:function(){return this[n]},set:function(t){this[n]=t}})}catch(s){i.imageSmoothingEnabled=i[n]}}return r}var r=function(){function t(t,r,i){this.surface=e(t,r),this.context=this.surface.getContext("2d"),this.context&&(this.context.$offsetX=0,this.context.$offsetY=0)}return Object.defineProperty(t.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e,r){var i=this.surface;if(r){var n=!1;i.width<t&&(i.width=t,n=!0),i.height<e&&(i.height=e,n=!0),n||(this.context.globalCompositeOperation="source-over",this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1)}else i.width!=t&&(i.width=t),i.height!=e&&(i.height=e);this.clear()},t.prototype.getPixels=function(t,e,r,i){return void 0===r&&(r=1),void 0===i&&(i=1),this.context.getImageData(t,e,r,i).data},t.prototype.toDataURL=function(t,e){return this.surface.toDataURL(t,e)},t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},t.prototype.destroy=function(){this.surface.width=this.surface.height=0},t}();t.CanvasRenderBuffer=r,__reflect(r.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e;!function(t){t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.FLOAT=5126]="FLOAT",t[t.BYTE=65535]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT"}(e=t.WEBGL_ATTRIBUTE_TYPE||(t.WEBGL_ATTRIBUTE_TYPE={}));var r=function(){function t(t,e,r){this.gl=t,this.name=r.name,this.type=r.type,this.size=r.size,this.location=t.getAttribLocation(e,this.name),this.count=0,this.initCount(t),this.format=t.FLOAT,this.initFormat(t)}return t.prototype.initCount=function(t){var r=this.type;switch(r){case e.FLOAT:case e.BYTE:case e.UNSIGNED_BYTE:case e.UNSIGNED_SHORT:this.count=1;break;case e.FLOAT_VEC2:this.count=2;break;case e.FLOAT_VEC3:this.count=3;break;case e.FLOAT_VEC4:this.count=4}},t.prototype.initFormat=function(t){var r=this.type;switch(r){case e.FLOAT:case e.FLOAT_VEC2:case e.FLOAT_VEC3:case e.FLOAT_VEC4:this.format=t.FLOAT;break;case e.UNSIGNED_BYTE:this.format=t.UNSIGNED_BYTE;break;case e.UNSIGNED_SHORT:this.format=t.UNSIGNED_SHORT;break;case e.BYTE:this.format=t.BYTE}},t}();t.EgretWebGLAttribute=r,__reflect(r.prototype,"egret.web.EgretWebGLAttribute")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e,r){var i=t.createShader(e);t.shaderSource(i,r),t.compileShader(i);var n=t.getShaderParameter(i,t.COMPILE_STATUS);return n||(console.log("shader not compiled!"),console.log(t.getShaderInfoLog(i))),i}function r(t,e,r){var i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,r),t.linkProgram(i),i}function i(e,r){for(var i={},n=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES),a=0;n>a;a++){var o=e.getActiveAttrib(r,a),s=o.name,h=new t.EgretWebGLAttribute(e,r,o);i[s]=h}return i}function n(e,r){for(var i={},n=e.getProgramParameter(r,e.ACTIVE_UNIFORMS),a=0;n>a;a++){var o=e.getActiveUniform(r,a),s=o.name,h=new t.EgretWebGLUniform(e,r,o);i[s]=h}return i}var a=function(){function t(t,a,o){this.vshaderSource=a,this.fshaderSource=o,this.vertexShader=e(t,t.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=e(t,t.FRAGMENT_SHADER,this.fshaderSource),this.id=r(t,this.vertexShader,this.fragmentShader),this.uniforms=n(t,this.id),this.attributes=i(t,this.id)}return t.getProgram=function(e,r,i,n){return this.programCache[n]||(this.programCache[n]=new t(e,r,i)),this.programCache[n]},t.deleteProgram=function(t,e,r,i){},t.programCache={},t}();t.EgretWebGLProgram=a,__reflect(a.prototype,"egret.web.EgretWebGLProgram")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e;!function(t){t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.BYTE=65535]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT"}(e=t.WEBGL_UNIFORM_TYPE||(t.WEBGL_UNIFORM_TYPE={}));var r=function(){function t(t,e,r){this.gl=t,this.name=r.name,this.type=r.type,this.size=r.size,this.location=t.getUniformLocation(e,this.name),this.setDefaultValue(),this.generateSetValue(),this.generateUpload()}return t.prototype.setDefaultValue=function(){var t=this.type;switch(t){case e.FLOAT:case e.SAMPLER_2D:case e.SAMPLER_CUBE:case e.BOOL:case e.INT:this.value=0;break;case e.FLOAT_VEC2:case e.BOOL_VEC2:case e.INT_VEC2:this.value=[0,0];break;case e.FLOAT_VEC3:case e.BOOL_VEC3:case e.INT_VEC3:this.value=[0,0,0];break;case e.FLOAT_VEC4:case e.BOOL_VEC4:case e.INT_VEC4:this.value=[0,0,0,0];break;case e.FLOAT_MAT2:this.value=new Float32Array([1,0,0,1]);break;case e.FLOAT_MAT3:this.value=new Float32Array([1,0,0,0,1,0,0,0,1]);break;case e.FLOAT_MAT4:this.value=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},t.prototype.generateSetValue=function(){var t=this.type;switch(t){case e.FLOAT:case e.SAMPLER_2D:case e.SAMPLER_CUBE:case e.BOOL:case e.INT:this.setValue=function(t){var e=this.value!==t;this.value=t,e&&this.upload()};break;case e.FLOAT_VEC2:case e.BOOL_VEC2:case e.INT_VEC2:this.setValue=function(t){var e=this.value[0]!==t.x||this.value[1]!==t.y;this.value[0]=t.x,this.value[1]=t.y,e&&this.upload()};break;case e.FLOAT_VEC3:case e.BOOL_VEC3:case e.INT_VEC3:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.upload()};break;case e.FLOAT_VEC4:case e.BOOL_VEC4:case e.INT_VEC4:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.value[3]=t.w,this.upload()};break;case e.FLOAT_MAT2:case e.FLOAT_MAT3:case e.FLOAT_MAT4:this.setValue=function(t){this.value.set(t),this.upload()}}},t.prototype.generateUpload=function(){var t=this.gl,r=this.type,i=this.location;switch(r){case e.FLOAT:this.upload=function(){var e=this.value;t.uniform1f(i,e)};break;case e.FLOAT_VEC2:this.upload=function(){var e=this.value;t.uniform2f(i,e[0],e[1])};break;case e.FLOAT_VEC3:this.upload=function(){var e=this.value;t.uniform3f(i,e[0],e[1],e[2])};break;case e.FLOAT_VEC4:this.upload=function(){var e=this.value;t.uniform4f(i,e[0],e[1],e[2],e[3])};break;case e.SAMPLER_2D:case e.SAMPLER_CUBE:case e.BOOL:case e.INT:this.upload=function(){var e=this.value;t.uniform1i(i,e)};break;case e.BOOL_VEC2:case e.INT_VEC2:this.upload=function(){var e=this.value;t.uniform2i(i,e[0],e[1])};break;case e.BOOL_VEC3:case e.INT_VEC3:this.upload=function(){var e=this.value;t.uniform3i(i,e[0],e[1],e[2])};break;case e.BOOL_VEC4:case e.INT_VEC4:this.upload=function(){var e=this.value;t.uniform4i(i,e[0],e[1],e[2],e[3])};break;case e.FLOAT_MAT2:this.upload=function(){var e=this.value;t.uniformMatrix2fv(i,!1,e)};break;case e.FLOAT_MAT3:this.upload=function(){var e=this.value;t.uniformMatrix3fv(i,!1,e)};break;case e.FLOAT_MAT4:this.upload=function(){var e=this.value;t.uniformMatrix4fv(i,!1,e)}}},t}();t.EgretWebGLUniform=r,__reflect(r.prototype,"egret.web.EgretWebGLUniform")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.drawData=[],this.drawDataLen=0}return t.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var t=this.drawData[this.drawDataLen]||{};t.type=1,t.count=0,this.drawData[this.drawDataLen]=t,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},t.prototype.pushDrawTexture=function(t,e,r,i,n){if(void 0===e&&(e=2),r){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=t,a.filter=r,a.count=e,a.textureWidth=i,a.textureHeight=n,this.drawData[this.drawDataLen]=a,this.drawDataLen++}else{if(0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||t!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=t,a.count=0,this.drawData[this.drawDataLen]=a,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=e}},t.prototype.pushChangeSmoothing=function(t,e){t.smoothing=e;var r=this.drawData[this.drawDataLen]||{};r.type=10,r.texture=t,r.smoothing=e,this.drawData[this.drawDataLen]=r,this.drawDataLen++},t.prototype.pushPushMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=2,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushPopMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=3,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushSetBlend=function(t){for(var e=this.drawDataLen,r=!1,i=e-1;i>=0;i--){var n=this.drawData[i];if(n){if((0==n.type||1==n.type)&&(r=!0),!r&&4==n.type){this.drawData.splice(i,1),this.drawDataLen--;continue}if(4==n.type){if(n.value==t)return;break}}}var a=this.drawData[this.drawDataLen]||{};a.type=4,a.value=t,this.drawData[this.drawDataLen]=a,this.drawDataLen++},t.prototype.pushResize=function(t,e,r){var i=this.drawData[this.drawDataLen]||{};i.type=5,i.buffer=t,i.width=e,i.height=r,this.drawData[this.drawDataLen]=i,this.drawDataLen++},t.prototype.pushClearColor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=6,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.pushActivateBuffer=function(t){for(var e=this.drawDataLen,r=!1,i=e-1;i>=0;i--){var n=this.drawData[i];!n||(4!=n.type&&7!=n.type&&(r=!0),r||7!=n.type)||(this.drawData.splice(i,1),this.drawDataLen--)}var a=this.drawData[this.drawDataLen]||{};a.type=7,a.buffer=t,a.width=t.rootRenderTarget.width,a.height=t.rootRenderTarget.height,this.drawData[this.drawDataLen]=a,this.drawDataLen++},t.prototype.pushEnableScissor=function(t,e,r,i){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=t,n.y=e,n.width=r,n.height=i,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushDisableScissor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=9,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.clear=function(){for(var t=0;t<this.drawDataLen;t++){var e=this.drawData[t];e.type=0,e.count=0,e.texture=null,e.filter=null,e.uv=null,e.value="",e.buffer=null,e.width=0,e.height=0}this.drawDataLen=0},t}();t.WebGLDrawCmdManager=e,__reflect(e.prototype,"egret.web.WebGLDrawCmdManager")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function n(i,n,a){var o=r.call(this)||this;if(o.globalAlpha=1,o.stencilState=!1,o.$stencilList=[],o.stencilHandleCount=0,o.$scissorState=!1,o.scissorRect=new t.Rectangle,o.$hasScissor=!1,o.$drawCalls=0,o.$computeDrawCall=!1,o.globalMatrix=new t.Matrix,o.savedGlobalMatrix=new t.Matrix,o.$offsetX=0,o.$offsetY=0,o.context=e.WebGLRenderContext.getInstance(i,n),t.nativeRender)return o.$width=i,o.$height=n,o.surface=o.context.surface,o.rootRenderTarget=null,a?o.bufferIdForWasm=0:o.bufferIdForWasm=t.NativeNode.setValuesToRenderBuffer(o),o;if(o.rootRenderTarget=new e.WebGLRenderTarget(o.context.context,3,3),i&&n&&o.resize(i,n),o.root=a,o.root)o.context.pushBuffer(o),o.surface=o.context.surface,o.$computeDrawCall=!0;else{var s=o.context.activatedBuffer;s&&s.rootRenderTarget.activate(),o.rootRenderTarget.initFrameBuffer(),o.surface=o.rootRenderTarget}return o}return __extends(n,r),n.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},n.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},n.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},n.prototype.enableScissor=function(t,e,r,i){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(t,e,r,i),this.context.enableScissorTest(this.scissorRect))},n.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},n.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(n.prototype,"width",{get:function(){return t.nativeRender?this.$width:this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return t.nativeRender?this.$height:this.rootRenderTarget.height},enumerable:!0,configurable:!0}),n.prototype.resize=function(e,r,i){return e=e||1,r=r||1,t.nativeRender?(this.$width=e,void(this.$height=r)):(this.context.pushBuffer(this),(e!=this.rootRenderTarget.width||r!=this.rootRenderTarget.height)&&(this.context.drawCmdManager.pushResize(this,e,r),this.rootRenderTarget.width=e,this.rootRenderTarget.height=r),this.root&&this.context.resize(e,r,i),this.context.clear(),void this.context.popBuffer())},n.prototype.getPixels=function(t,e,r,i){void 0===r&&(r=1),void 0===i&&(i=1);var n=new Uint8Array(4*r*i),a=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(t,e,r,i,n),this.rootRenderTarget.useFrameBuffer=a,this.rootRenderTarget.activate();for(var o=new Uint8Array(4*r*i),s=0;i>s;s++)for(var h=0;r>h;h++)o[4*(r*(i-s-1)+h)]=n[4*(r*s+h)],o[4*(r*(i-s-1)+h)+1]=n[4*(r*s+h)+1],o[4*(r*(i-s-1)+h)+2]=n[4*(r*s+h)+2],o[4*(r*(i-s-1)+h)+3]=n[4*(r*s+h)+3];return o},n.prototype.toDataURL=function(t,e){return this.context.surface.toDataURL(t,e)},n.prototype.destroy=function(){this.context.destroy()},n.prototype.onRenderFinish=function(){this.$drawCalls=0},n.prototype.drawFrameBufferToSurface=function(t,e,r,i,n,a,o,s,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,t,e,r,i,n,a,o,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.drawSurfaceToFrameBuffer=function(t,e,r,i,n,a,o,s,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.context.surface,t,e,r,i,n,a,o,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.clear=function(){this.context.pushBuffer(this),this.context.clear(),this.context.popBuffer()},n.prototype.setTransform=function(t,e,r,i,n,a){var o=this.globalMatrix;o.a=t,o.b=e,o.c=r,o.d=i,o.tx=n,o.ty=a},n.prototype.transform=function(t,e,r,i,n,a){var o=this.globalMatrix,s=o.a,h=o.b,c=o.c,l=o.d;(1!=t||0!=e||0!=r||1!=i)&&(o.a=t*s+e*c,o.b=t*h+e*l,o.c=r*s+i*c,o.d=r*h+i*l),o.tx=n*s+a*c+o.tx,o.ty=n*h+a*l+o.ty},n.prototype.translate=function(t,e){var r=this.globalMatrix;r.tx+=t,r.ty+=e},n.prototype.useOffset=function(){var t=this;(0!=t.$offsetX||0!=t.$offsetY)&&(t.globalMatrix.append(1,0,0,1,t.$offsetX,t.$offsetY),t.$offsetX=t.$offsetY=0)},n.prototype.saveTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},n.prototype.restoreTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},n.create=function(t,e){var r=i.pop();if(r){r.resize(t,e);var a=r.globalMatrix;a.a=1,a.b=0,a.c=0,a.d=1,a.tx=0,a.ty=0,r.globalAlpha=1,r.$offsetX=0,r.$offsetY=0}else r=new n(t,e),r.$computeDrawCall=!1;return r},n.release=function(t){i.push(t)},n.autoClear=!0,n}(t.HashObject);e.WebGLRenderBuffer=r,__reflect(r.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var i=[]}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t,e){var r=document.createElement("canvas");return isNaN(t)||isNaN(e)||(r.width=t,r.height=e),r}var i=function(){function i(i,n){if(this.glID=null,this.projectionX=0/0,this.projectionY=0/0,this.contextLost=!1,this.$scissorState=!1,this.vertSize=5,this.surface=r(i,n),!t.nativeRender){this.initWebGL(),this.$bufferStack=[];var a=this.context;this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new e.WebGLDrawCmdManager,this.vao=new e.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}}return i.getInstance=function(t,e){return this.instance?this.instance:(this.instance=new i(t,e),this.instance)},i.prototype.pushBuffer=function(t){this.$bufferStack.push(t),t!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(t)),this.currentBuffer=t},i.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var t=this.$bufferStack.pop(),e=this.$bufferStack[this.$bufferStack.length-1];t!=e&&this.drawCmdManager.pushActivateBuffer(e),this.currentBuffer=e}},i.prototype.activateBuffer=function(t){t.rootRenderTarget.activate(),this.bindIndices||this.uploadIndicesArray(this.vao.getIndices()),t.restoreStencil(),t.restoreScissor(),this.onResize(t.width,t.height)},i.prototype.uploadVerticesArray=function(t){var e=this.context;e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW)},i.prototype.uploadIndicesArray=function(t){var e=this.context;e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this.bindIndices=!0},i.prototype.destroy=function(){this.surface.width=this.surface.height=0},i.prototype.onResize=function(t,e){t=t||this.surface.width,e=e||this.surface.height,this.projectionX=t/2,this.projectionY=-e/2,this.context&&this.context.viewport(0,0,t,e)},i.prototype.resize=function(t,e,r){var i=this.surface;r?(i.width<t&&(i.width=t),i.height<e&&(i.height=e)):(i.width!=t&&(i.width=t),i.height!=e&&(i.height=e)),this.onResize()},i.prototype.initWebGL=function(){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),this.getWebGLContext();var t=this.context;this.$maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)},i.prototype.handleContextLost=function(){this.contextLost=!0},i.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},i.prototype.getWebGLContext=function(){for(var e,r={antialias:i.antialias,stencil:!0},n=["webgl","experimental-webgl"],a=0;a<n.length;a++){try{e=this.surface.getContext(n[a],r)}catch(o){}if(e)break}e||t.$error(1021),this.setContext(e)},i.prototype.setContext=function(t){this.context=t,t.id=i.glContextId++,this.glID=t.id,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,!0),t.activeTexture(t.TEXTURE0)},i.prototype.enableStencilTest=function(){var t=this.context;t.enable(t.STENCIL_TEST)},i.prototype.disableStencilTest=function(){var t=this.context;t.disable(t.STENCIL_TEST)},i.prototype.enableScissorTest=function(t){var e=this.context;e.enable(e.SCISSOR_TEST),e.scissor(t.x,t.y,t.width,t.height)},i.prototype.disableScissorTest=function(){var t=this.context;t.disable(t.SCISSOR_TEST)},i.prototype.getPixels=function(t,e,r,i,n){var a=this.context;a.readPixels(t,e,r,i,a.RGBA,a.UNSIGNED_BYTE,n)},i.prototype.createTexture=function(t){var e=this.context,r=e.createTexture();return r?(r.glContext=e,e.bindTexture(e.TEXTURE_2D,r),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r):void(this.contextLost=!0)},i.prototype.createTextureFromCompressedData=function(t,e,r,i,n){return null},i.prototype.updateTexture=function(t,e){var r=this.context;r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)},i.prototype.getWebGLTexture=function(t){return t.webGLTexture||("image"==t.format?t.webGLTexture=this.createTexture(t.source):"pvr"==t.format&&(t.webGLTexture=this.createTextureFromCompressedData(t.source.pvrtcData,t.width,t.height,t.source.mipmapsCount,t.source.format)),t.$deleteSource&&t.webGLTexture&&(t.source=null),t.webGLTexture.smoothing=!0),t.webGLTexture},i.prototype.clearRect=function(t,e,r,i){if(0!=t||0!=e||r!=this.surface.width||i!=this.surface.height){var n=this.currentBuffer;if(n.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,r,i),this.setGlobalCompositeOperation("source-over");else{var a=n.globalMatrix;0==a.b&&0==a.c?(t=t*a.a+a.tx,e=e*a.d+a.ty,r*=a.a,i*=a.d,this.enableScissor(t,-e-i+n.height,r,i),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,r,i),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},i.prototype.setGlobalCompositeOperation=function(t){this.drawCmdManager.pushSetBlend(t)},i.prototype.drawImage=function(t,e,r,i,n,a,o,s,h,c,l,u,d){var p=this.currentBuffer;if(!this.contextLost&&t&&p){var f,g,v;if(t.texture||t.source&&t.source.texture)f=t.texture||t.source.texture,p.saveTransform(),g=p.$offsetX,v=p.$offsetY,p.useOffset(),p.transform(1,0,0,-1,0,h+2*o);else{if(!t.source&&!t.webGLTexture)return;f=this.getWebGLTexture(t)}f&&(this.drawTexture(f,e,r,i,n,a,o,s,h,c,l,void 0,void 0,void 0,void 0,u,d),t.source&&t.source.texture&&(p.$offsetX=g,p.$offsetY=v,p.restoreTransform()))}},i.prototype.drawMesh=function(t,e,r,i,n,a,o,s,h,c,l,u,d,p,f,g,v){var y=this.currentBuffer;if(!this.contextLost&&t&&y){var $,m,b;if(t.texture||t.source&&t.source.texture)$=t.texture||t.source.texture,y.saveTransform(),m=y.$offsetX,b=y.$offsetY,y.useOffset(),y.transform(1,0,0,-1,0,h+2*o);else{if(!t.source&&!t.webGLTexture)return;$=this.getWebGLTexture(t)}$&&(this.drawTexture($,e,r,i,n,a,o,s,h,c,l,u,d,p,f,g,v),(t.texture||t.source&&t.source.texture)&&(y.$offsetX=m,y.$offsetY=b,y.restoreTransform()))}},i.prototype.drawTexture=function(t,e,r,i,n,a,o,s,h,c,l,u,d,p,f,g,v){var y=this.currentBuffer;if(!this.contextLost&&t&&y){d&&p?this.vao.reachMaxSize(d.length/2,p.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),void 0!=v&&t.smoothing!=v&&this.drawCmdManager.pushChangeSmoothing(t,v),u&&this.vao.changeToMeshIndices();var $=p?p.length/3:2;this.drawCmdManager.pushDrawTexture(t,$,this.$filter),this.vao.cacheArrays(y,e,r,i,n,a,o,s,h,c,l,u,d,p,g)}},i.prototype.drawRect=function(t,e,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),this.vao.cacheArrays(n,0,0,r,i,t,e,r,i,r,i))},i.prototype.pushMask=function(t,e,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(n.$stencilList.push({x:t,y:e,width:r,height:i}),this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPushMask(),this.vao.cacheArrays(n,0,0,r,i,t,e,r,i,r,i))},i.prototype.popMask=function(){var t=this.currentBuffer;if(!this.contextLost&&t){var e=t.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPopMask(),this.vao.cacheArrays(t,0,0,e.width,e.height,e.x,e.y,e.width,e.height,e.width,e.height)}},i.prototype.clear=function(){this.drawCmdManager.pushClearColor()},i.prototype.enableScissor=function(t,e,r,i){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(t,e,r,i),n.$hasScissor=!0},i.prototype.disableScissor=function(){var t=this.currentBuffer;
this.drawCmdManager.pushDisableScissor(),t.$hasScissor=!1},i.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var t=this.drawCmdManager.drawDataLen,e=0,r=0;t>r;r++){var i=this.drawCmdManager.drawData[r];e=this.drawData(i,e),7==i.type&&(this.activatedBuffer=i.buffer),(0==i.type||1==i.type||2==i.type||3==i.type)&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},i.prototype.drawData=function(t,r){if(t){var i,n=this.context,a=t.filter;switch(t.type){case 0:a?"custom"===a.type?i=e.EgretWebGLProgram.getProgram(n,a.$vertexSrc,a.$fragmentSrc,a.$shaderKey):"colorTransform"===a.type?i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.colorTransform_frag,"colorTransform"):"blurX"===a.type?i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"blurY"===a.type?i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"glow"===a.type&&(i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.glow_frag,"glow")):i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.texture_frag,"texture"),this.activeProgram(n,i),this.syncUniforms(i,a,t.textureWidth,t.textureHeight),r+=this.drawTextureElements(t,r);break;case 1:i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,t.textureWidth,t.textureHeight),r+=this.drawRectElements(t,r);break;case 2:i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,t.textureWidth,t.textureHeight),r+=this.drawPushMaskElements(t,r);break;case 3:i=e.EgretWebGLProgram.getProgram(n,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(n,i),this.syncUniforms(i,a,t.textureWidth,t.textureHeight),r+=this.drawPopMaskElements(t,r);break;case 4:this.setBlendMode(t.value);break;case 5:t.buffer.rootRenderTarget.resize(t.width,t.height),this.onResize(t.width,t.height);break;case 6:if(this.activatedBuffer){var o=this.activatedBuffer.rootRenderTarget;(0!=o.width||0!=o.height)&&o.clear(!0)}break;case 7:this.activateBuffer(t.buffer);break;case 8:var s=this.activatedBuffer;s&&(s.rootRenderTarget&&s.rootRenderTarget.enabledStencil(),s.enableScissor(t.x,t.y,t.width,t.height));break;case 9:s=this.activatedBuffer,s&&s.disableScissor();break;case 10:n.bindTexture(n.TEXTURE_2D,t.texture),t.smoothing?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST))}return r}},i.prototype.activeProgram=function(t,e){if(e!=this.currentProgram){t.useProgram(e.id);var r=e.attributes;for(var i in r)"aVertexPosition"===i?(t.vertexAttribPointer(r.aVertexPosition.location,2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(r.aVertexPosition.location)):"aTextureCoord"===i?(t.vertexAttribPointer(r.aTextureCoord.location,2,t.FLOAT,!1,20,8),t.enableVertexAttribArray(r.aTextureCoord.location)):"aColor"===i&&(t.vertexAttribPointer(r.aColor.location,1,t.FLOAT,!1,20,16),t.enableVertexAttribArray(r.aColor.location));this.currentProgram=e}},i.prototype.syncUniforms=function(t,e,r,i){var n=t.uniforms;e&&"custom"===e.type;for(var a in n)if("projectionVector"===a)n[a].setValue({x:this.projectionX,y:this.projectionY});else if("uTextureSize"===a)n[a].setValue({x:r,y:i});else if("uSampler"===a);else{var o=e.$uniforms[a];void 0!==o&&n[a].setValue(o)}},i.prototype.drawTextureElements=function(t,e){var r=this.context;r.bindTexture(r.TEXTURE_2D,t.texture);var i=3*t.count;return r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),i},i.prototype.drawRectElements=function(t,e){var r=this.context,i=3*t.count;return r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),i},i.prototype.drawPushMaskElements=function(t,e){var r=this.context,i=3*t.count,n=this.activatedBuffer;if(n){n.rootRenderTarget&&n.rootRenderTarget.enabledStencil(),0==n.stencilHandleCount&&(n.enableStencil(),r.clear(r.STENCIL_BUFFER_BIT));var a=n.stencilHandleCount;n.stencilHandleCount++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,a,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),r.stencilFunc(r.EQUAL,a+1,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.drawPopMaskElements=function(t,e){var r=this.context,i=3*t.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var a=n.stencilHandleCount;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,a+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*e),r.stencilFunc(r.EQUAL,a,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.setBlendMode=function(t){var e=this.context,r=i.blendModesForGL[t];r&&e.blendFunc(r[0],r[1])},i.prototype.drawTargetWidthFilters=function(t,r){var i,n=r,a=t.length;if(a>1)for(var o=0;a-1>o;o++){var s=t[o],h=r.rootRenderTarget.width,c=r.rootRenderTarget.height;i=e.WebGLRenderBuffer.create(h,c),i.setTransform(1,0,0,1,0,0),i.globalAlpha=1,this.drawToRenderTarget(s,r,i),r!=n&&e.WebGLRenderBuffer.release(r),r=i}var l=t[a-1];this.drawToRenderTarget(l,r,this.currentBuffer),r!=n&&e.WebGLRenderBuffer.release(r)},i.prototype.drawToRenderTarget=function(t,r,i){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(i);var n,a=r,o=r.rootRenderTarget.width,s=r.rootRenderTarget.height;if("blur"==t.type){var h=t.blurXFilter,c=t.blurYFilter;0!=h.blurX&&0!=c.blurY?(n=e.WebGLRenderBuffer.create(o,s),n.setTransform(1,0,0,1,0,0),n.globalAlpha=1,this.drawToRenderTarget(t.blurXFilter,r,n),r!=a&&e.WebGLRenderBuffer.release(r),r=n,t=c):t=0===h.blurX?c:h}i.saveTransform(),i.transform(1,0,0,-1,0,s),this.vao.cacheArrays(i,0,0,o,s,0,0,o,s,o,s),i.restoreTransform(),this.drawCmdManager.pushDrawTexture(r.rootRenderTarget.texture,2,t,o,s),r!=a&&e.WebGLRenderBuffer.release(r),this.popBuffer()}},i.initBlendMode=function(){i.blendModesForGL={},i.blendModesForGL["source-over"]=[1,771],i.blendModesForGL.lighter=[1,1],i.blendModesForGL["lighter-in"]=[770,771],i.blendModesForGL["destination-out"]=[0,771],i.blendModesForGL["destination-in"]=[0,770]},i.glContextId=0,i.blendModesForGL=null,i}();e.WebGLRenderContext=i,__reflect(i.prototype,"egret.web.WebGLRenderContext"),i.initBlendMode()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(t,r,i){var n=e.call(this)||this;return n.clearColor=[0,0,0,0],n.useFrameBuffer=!0,n.gl=t,n.width=r||1,n.height=i||1,n}return __extends(r,e),r.prototype.resize=function(t,e){var r=this.gl;this.width=t,this.height=e,this.frameBuffer&&(r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,r.UNSIGNED_BYTE,null)),this.stencilBuffer&&(r.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=null)},r.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer())},r.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},r.prototype.initFrameBuffer=function(){if(!this.frameBuffer){var t=this.gl;this.texture=this.createTexture(),this.frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0)}},r.prototype.createTexture=function(){var t=this.gl,e=t.createTexture();return e.glContext=t,t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e},r.prototype.clear=function(t){var e=this.gl;t&&this.activate(),e.colorMask(!0,!0,!0,!0),e.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),e.clear(e.COLOR_BUFFER_BIT)},r.prototype.enabledStencil=function(){if(this.frameBuffer&&!this.stencilBuffer){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer)}},r.prototype.dispose=function(){t.WebGLUtils.deleteWebGLTexture(this.texture)},r}(t.HashObject);e.WebGLRenderTarget=r,__reflect(r.prototype,"egret.web.WebGLRenderTarget")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=["source-over","lighter","destination-out"],i="source-over",n=[],a=function(){function a(){this.nestLevel=0}return a.prototype.render=function(e,r,i,a){this.nestLevel++;var o=r,s=o.context;s.pushBuffer(o),o.transform(i.a,i.b,i.c,i.d,0,0),this.drawDisplayObject(e,o,i.tx,i.ty,!0),s.$drawWebGL();var h=o.$drawCalls;o.onRenderFinish(),s.popBuffer();var c=t.Matrix.create();if(i.$invertInto(c),o.transform(c.a,c.b,c.c,c.d,0,0),t.Matrix.release(c),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var l=n.length,u=0;l>u;u++)n[u].resize(0,0)}return h},a.prototype.drawDisplayObject=function(e,r,i,n,a){var o,s=0,h=e.$displayList;if(h&&!a?((e.$cacheDirty||e.$renderDirty||h.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||h.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=h.drawToSurface()),o=h.$renderNode):o=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,o){switch(s++,r.$offsetX=i,r.$offsetY=n,o.type){case 1:this.renderBitmap(o,r);break;case 2:this.renderText(o,r);break;case 3:this.renderGraphics(o,r);break;case 4:this.renderGroup(o,r);break;case 5:this.renderMesh(o,r);break;case 6:this.renderNormalBitmap(o,r)}r.$offsetX=0,r.$offsetY=0}if(h&&!a)return s;var c=e.$children;if(c)for(var l=c.length,u=0;l>u;u++){var d=c[u],p=void 0,f=void 0,g=void 0;1!=d.$alpha&&(g=r.globalAlpha,r.globalAlpha*=d.$alpha);var v=void 0;if(d.$useTranslate){var y=d.$getMatrix();p=i+d.$x,f=n+d.$y;var $=r.globalMatrix;v=t.Matrix.create(),v.a=$.a,v.b=$.b,v.c=$.c,v.d=$.d,v.tx=$.tx,v.ty=$.ty,r.transform(y.a,y.b,y.c,y.d,p,f),p=-d.$anchorOffsetX,f=-d.$anchorOffsetY}else p=i+d.$x-d.$anchorOffsetX,f=n+d.$y-d.$anchorOffsetY;switch(d.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(d,r,p,f);break;case 3:s+=this.drawWithClip(d,r,p,f);break;case 4:s+=this.drawWithScrollRect(d,r,p,f);break;default:s+=this.drawDisplayObject(d,r,p,f)}if(g&&(r.globalAlpha=g),v){var y=r.globalMatrix;y.a=v.a,y.b=v.b,y.c=v.c,y.d=v.d,y.tx=v.tx,y.ty=v.ty,t.Matrix.release(v)}}return s},a.prototype.drawWithFilter=function(t,e,a,o){var s=0;if(!t.$children||0!=t.$children.length||t.$renderNode&&0!=t.$renderNode.$getRenderCount()){var h,c=t.$filters,l=0!==t.$blendMode;l&&(h=r[t.$blendMode],h||(h=i));var u=t.$getOriginalBounds();if(u.width<=0||u.height<=0)return s;if(!t.mask&&1==c.length&&("colorTransform"==c[0].type||"custom"===c[0].type&&0===c[0].padding)){var d=this.getRenderCount(t);if(!t.$children||1==d)return l&&e.context.setGlobalCompositeOperation(h),e.context.$filter=c[0],s+=t.$mask?this.drawWithClip(t,e,a,o):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,e,a,o):this.drawDisplayObject(t,e,a,o),e.context.$filter=null,l&&e.context.setGlobalCompositeOperation(i),s}var p=this.createRenderBuffer(u.width,u.height);return p.context.pushBuffer(p),s+=t.$mask?this.drawWithClip(t,p,-u.x,-u.y):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,p,-u.x,-u.y):this.drawDisplayObject(t,p,-u.x,-u.y),p.context.popBuffer(),s>0&&(l&&e.context.setGlobalCompositeOperation(h),s++,e.$offsetX=a+u.x,e.$offsetY=o+u.y,e.context.drawTargetWidthFilters(c,p),l&&e.context.setGlobalCompositeOperation(i)),n.push(p),s}},a.prototype.getRenderCount=function(t){var e=0;if(t.$children)for(var r=0,i=t.$children;r<i.length;r++){var n=i[r],a=n.$getRenderNode();a&&(e+=a.$getRenderCount()),n.$children&&(e+=this.getRenderCount(n))}return e},a.prototype.drawWithClip=function(e,a,o,s){var h,c=0,l=0!==e.$blendMode;l&&(h=r[e.$blendMode],h||(h=i));var u=e.$scrollRect?e.$scrollRect:e.$maskRect,d=e.$mask;if(d){var p=d.$getMatrix();if(0==p.a&&0==p.b||0==p.c&&0==p.d)return c}if(d||e.$children&&0!=e.$children.length){var f=e.$getOriginalBounds(),g=this.createRenderBuffer(f.width,f.height);if(g.context.pushBuffer(g),c+=this.drawDisplayObject(e,g,-f.x,-f.y),d){var v=this.createRenderBuffer(f.width,f.height);v.context.pushBuffer(v);var y=t.Matrix.create();y.copyFrom(d.$getConcatenatedMatrix()),d.$getConcatenatedMatrixAt(e,y),v.setTransform(y.a,y.b,y.c,y.d,y.tx,y.ty),t.Matrix.release(y),c+=this.drawDisplayObject(d,v,-f.x,-f.y),v.context.popBuffer(),g.context.setGlobalCompositeOperation("destination-in"),g.setTransform(1,0,0,-1,0,v.height),g.globalAlpha=1;var $=v.rootRenderTarget.width,m=v.rootRenderTarget.height;g.context.drawTexture(v.rootRenderTarget.texture,0,0,$,m,0,0,$,m,$,m),g.setTransform(1,0,0,1,0,0),g.context.setGlobalCompositeOperation("source-over"),n.push(v)}if(g.context.setGlobalCompositeOperation(i),g.context.popBuffer(),c>0){c++,l&&a.context.setGlobalCompositeOperation(h),u&&a.context.pushMask(u.x+o,u.y+s,u.width,u.height),a.globalAlpha=1;var b=t.Matrix.create(),x=a.globalMatrix;b.a=x.a,b.b=x.b,b.c=x.c,b.d=x.d,b.tx=x.tx,b.ty=x.ty,x.append(1,0,0,-1,o+f.x,s+f.y+g.height);var T=g.rootRenderTarget.width,w=g.rootRenderTarget.height;a.context.drawTexture(g.rootRenderTarget.texture,0,0,T,w,0,0,T,w,T,w),u&&g.context.popMask(),l&&a.context.setGlobalCompositeOperation(i);var _=a.globalMatrix;_.a=b.a,_.b=b.b,_.c=b.c,_.d=b.d,_.tx=b.tx,_.ty=b.ty,t.Matrix.release(b)}return n.push(g),c}return u&&a.context.pushMask(u.x+o,u.y+s,u.width,u.height),l&&a.context.setGlobalCompositeOperation(h),c+=this.drawDisplayObject(e,a,o,s),l&&a.context.setGlobalCompositeOperation(i),u&&a.context.popMask(),c},a.prototype.drawWithScrollRect=function(t,e,r,i){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;if(a.isEmpty())return n;t.$scrollRect&&(r-=a.x,i-=a.y);var o=e.globalMatrix,s=e.context,h=!1;if(e.$hasScissor||0!=o.b||0!=o.c)e.context.pushMask(a.x+r,a.y+i,a.width,a.height);else{var c=o.a,l=o.d,u=o.tx,d=o.ty,p=a.x+r,f=a.y+i,g=p+a.width,v=f+a.height,y=void 0,$=void 0,m=void 0,b=void 0;if(1==c&&1==l)y=p+u,$=f+d,m=g+u,b=v+d;else{var x=c*p+u,T=l*f+d,w=c*g+u,_=l*f+d,E=c*g+u,S=l*v+d,C=c*p+u,D=l*v+d,R=0;x>w&&(R=x,x=w,w=R),E>C&&(R=E,E=C,C=R),y=E>x?x:E,m=w>C?w:C,T>_&&(R=T,T=_,_=R),S>D&&(R=S,S=D,D=R),$=S>T?T:S,b=_>D?_:D}s.enableScissor(y,-b+e.height,m-y,b-$),h=!0}return n+=this.drawDisplayObject(t,e,r,i),h?s.disableScissor():s.popMask(),n},a.prototype.drawNodeToBuffer=function(t,e,r,i){var n=e;n.context.pushBuffer(n),n.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(t,e,0,0,i),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},a.prototype.drawDisplayToBuffer=function(t,e,r){e.context.pushBuffer(e),r&&e.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty);var i;i=t.$renderDirty?t.$getRenderNode():t.$renderNode;var n=0;if(i)switch(n++,i.type){case 1:this.renderBitmap(i,e);break;case 2:this.renderText(i,e);break;case 3:this.renderGraphics(i,e);break;case 4:this.renderGroup(i,e);break;case 5:this.renderMesh(i,e);break;case 6:this.renderNormalBitmap(i,e)}var a=t.$children;if(a)for(var o=a.length,s=0;o>s;s++){var h=a[s];switch(h.$renderMode){case 1:break;case 2:n+=this.drawWithFilter(h,e,0,0);break;case 3:n+=this.drawWithClip(h,e,0,0);break;case 4:n+=this.drawWithScrollRect(h,e,0,0);break;default:n+=this.drawDisplayObject(h,e,0,0)}}return e.context.$drawWebGL(),e.onRenderFinish(),e.context.popBuffer(),n},a.prototype.renderNode=function(t,e,r,i,n){switch(e.$offsetX=r,e.$offsetY=i,t.type){case 1:this.renderBitmap(t,e);break;case 2:this.renderText(t,e);break;case 3:this.renderGraphics(t,e,n);break;case 4:this.renderGroup(t,e);break;case 5:this.renderMesh(t,e);break;case 6:this.renderNormalBitmap(t,e)}},a.prototype.renderNormalBitmap=function(t,e){var r=t.image;r&&e.context.drawImage(r,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX,t.drawY,t.drawW,t.drawH,t.imageWidth,t.imageHeight,t.rotated,t.smoothing)},a.prototype.renderBitmap=function(e,n){var a=e.image;if(a){var o,s,h,c=e.drawData,l=c.length,u=0,d=e.matrix,p=e.blendMode,f=e.alpha;if(d){o=t.Matrix.create();var g=n.globalMatrix;o.a=g.a,o.b=g.b,o.c=g.c,o.d=g.d,o.tx=g.tx,o.ty=g.ty,s=n.$offsetX,h=n.$offsetY,n.useOffset(),n.transform(d.a,d.b,d.c,d.d,d.tx,d.ty)}p&&n.context.setGlobalCompositeOperation(r[p]);var v;if(f==f&&(v=n.globalAlpha,n.globalAlpha*=f),e.filter){for(n.context.$filter=e.filter;l>u;)n.context.drawImage(a,c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);n.context.$filter=null}else for(;l>u;)n.context.drawImage(a,c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);if(p&&n.context.setGlobalCompositeOperation(i),f==f&&(n.globalAlpha=v),d){var y=n.globalMatrix;y.a=o.a,y.b=o.b,y.c=o.c,y.d=o.d,y.tx=o.tx,y.ty=o.ty,n.$offsetX=s,n.$offsetY=h,t.Matrix.release(o)}}},a.prototype.renderMesh=function(e,n){var a,o,s,h=e.image,c=e.drawData,l=c.length,u=0,d=e.matrix,p=e.blendMode,f=e.alpha;if(d){a=t.Matrix.create();var g=n.globalMatrix;a.a=g.a,a.b=g.b,a.c=g.c,a.d=g.d,a.tx=g.tx,a.ty=g.ty,o=n.$offsetX,s=n.$offsetY,n.useOffset(),n.transform(d.a,d.b,d.c,d.d,d.tx,d.ty)}p&&n.context.setGlobalCompositeOperation(r[p]);var v;if(f==f&&(v=n.globalAlpha,n.globalAlpha*=f),e.filter){for(n.context.$filter=e.filter;l>u;)n.context.drawMesh(h,c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);n.context.$filter=null}else for(;l>u;)n.context.drawMesh(h,c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);if(p&&n.context.setGlobalCompositeOperation(i),f==f&&(n.globalAlpha=v),d){var y=n.globalMatrix;y.a=a.a,y.b=a.b,y.c=a.c,y.d=a.d,y.tx=a.tx,y.ty=a.ty,n.$offsetX=o,n.$offsetY=s,t.Matrix.release(a)}},a.prototype.renderText=function(r,i){var n=r.width-r.x,a=r.height-r.y;if(!(0>=n||0>=a)&&n&&a&&0!=r.drawData.length){var o=t.sys.DisplayList.$canvasScaleX,s=t.sys.DisplayList.$canvasScaleY,h=i.context.$maxTextureSize;n*o>h&&(o*=h/(n*o)),a*s>h&&(s*=h/(a*s)),n*=o,a*=s;var c=r.x*o,l=r.y*s;if((r.$canvasScaleX!=o||r.$canvasScaleY!=s)&&(r.$canvasScaleX=o,r.$canvasScaleY=s,r.dirtyRender=!0),this.canvasRenderBuffer&&this.canvasRenderBuffer.context?r.dirtyRender&&this.canvasRenderBuffer.resize(n,a):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(n,a)),this.canvasRenderBuffer.context){if((1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),c||l?(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,-c,-l),i.transform(1,0,0,1,c/o,l/s)):(1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),r.dirtyRender){var u=this.canvasRenderBuffer.surface;this.canvasRenderer.renderText(r,this.canvasRenderBuffer.context);var d=r.$texture;d?i.context.updateTexture(d,u):(d=i.context.createTexture(u),r.$texture=d),r.$textureWidth=u.width,r.$textureHeight=u.height}var p=r.$textureWidth,f=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,p,f,0,0,p/o,f/s,p,f),(c||l)&&(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),i.transform(1,0,0,1,-c/o,-l/s)),r.dirtyRender=!1}}},a.prototype.renderGraphics=function(r,i,n){var a=r.width,o=r.height;if(!(0>=a||0>=o)&&a&&o&&0!=r.drawData.length){var s=t.sys.DisplayList.$canvasScaleX,h=t.sys.DisplayList.$canvasScaleY;(1>a*s||1>o*h)&&(s=h=1),(r.$canvasScaleX!=s||r.$canvasScaleY!=h)&&(r.$canvasScaleX=s,r.$canvasScaleY=h,r.dirtyRender=!0),a*=s,o*=h;var c=Math.ceil(a),l=Math.ceil(o);if(s*=c/a,h*=l/o,a=c,o=l,this.canvasRenderBuffer&&this.canvasRenderBuffer.context?(r.dirtyRender||n)&&this.canvasRenderBuffer.resize(a,o):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(a,o)),this.canvasRenderBuffer.context){(1!=s||1!=h)&&this.canvasRenderBuffer.context.setTransform(s,0,0,h,0,0),(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(-r.x,-r.y),i.transform(1,0,0,1,r.x,r.y));var u=this.canvasRenderBuffer.surface;if(n){this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context,!0),t.WebGLUtils.deleteWebGLTexture(u);var d=i.context.getWebGLTexture(u);i.context.drawTexture(d,0,0,a,o,0,0,a,o,u.width,u.height)}else{if(r.dirtyRender){this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context);var d=r.$texture;d?i.context.updateTexture(d,u):(d=i.context.createTexture(u),r.$texture=d),r.$textureWidth=u.width,r.$textureHeight=u.height}var p=r.$textureWidth,f=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,p,f,0,0,p/s,f/h,p,f)}(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(r.x,r.y),i.transform(1,0,0,1,-r.x,-r.y)),n||(r.dirtyRender=!1)}}},a.prototype.renderGroup=function(e,r){var i,n,a,o=e.matrix;if(o){i=t.Matrix.create();var s=r.globalMatrix;i.a=s.a,i.b=s.b,i.c=s.c,i.d=s.d,i.tx=s.tx,i.ty=s.ty,n=r.$offsetX,a=r.$offsetY,r.useOffset(),r.transform(o.a,o.b,o.c,o.d,o.tx,o.ty)}for(var h=e.drawData,c=h.length,l=0;c>l;l++){var u=h[l];this.renderNode(u,r,r.$offsetX,r.$offsetY)}if(o){var d=r.globalMatrix;d.a=i.a,d.b=i.b,d.c=i.c,d.d=i.d,d.tx=i.tx,d.ty=i.ty,r.$offsetX=n,r.$offsetY=a,t.Matrix.release(i)}},a.prototype.createRenderBuffer=function(t,r){var i=n.pop();return i?i.resize(t,r):(i=new e.WebGLRenderBuffer(t,r),i.$computeDrawCall=!1),i},a}();e.WebGLRenderer=a,__reflect(a.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.compileProgram=function(r,i,n){var a=e.compileFragmentShader(r,n),o=e.compileVertexShader(r,i),s=r.createProgram();return r.attachShader(s,o),r.attachShader(s,a),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||t.$warn(1020),s},e.compileFragmentShader=function(t,r){return e._compileShader(t,r,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,r){return e._compileShader(t,r,t.VERTEX_SHADER)},e._compileShader=function(t,e,r){var i=t.createShader(r);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(r){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(t){if(t){var e=t.glContext;e&&e.deleteTexture(t)}},e}();t.WebGLUtils=e,__reflect(e.prototype,"egret.WebGLUtils")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.size=2e3,this.vertexMaxSize=4*this.size,this.indicesMaxSize=6*this.size,this.vertSize=5,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1;var t=this.vertexMaxSize*this.vertSize,e=this.indicesMaxSize;this.vertices=new Float32Array(t),this.indices=new Uint16Array(e),this.indicesForMesh=new Uint16Array(e);for(var r=0,i=0;e>r;r+=6,i+=4)this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3}return t.prototype.reachMaxSize=function(t,e){return void 0===t&&(t=4),void 0===e&&(e=6),this.vertexIndex>this.vertexMaxSize-t||this.indexIndex>this.indicesMaxSize-e},t.prototype.getVertices=function(){var t=this.vertices.subarray(0,this.vertexIndex*this.vertSize);return t},t.prototype.getIndices=function(){return this.indices},t.prototype.getMeshIndices=function(){return this.indicesForMesh},t.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var t=0,e=this.indexIndex;e>t;++t)this.indicesForMesh[t]=this.indices[t];this.hasMesh=!0}},t.prototype.isMesh=function(){return this.hasMesh},t.prototype.cacheArrays=function(t,e,r,i,n,a,o,s,h,c,l,u,d,p,f){var g=t.globalAlpha,v=t.globalMatrix,y=v.a,$=v.b,m=v.c,b=v.d,x=v.tx,T=v.ty,w=t.$offsetX,_=t.$offsetY;if((0!=w||0!=_)&&(x=w*y+_*m+x,T=w*$+_*b+T),!d){(0!=a||0!=o)&&(x=a*y+o*m+x,T=a*$+o*b+T);var E=s/i;1!=E&&(y=E*y,$=E*$);var S=h/n;1!=S&&(m=S*m,b=S*b)}if(d){var C=this.vertices,D=this.vertexIndex*this.vertSize,R=0,O=0,L=0,A=0,M=0,B=0,F=0;for(R=0,L=u.length;L>R;R+=2)O=5*R/2,B=d[R],F=d[R+1],A=u[R],M=u[R+1],C[D+O+0]=y*B+m*F+x,C[D+O+1]=$*B+b*F+T,C[D+O+2]=(e+A*i)/c,C[D+O+3]=(r+M*n)/l,C[D+O+4]=g;if(this.hasMesh)for(var P=0,N=p.length;N>P;++P)this.indicesForMesh[this.indexIndex+P]=p[P]+this.vertexIndex;this.vertexIndex+=u.length/2,this.indexIndex+=p.length}else{var I=c,k=l,H=i,W=n;e/=I,r/=k;var C=this.vertices,D=this.vertexIndex*this.vertSize;if(f){var U=i;i=n/I,n=U/k,C[D++]=x,C[D++]=T,C[D++]=i+e,C[D++]=r,C[D++]=g,C[D++]=y*H+x,C[D++]=$*H+T,C[D++]=i+e,C[D++]=n+r,C[D++]=g,C[D++]=y*H+m*W+x,C[D++]=b*W+$*H+T,C[D++]=e,C[D++]=n+r,C[D++]=g,C[D++]=m*W+x,C[D++]=b*W+T,C[D++]=e,C[D++]=r,C[D++]=g}else i/=I,n/=k,C[D++]=x,C[D++]=T,C[D++]=e,C[D++]=r,C[D++]=g,C[D++]=y*H+x,C[D++]=$*H+T,C[D++]=i+e,C[D++]=r,C[D++]=g,C[D++]=y*H+m*W+x,C[D++]=b*W+$*H+T,C[D++]=i+e,C[D++]=n+r,C[D++]=g,C[D++]=m*W+x,C[D++]=b*W+T,C[D++]=e,C[D++]=n+r,C[D++]=g;if(this.hasMesh){var X=this.indicesForMesh;X[this.indexIndex+0]=0+this.vertexIndex,X[this.indexIndex+1]=1+this.vertexIndex,X[this.indexIndex+2]=2+this.vertexIndex,X[this.indexIndex+3]=0+this.vertexIndex,X[this.indexIndex+4]=2+this.vertexIndex,X[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},t.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},t}();t.WebGLVertexArrayObject=e,__reflect(e.prototype,"egret.web.WebGLVertexArrayObject")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.image=null,e.smoothing=!0,e.rotated=!1,e.type=6,e}return __extends(e,t),e.prototype.drawImage=function(t,e,r,i,n,a,o,s){var h=this;h.sourceX=t,h.sourceY=e,h.sourceW=r,h.sourceH=i,h.drawX=n,h.drawY=a,h.drawW=o,h.drawH=s,h.renderCount=1},e.prototype.cleanBeforeRender=function(){t.prototype.cleanBeforeRender.call(this),this.image=null},e}(t.RenderNode);t.NormalBitmapNode=e,__reflect(e.prototype,"egret.sys.NormalBitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));
>>>>>>> Stashed changes
