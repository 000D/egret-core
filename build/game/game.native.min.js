var egret;!function(e){var t;!function(t){var r=function(t){function r(){t.call(this),this.urlData={}}__extends(r,t);var n=(__define,r);return p=n.prototype,p.proceed=function(t){function n(){var r=new e.PromiseObject;r.onSuccessFunc=function(r){t.data=r,e.Event.dispatchEvent(t,e.Event.COMPLETE)},t.dataFormat==e.URLLoaderDataFormat.BINARY?egret_native.readFileAsync(u,r,"ArrayBuffer"):egret_native.readFileAsync(u,r)}function a(){var r=e.PromiseObject.create();r.onSuccessFunc=i,r.onErrorFunc=function(){e.Event.dispatchEvent(t,e.IOErrorEvent.IO_ERROR)},egret_native.download(u,u,r)}function i(){var r;r=t.dataFormat==e.URLLoaderDataFormat.BINARY?egret_native.readFileSync(u,"ArrayBuffer"):egret_native.readFileSync(u),t.data=r,e.Event.dispatchEvent(t,e.Event.COMPLETE)}var o=this;if(t.dataFormat==e.URLLoaderDataFormat.TEXTURE)return void o.loadTexture(t);if(t.dataFormat==e.URLLoaderDataFormat.SOUND)return void o.loadSound(t);var s=t._request,u=o.getVirtualUrl(e.$getUrl(s));if(o.isNetUrl(u)){if(o.urlData.type=s.method,s.method==e.URLRequestMethod.POST&&s.data){var c=s.data;o.urlData.data=c.toString()}else delete o.urlData.data;s.requestHeaders?o.urlData.header=o.getHeaderString(s):delete o.urlData.header;var v=e.PromiseObject.create();v.onSuccessFunc=function(r){t.data=r,e.callLater(e.Event.dispatchEvent,e.Event,t,e.Event.COMPLETE)},v.onErrorFunc=function(r){e.$warn(1019,r),e.IOErrorEvent.dispatchIOErrorEvent(t)},egret_native.requireHttp(u,o.urlData,v)}else egret_native.isFileExists(u)?r.__use_asyn?n():e.$callAsync(i,o):a()},p.getHeaderString=function(e){for(var t={},r=e.requestHeaders.length,n=0;r>n;n++){var a=e.requestHeaders[n];t[a.name]=a.value}return JSON.stringify(t)},p.loadSound=function(t){function r(){var r=e.PromiseObject.create();r.onSuccessFunc=n,r.onErrorFunc=function(){e.IOErrorEvent.dispatchIOErrorEvent(t)},egret_native.download(o,o,r)}function n(){e.Event.dispatchEvent(t,e.Event.COMPLETE)}var a=this,i=t._request,o=a.getVirtualUrl(i.url);a.isNetUrl(o)?r():egret_native.isFileExists(o)?e.$callAsync(n,a):r()},p.loadTexture=function(t){function r(e){t.dispatchEvent(e)}function n(e){i(),t.dispatchEvent(e)}function a(){i();var r=c.data,n=new e.Texture;n._setBitmapData(r),t.data=n,e.$callAsync(function(){t.dispatchEventWith(e.Event.COMPLETE)},o)}function i(){c.removeEventListener(e.Event.COMPLETE,a,o),c.removeEventListener(e.IOErrorEvent.IO_ERROR,n,o),c.removeEventListener(e.ProgressEvent.PROGRESS,r,o)}var o=this,s=t._request,u=o.getVirtualUrl(s.url),c=new e.ImageLoader;c.addEventListener(e.Event.COMPLETE,a,o),c.addEventListener(e.IOErrorEvent.IO_ERROR,n,o),c.addEventListener(e.ProgressEvent.PROGRESS,r,o),c.load(u)},p.isNetUrl=function(e){return-1!=e.indexOf("http://")},p.getVirtualUrl=function(e){return e},r.getNetContext=function(){return null==r._instance&&(r._instance=new r),r._instance},r.__use_asyn=null==egret_native.readFileAsync?!1:!0,r}(e.HashObject);t.NativeNetContext=r,e.registerClass(r,"egret.native.NativeNetContext",["egret.NetContext"]),e.NetContext=r}(t=e["native"]||(e["native"]={}))}(egret||(egret={}));